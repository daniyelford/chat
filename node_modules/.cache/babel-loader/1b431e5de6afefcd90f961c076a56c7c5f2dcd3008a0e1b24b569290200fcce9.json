{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { BASE_URL, API_SECRET_KEY } from '@/config';\nimport router from '@/router';\nexport async function sendApi(data = {}) {\n  try {\n    const request = await fetch(`${BASE_URL}/create_token`, {\n      method: 'GET',\n      credentials: 'include',\n      headers: {\n        'X-API-KEY': API_SECRET_KEY\n      }\n    });\n    const token = await request.json();\n    if (token.status === 'success') {\n      const response = await fetch(`${BASE_URL}/api`, {\n        method: 'POST',\n        credentials: 'include',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token.token}`,\n          'X-API-KEY': API_SECRET_KEY,\n          'X-API-KEY-BACK': token.key\n        },\n        body: JSON.stringify(data)\n      });\n      const result = await response.json();\n      if (result.code === 401 && result.status === 'error') {\n        localStorage.clear();\n        router.push('/');\n        console.error('api error', result);\n        throw new Error('UnmatchUnauthorized');\n      }\n      return result;\n    } else {\n      localStorage.clear();\n      router.push('/');\n      console.error('api error', token);\n      throw new Error('Unauthorized');\n    }\n  } catch (err) {\n    console.error('API Error:', err);\n    throw err;\n  }\n}","map":{"version":3,"names":["BASE_URL","API_SECRET_KEY","router","sendApi","data","request","fetch","method","credentials","headers","token","json","status","response","key","body","JSON","stringify","result","code","localStorage","clear","push","console","error","Error","err"],"sources":["D:/GitHub/ci3-vue3/vue3/src/utils/api.js"],"sourcesContent":["import { BASE_URL, API_SECRET_KEY } from '@/config'\r\nimport router from '@/router'\r\nexport async function sendApi(data = {}) {\r\n  try {\r\n    const request = await fetch(`${BASE_URL}/create_token`, {\r\n      method: 'GET',\r\n      credentials: 'include',\r\n      headers: {\r\n        'X-API-KEY': API_SECRET_KEY\r\n      }\r\n    })\r\n    const token = await request.json();\r\n    if(token.status==='success'){\r\n      const response = await fetch(`${BASE_URL}/api`, {\r\n        method: 'POST',\r\n        credentials: 'include',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${token.token}`,\r\n          'X-API-KEY': API_SECRET_KEY,\r\n          'X-API-KEY-BACK':token.key\r\n        },\r\n        body: JSON.stringify(data)\r\n      });\r\n      const result = await response.json();\r\n      if(result.code === 401 && result.status === 'error'){\r\n        localStorage.clear();\r\n        router.push('/');\r\n        console.error('api error',result);\r\n        throw new Error('UnmatchUnauthorized');\r\n      }\r\n      return result;\r\n    }else{\r\n      localStorage.clear();\r\n      router.push('/');\r\n      console.error('api error',token);\r\n      throw new Error('Unauthorized');\r\n    }\r\n  } catch (err) {\r\n    console.error('API Error:', err);\r\n    throw err;\r\n  }\r\n}"],"mappings":";AAAA,SAASA,QAAQ,EAAEC,cAAc,QAAQ,UAAU;AACnD,OAAOC,MAAM,MAAM,UAAU;AAC7B,OAAO,eAAeC,OAAOA,CAACC,IAAI,GAAG,CAAC,CAAC,EAAE;EACvC,IAAI;IACF,MAAMC,OAAO,GAAG,MAAMC,KAAK,CAAC,GAAGN,QAAQ,eAAe,EAAE;MACtDO,MAAM,EAAE,KAAK;MACbC,WAAW,EAAE,SAAS;MACtBC,OAAO,EAAE;QACP,WAAW,EAAER;MACf;IACF,CAAC,CAAC;IACF,MAAMS,KAAK,GAAG,MAAML,OAAO,CAACM,IAAI,CAAC,CAAC;IAClC,IAAGD,KAAK,CAACE,MAAM,KAAG,SAAS,EAAC;MAC1B,MAAMC,QAAQ,GAAG,MAAMP,KAAK,CAAC,GAAGN,QAAQ,MAAM,EAAE;QAC9CO,MAAM,EAAE,MAAM;QACdC,WAAW,EAAE,SAAS;QACtBC,OAAO,EAAE;UACP,cAAc,EAAE,kBAAkB;UAClC,eAAe,EAAE,UAAUC,KAAK,CAACA,KAAK,EAAE;UACxC,WAAW,EAAET,cAAc;UAC3B,gBAAgB,EAACS,KAAK,CAACI;QACzB,CAAC;QACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACb,IAAI;MAC3B,CAAC,CAAC;MACF,MAAMc,MAAM,GAAG,MAAML,QAAQ,CAACF,IAAI,CAAC,CAAC;MACpC,IAAGO,MAAM,CAACC,IAAI,KAAK,GAAG,IAAID,MAAM,CAACN,MAAM,KAAK,OAAO,EAAC;QAClDQ,YAAY,CAACC,KAAK,CAAC,CAAC;QACpBnB,MAAM,CAACoB,IAAI,CAAC,GAAG,CAAC;QAChBC,OAAO,CAACC,KAAK,CAAC,WAAW,EAACN,MAAM,CAAC;QACjC,MAAM,IAAIO,KAAK,CAAC,qBAAqB,CAAC;MACxC;MACA,OAAOP,MAAM;IACf,CAAC,MAAI;MACHE,YAAY,CAACC,KAAK,CAAC,CAAC;MACpBnB,MAAM,CAACoB,IAAI,CAAC,GAAG,CAAC;MAChBC,OAAO,CAACC,KAAK,CAAC,WAAW,EAACd,KAAK,CAAC;MAChC,MAAM,IAAIe,KAAK,CAAC,cAAc,CAAC;IACjC;EACF,CAAC,CAAC,OAAOC,GAAG,EAAE;IACZH,OAAO,CAACC,KAAK,CAAC,YAAY,EAAEE,GAAG,CAAC;IAChC,MAAMA,GAAG;EACX;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}