{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.flat-map.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.iterator.some.js\";\nimport { createVNode as _createVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = {\n  class: \"map-in\"\n};\nconst _hoisted_2 = {\n  class: \"category\"\n};\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = {\n  class: \"info\"\n};\nimport StaticMapWithMarkers from '@/components/tooles/places/StaticMapWithMarkers.vue';\nimport { usePlaceStore } from '@/stores/place';\nimport { onMounted, computed, ref } from 'vue';\nexport default {\n  __name: 'PlacesList',\n  setup(__props) {\n    const placeStore = usePlaceStore();\n    onMounted(() => {\n      placeStore.fetchAllPlaces();\n    });\n    const markers = computed(() => placeStore.allPlaces.flatMap(place => (place.addresses || []).map(address => ({\n      lat: parseFloat(address.lat),\n      lon: parseFloat(address.lon),\n      address: address.address || '',\n      title: place.title || '',\n      description: place.description || '',\n      medias: place.medias || [],\n      categories: place.categories || []\n    }))));\n    const center = computed(() => {\n      const cord = placeStore.userCoordinate;\n      if (cord?.lat && cord?.lon) {\n        return {\n          lat: parseFloat(cord.lat),\n          lon: parseFloat(cord.lon)\n        };\n      }\n      return {\n        lat: 35.6892,\n        lon: 51.3890\n      };\n    });\n    const selectedCategoryId = ref(null);\n    const allCategories = computed(() => {\n      const set = new Map();\n      placeStore.allPlaces.forEach(place => {\n        (place.categories || []).forEach(category => {\n          if (!set.has(Number(category.id))) {\n            set.set(Number(category.id), category);\n          }\n        });\n      });\n      return Array.from(set.values());\n    });\n    const filteredPlaces = computed(() => {\n      if (!selectedCategoryId.value) return placeStore.allPlaces;\n      return placeStore.allPlaces.filter(place => (place.categories || []).some(cat => Number(cat.id) === Number(selectedCategoryId.value)));\n    });\n    return (_ctx, _cache) => {\n      return _openBlock(), _createElementBlock(_Fragment, null, [_createElementVNode(\"div\", _hoisted_1, [_createVNode(StaticMapWithMarkers, {\n        center: center.value,\n        markers: markers.value\n      }, null, 8, [\"center\", \"markers\"])]), _createElementVNode(\"div\", _hoisted_2, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(allCategories.value, cat => {\n        return _openBlock(), _createElementBlock(\"button\", {\n          key: cat.id,\n          class: _normalizeClass({\n            active: selectedCategoryId.value === cat.id\n          }),\n          onClick: $event => selectedCategoryId.value = cat.id\n        }, _toDisplayString(cat.title), 11, _hoisted_3);\n      }), 128)), _createElementVNode(\"button\", {\n        onClick: _cache[0] || (_cache[0] = $event => selectedCategoryId.value = null)\n      }, \"همه\")]), _createElementVNode(\"div\", _hoisted_4, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filteredPlaces.value, place => {\n        return _openBlock(), _createElementBlock(\"div\", {\n          key: place.id,\n          class: \"place-item\"\n        }, [_createElementVNode(\"h3\", null, _toDisplayString(place.title), 1), _createElementVNode(\"p\", null, _toDisplayString(place.description), 1), _createElementVNode(\"p\", null, _toDisplayString(place.addresses?.[0]?.address || 'آدرس نامشخص'), 1)]);\n      }), 128))])], 64);\n    };\n  }\n};","map":{"version":3,"names":["StaticMapWithMarkers","usePlaceStore","onMounted","computed","ref","placeStore","fetchAllPlaces","markers","allPlaces","flatMap","place","addresses","map","address","lat","parseFloat","lon","title","description","medias","categories","center","cord","userCoordinate","selectedCategoryId","allCategories","set","Map","forEach","category","has","Number","id","Array","from","values","filteredPlaces","value","filter","some","cat"],"sources":["D:/GitHub/chat/vue3/src/components/dashboard/pagesContent/PlacesList.vue"],"sourcesContent":["<template>\r\n  <div class=\"map-in\">\r\n    <StaticMapWithMarkers\r\n    :center=\"center\"\r\n    :markers=\"markers\"\r\n    />\r\n  </div>\r\n  <div class=\"category\">\r\n    <button\r\n      v-for=\"cat in allCategories\"\r\n      :key=\"cat.id\"\r\n      :class=\"{ active: selectedCategoryId === cat.id }\"\r\n      @click=\"selectedCategoryId = cat.id\"\r\n    >\r\n      {{ cat.title }}\r\n    </button>\r\n    <button @click=\"selectedCategoryId = null\">همه</button>\r\n  </div>\r\n  <div class=\"info\">\r\n    <div v-for=\"place in filteredPlaces\" :key=\"place.id\" class=\"place-item\">\r\n      <h3>{{ place.title }}</h3>\r\n      <p>{{ place.description }}</p>\r\n      <p>\r\n        {{ place.addresses?.[0]?.address || 'آدرس نامشخص' }}\r\n      </p>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script setup>\r\n  import StaticMapWithMarkers from '@/components/tooles/places/StaticMapWithMarkers.vue'\r\n  import { usePlaceStore } from '@/stores/place'\r\n  import { onMounted, computed, ref } from 'vue'\r\n  const placeStore = usePlaceStore()\r\n  onMounted(() => {\r\n    placeStore.fetchAllPlaces()\r\n  })\r\n  const markers = computed(() =>\r\n    placeStore.allPlaces.flatMap(place =>\r\n      (place.addresses || []).map(address => ({\r\n        lat: parseFloat(address.lat),\r\n        lon: parseFloat(address.lon),\r\n        address: address.address || '',\r\n        title: place.title || '',\r\n        description: place.description || '',\r\n        medias: place.medias || [],\r\n        categories: place.categories || []\r\n      }))\r\n    )\r\n  )\r\n  const center = computed(() => {\r\n    const cord = placeStore.userCoordinate\r\n    if (cord?.lat && cord?.lon) {\r\n      return { lat: parseFloat(cord.lat), lon: parseFloat(cord.lon) }\r\n    }\r\n    return { lat: 35.6892, lon: 51.3890 }\r\n  })\r\n  const selectedCategoryId = ref(null)\r\n  const allCategories = computed(() => {\r\n    const set = new Map()\r\n    placeStore.allPlaces.forEach(place => {\r\n      (place.categories || []).forEach(category => {\r\n        if (!set.has(Number(category.id))) {\r\n          set.set(Number(category.id), category)\r\n        }\r\n      })\r\n    })\r\n    return Array.from(set.values())\r\n  })\r\n  const filteredPlaces = computed(() => {\r\n    if (!selectedCategoryId.value) return placeStore.allPlaces\r\n    return placeStore.allPlaces.filter(place =>\r\n      (place.categories || []).some(cat => Number(cat.id) === Number(selectedCategoryId.value))\r\n    )\r\n  })\r\n</script>\r\n<style>\r\n  .map-in{\r\n    display: inline-block;\r\n    height: 60%;\r\n    width: 69%;\r\n  }\r\n  .category{\r\n    display: inline-block;\r\n    height: 60%;\r\n    width: 29%;\r\n  }\r\n  .info{\r\n    height: 40%;\r\n    width: 100%;\r\n  }\r\n</style>"],"mappings":";;;;;;;;;;;;;;;;;AA6BE,OAAOA,oBAAoB,MAAM,qDAAqD;AACtF,SAASC,aAAa,QAAQ,gBAAgB;AAC9C,SAASC,SAAS,EAAEC,QAAQ,EAAEC,GAAG,QAAQ,KAAK;;;;IAC9C,MAAMC,UAAU,GAAGJ,aAAa,CAAC,CAAC;IAClCC,SAAS,CAAC,MAAM;MACdG,UAAU,CAACC,cAAc,CAAC,CAAC;IAC7B,CAAC,CAAC;IACF,MAAMC,OAAO,GAAGJ,QAAQ,CAAC,MACvBE,UAAU,CAACG,SAAS,CAACC,OAAO,CAACC,KAAK,IAChC,CAACA,KAAK,CAACC,SAAS,IAAI,EAAE,EAAEC,GAAG,CAACC,OAAO,KAAK;MACtCC,GAAG,EAAEC,UAAU,CAACF,OAAO,CAACC,GAAG,CAAC;MAC5BE,GAAG,EAAED,UAAU,CAACF,OAAO,CAACG,GAAG,CAAC;MAC5BH,OAAO,EAAEA,OAAO,CAACA,OAAO,IAAI,EAAE;MAC9BI,KAAK,EAAEP,KAAK,CAACO,KAAK,IAAI,EAAE;MACxBC,WAAW,EAAER,KAAK,CAACQ,WAAW,IAAI,EAAE;MACpCC,MAAM,EAAET,KAAK,CAACS,MAAM,IAAI,EAAE;MAC1BC,UAAU,EAAEV,KAAK,CAACU,UAAU,IAAI;IAClC,CAAC,CAAC,CACJ,CACF,CAAC;IACD,MAAMC,MAAM,GAAGlB,QAAQ,CAAC,MAAM;MAC5B,MAAMmB,IAAI,GAAGjB,UAAU,CAACkB,cAAc;MACtC,IAAID,IAAI,EAAER,GAAG,IAAIQ,IAAI,EAAEN,GAAG,EAAE;QAC1B,OAAO;UAAEF,GAAG,EAAEC,UAAU,CAACO,IAAI,CAACR,GAAG,CAAC;UAAEE,GAAG,EAAED,UAAU,CAACO,IAAI,CAACN,GAAG;QAAE,CAAC;MACjE;MACA,OAAO;QAAEF,GAAG,EAAE,OAAO;QAAEE,GAAG,EAAE;MAAQ,CAAC;IACvC,CAAC,CAAC;IACF,MAAMQ,kBAAkB,GAAGpB,GAAG,CAAC,IAAI,CAAC;IACpC,MAAMqB,aAAa,GAAGtB,QAAQ,CAAC,MAAM;MACnC,MAAMuB,GAAG,GAAG,IAAIC,GAAG,CAAC,CAAC;MACrBtB,UAAU,CAACG,SAAS,CAACoB,OAAO,CAAClB,KAAK,IAAI;QACpC,CAACA,KAAK,CAACU,UAAU,IAAI,EAAE,EAAEQ,OAAO,CAACC,QAAQ,IAAI;UAC3C,IAAI,CAACH,GAAG,CAACI,GAAG,CAACC,MAAM,CAACF,QAAQ,CAACG,EAAE,CAAC,CAAC,EAAE;YACjCN,GAAG,CAACA,GAAG,CAACK,MAAM,CAACF,QAAQ,CAACG,EAAE,CAAC,EAAEH,QAAQ,CAAC;UACxC;QACF,CAAC,CAAC;MACJ,CAAC,CAAC;MACF,OAAOI,KAAK,CAACC,IAAI,CAACR,GAAG,CAACS,MAAM,CAAC,CAAC,CAAC;IACjC,CAAC,CAAC;IACF,MAAMC,cAAc,GAAGjC,QAAQ,CAAC,MAAM;MACpC,IAAI,CAACqB,kBAAkB,CAACa,KAAK,EAAE,OAAOhC,UAAU,CAACG,SAAS;MAC1D,OAAOH,UAAU,CAACG,SAAS,CAAC8B,MAAM,CAAC5B,KAAK,IACtC,CAACA,KAAK,CAACU,UAAU,IAAI,EAAE,EAAEmB,IAAI,CAACC,GAAG,IAAIT,MAAM,CAACS,GAAG,CAACR,EAAE,CAAC,KAAKD,MAAM,CAACP,kBAAkB,CAACa,KAAK,CAAC,CAC1F,CAAC;IACH,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}