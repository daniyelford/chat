{"ast":null,"code":"import { unref as _unref, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  key: 0,\n  class: \"loading\"\n};\nconst _hoisted_2 = {\n  key: 1,\n  class: \"card-inner\"\n};\nconst _hoisted_3 = {\n  class: \"user-info\"\n};\nconst _hoisted_4 = [\"src\"];\nconst _hoisted_5 = {\n  key: 1,\n  xmlns: \"http://www.w3.org/2000/svg\",\n  fill: \"#000000\",\n  \"enable-background\": \"new 0 0 24 24\",\n  viewBox: \"0 0 24 24\"\n};\nconst _hoisted_6 = {\n  class: \"card-category\"\n};\nconst _hoisted_7 = {\n  key: 1,\n  class: \"description\"\n};\nconst _hoisted_8 = {\n  key: 2,\n  class: \"location\"\n};\nconst _hoisted_9 = {\n  class: \"time\"\n};\nconst _hoisted_10 = [\"onClick\"];\nconst _hoisted_11 = {\n  key: 2,\n  class: \"none-cart-error\"\n};\nimport { ref, onMounted, onBeforeUnmount } from 'vue';\nimport moment from 'moment-jalaali';\nimport { sendApi } from '@/utils/api';\nimport MediaSlider from '@/components/tooles/media/MediaSlider.vue';\nimport CalendarModal from '@/components/tooles/news/CalendarModal.vue';\nimport { useNewsStore } from '@/stores/news';\nexport default {\n  __name: 'NewsCards',\n  setup(__props) {\n    const showModal = ref(false);\n    const selectedNewsId = ref(null);\n    const newsStore = useNewsStore();\n    function openCalendarModal(id) {\n      selectedNewsId.value = id;\n      showModal.value = true;\n    }\n    async function onCalendarSubmit({\n      date\n    }) {\n      const jsDate = date ? moment(date, 'jYYYY/jMM/jDD').toDate() : null;\n      const response = await sendApi({\n        action: 'add_news_to_list',\n        control: 'news',\n        data: {\n          news_id: selectedNewsId.value,\n          run_time: jsDate ?? null\n        }\n      });\n      if (response.status === 'success') {\n        showModal.value = false;\n        newsStore.fetchNews();\n      } else {\n        alert('خطا در ثبت تاریخ اجرا');\n      }\n    }\n    let intervalId = null;\n    onMounted(() => {\n      newsStore.fetchNews();\n      intervalId = setInterval(() => {\n        newsStore.fetchNews();\n      }, 6000);\n    });\n    onBeforeUnmount(() => {\n      if (intervalId) clearInterval(intervalId);\n    });\n    return (_ctx, _cache) => {\n      return _openBlock(), _createElementBlock(_Fragment, null, [!_unref(newsStore).isLoaded ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, \" در حال بارگذاری... \")) : _unref(newsStore).cards.length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(newsStore).cards, card => {\n        return _openBlock(), _createElementBlock(\"div\", {\n          key: card.id,\n          class: \"card\"\n        }, [_cache[2] || (_cache[2] = _createElementVNode(\"div\", {\n          class: \"card-header\"\n        }, null, -1)), _createElementVNode(\"div\", _hoisted_3, [card.user.image ? (_openBlock(), _createElementBlock(\"img\", {\n          key: 0,\n          src: card.user.image,\n          alt: \"user icon\"\n        }, null, 8, _hoisted_4)) : (_openBlock(), _createElementBlock(\"svg\", _hoisted_5, _cache[1] || (_cache[1] = [_createElementVNode(\"g\", null, [_createElementVNode(\"rect\", {\n          fill: \"none\",\n          height: \"24\",\n          width: \"24\"\n        })], -1), _createElementVNode(\"g\", null, [_createElementVNode(\"path\", {\n          d: \"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm0 14c-2.03 0-4.43-.82-6.14-2.88C7.55 15.8 9.68 15 12 15s4.45.8 6.14 2.12C16.43 19.18 14.03 20 12 20z\"\n        })], -1)]))), _createElementVNode(\"p\", null, _toDisplayString(card.user.name + ' ' + card.user.family), 1)]), card.medias.length > 0 ? (_openBlock(), _createBlock(MediaSlider, {\n          key: 0,\n          medias: card.medias\n        }, null, 8, [\"medias\"])) : _createCommentVNode(\"\", true), _createElementVNode(\"div\", _hoisted_6, _toDisplayString(card.category), 1), card.description !== '' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, _toDisplayString(card.description), 1)) : _createCommentVNode(\"\", true), card.location !== '' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, \" موقعیت: \" + _toDisplayString(card.location), 1)) : _createCommentVNode(\"\", true), _createElementVNode(\"div\", _hoisted_9, _toDisplayString(_unref(moment)(card.created_at).format('jYYYY/jMM/jDD')), 1), _unref(newsStore).hasRule ? (_openBlock(), _createElementBlock(\"a\", {\n          key: 3,\n          class: \"choose\",\n          onClick: $event => openCalendarModal(card.id)\n        }, \" بررسی \", 8, _hoisted_10)) : _createCommentVNode(\"\", true)]);\n      }), 128))])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_11, \" خبری در محدوده شما وجود ندارد \")), showModal.value ? (_openBlock(), _createBlock(CalendarModal, {\n        key: 3,\n        onClose: _cache[0] || (_cache[0] = $event => showModal.value = false),\n        onSubmit: onCalendarSubmit\n      })) : _createCommentVNode(\"\", true)], 64);\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","onBeforeUnmount","moment","sendApi","MediaSlider","CalendarModal","useNewsStore","showModal","selectedNewsId","newsStore","openCalendarModal","id","value","onCalendarSubmit","date","jsDate","toDate","response","action","control","data","news_id","run_time","status","fetchNews","alert","intervalId","setInterval","clearInterval"],"sources":["D:/GitHub/ci3-vue3/vue3/src/components/dashboard/pagesContent/NewsCards.vue"],"sourcesContent":["<template>\r\n    <div class=\"loading\" v-if=\"!newsStore.isLoaded\">\r\n        در حال بارگذاری...\r\n    </div>\r\n    <div class=\"card-inner\" v-else-if=\"newsStore.cards.length > 0\">\r\n        <div v-for=\"card in newsStore.cards\" :key=\"card.id\" class=\"card\">\r\n            <div class=\"card-header\">\r\n            </div>\r\n            <div class=\"user-info\">\r\n                <img v-if=\"card.user.image\" :src=\"card.user.image\" alt=\"user icon\">\r\n                <svg v-else xmlns=\"http://www.w3.org/2000/svg\" fill=\"#000000\" enable-background=\"new 0 0 24 24\" viewBox=\"0 0 24 24\"><g><rect fill=\"none\" height=\"24\" width=\"24\"/></g><g><path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm0 14c-2.03 0-4.43-.82-6.14-2.88C7.55 15.8 9.68 15 12 15s4.45.8 6.14 2.12C16.43 19.18 14.03 20 12 20z\"/></g></svg>\r\n                <p>{{ card.user.name + ' ' + card.user.family }}</p>\r\n            </div>\r\n            <MediaSlider v-if=\"card.medias.length > 0\" :medias=\"card.medias\" />\r\n            <div class=\"card-category\">\r\n                {{ card.category }}\r\n            </div>\r\n            <div class=\"description\" v-if=\"card.description !== ''\">\r\n                {{ card.description }}\r\n            </div>\r\n            <div class=\"location\" v-if=\"card.location !== ''\">\r\n                موقعیت:\r\n                {{ card.location }}\r\n            </div>\r\n            <div class=\"time\">\r\n                {{ moment(card.created_at).format('jYYYY/jMM/jDD') }}\r\n            </div>\r\n            <a class=\"choose\" v-if=\"newsStore.hasRule\" @click=\"openCalendarModal(card.id)\">\r\n                بررسی\r\n            </a>\r\n        </div>\r\n    </div>\r\n    <div class=\"none-cart-error\" v-else>\r\n        خبری در محدوده شما وجود ندارد\r\n    </div>\r\n    <CalendarModal\r\n    v-if=\"showModal\"\r\n    @close=\"showModal = false\"\r\n    @submit=\"onCalendarSubmit\" />\r\n</template>\r\n<script setup>\r\n    import { ref, onMounted , onBeforeUnmount } from 'vue'\r\n    import moment from 'moment-jalaali'\r\n    import { sendApi } from '@/utils/api'\r\n    import MediaSlider from '@/components/tooles/media/MediaSlider.vue'\r\n    import CalendarModal from '@/components/tooles/news/CalendarModal.vue'\r\n    import { useNewsStore } from '@/stores/news'\r\n    const showModal = ref(false)\r\n    const selectedNewsId = ref(null)\r\n    const newsStore = useNewsStore()\r\n    function openCalendarModal(id) {\r\n        selectedNewsId.value = id\r\n        showModal.value = true\r\n    }\r\n    async function onCalendarSubmit({ date }) {\r\n        const jsDate = date ? moment(date, 'jYYYY/jMM/jDD').toDate() : null\r\n        const response = await sendApi({\r\n            action: 'add_news_to_list',\r\n            control: 'news',\r\n            data: {\r\n            news_id: selectedNewsId.value,\r\n            run_time: jsDate ?? null,\r\n            }\r\n        })\r\n        if (response.status === 'success') {\r\n            showModal.value = false\r\n            newsStore.fetchNews()\r\n        } else {\r\n            alert('خطا در ثبت تاریخ اجرا')\r\n        }\r\n    }\r\n    let intervalId = null\r\n    onMounted(() => {\r\n        newsStore.fetchNews()\r\n        intervalId = setInterval(() => {\r\n            newsStore.fetchNews()\r\n        }, 6000)\r\n    })\r\n    onBeforeUnmount(() => {if (intervalId) clearInterval(intervalId)})\r\n</script>\r\n<style scoped>\r\n    .user-info svg,.user-info img{\r\n        width: 50px;\r\n        height: 50px;\r\n        border-radius: 50px;\r\n        display: inline-block;\r\n    }\r\n    .user-info p{\r\n        display: inline-block;\r\n    }\r\n    .user-info{\r\n        display: flex;\r\n        align-items: center;\r\n    }\r\n    .card-inner {\r\n        width: 100%;\r\n        height: 100%;\r\n        display: flex;\r\n        flex-direction: row-reverse;\r\n        flex-wrap: wrap;\r\n        align-content: flex-start;\r\n        justify-content: center;\r\n        align-items: stretch;\r\n    }\r\n    .card {\r\n        width: 49%;\r\n        min-height: 300px;\r\n        margin: 0 0.5% 10px 0.5%;\r\n        border-radius: 10px;\r\n        box-shadow: 0 0 5px grey;\r\n    }\r\n    .media {\r\n        height: 150px;\r\n        width: auto;\r\n        margin: auto;\r\n    }\r\n    .media img,\r\n    .media video {\r\n        width: 100%;\r\n        height: 100%;\r\n    }\r\n    .card-header {\r\n        display: flex;\r\n        flex-direction: row-reverse;\r\n        flex-wrap: nowrap;\r\n        justify-content: space-between;\r\n        align-items: stretch;\r\n        padding: 6px;\r\n    }\r\n    .description {\r\n        height: 50px;\r\n        padding: 5px;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        width: 95%;\r\n        text-align: center;\r\n        white-space: nowrap;\r\n    }\r\n    .time {\r\n        font-size: 10px;\r\n        padding-left: 10px;\r\n    }\r\n    .choose {\r\n        width: 95%;\r\n        height: 30px;\r\n        background: blue;\r\n        margin: 5px auto;\r\n        text-align: center;\r\n        border-radius: 10px;\r\n        color: white;\r\n        display: block;\r\n        padding-top: 10px;\r\n    }\r\n    @media screen and (max-width: 600px) {\r\n        .card {\r\n            width: 99%;\r\n        }\r\n    }\r\n</style>\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyCI,SAASA,GAAG,EAAEC,SAAS,EAAGC,eAAe,QAAQ,KAAK;AACtD,OAAOC,MAAM,MAAM,gBAAgB;AACnC,SAASC,OAAO,QAAQ,aAAa;AACrC,OAAOC,WAAW,MAAM,2CAA2C;AACnE,OAAOC,aAAa,MAAM,4CAA4C;AACtE,SAASC,YAAY,QAAQ,eAAe;;;;IAC5C,MAAMC,SAAS,GAAGR,GAAG,CAAC,KAAK,CAAC;IAC5B,MAAMS,cAAc,GAAGT,GAAG,CAAC,IAAI,CAAC;IAChC,MAAMU,SAAS,GAAGH,YAAY,CAAC,CAAC;IAChC,SAASI,iBAAiBA,CAACC,EAAE,EAAE;MAC3BH,cAAc,CAACI,KAAK,GAAGD,EAAE;MACzBJ,SAAS,CAACK,KAAK,GAAG,IAAI;IAC1B;IACA,eAAeC,gBAAgBA,CAAC;MAAEC;IAAK,CAAC,EAAE;MACtC,MAAMC,MAAM,GAAGD,IAAI,GAAGZ,MAAM,CAACY,IAAI,EAAE,eAAe,CAAC,CAACE,MAAM,CAAC,CAAC,GAAG,IAAI;MACnE,MAAMC,QAAQ,GAAG,MAAMd,OAAO,CAAC;QAC3Be,MAAM,EAAE,kBAAkB;QAC1BC,OAAO,EAAE,MAAM;QACfC,IAAI,EAAE;UACNC,OAAO,EAAEb,cAAc,CAACI,KAAK;UAC7BU,QAAQ,EAAEP,MAAM,IAAI;QACpB;MACJ,CAAC,CAAC;MACF,IAAIE,QAAQ,CAACM,MAAM,KAAK,SAAS,EAAE;QAC/BhB,SAAS,CAACK,KAAK,GAAG,KAAK;QACvBH,SAAS,CAACe,SAAS,CAAC,CAAC;MACzB,CAAC,MAAM;QACHC,KAAK,CAAC,uBAAuB,CAAC;MAClC;IACJ;IACA,IAAIC,UAAU,GAAG,IAAI;IACrB1B,SAAS,CAAC,MAAM;MACZS,SAAS,CAACe,SAAS,CAAC,CAAC;MACrBE,UAAU,GAAGC,WAAW,CAAC,MAAM;QAC3BlB,SAAS,CAACe,SAAS,CAAC,CAAC;MACzB,CAAC,EAAE,IAAI,CAAC;IACZ,CAAC,CAAC;IACFvB,eAAe,CAAC,MAAM;MAAC,IAAIyB,UAAU,EAAEE,aAAa,CAACF,UAAU,CAAC;IAAA,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}