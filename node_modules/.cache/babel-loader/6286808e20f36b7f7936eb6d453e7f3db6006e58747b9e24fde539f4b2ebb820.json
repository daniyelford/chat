{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport { defineStore } from 'pinia';\nimport { sendApi } from '@/utils/api';\nexport const useUserStore = defineStore('user', {\n  state: () => ({\n    fullName: '',\n    name: '',\n    family: '',\n    mobile: '',\n    wallet: 0,\n    tokenScore: 0,\n    image: '',\n    finger: false,\n    rule: false,\n    hasMore: false,\n    isLoaded: false,\n    ruleInfo: [],\n    users: [],\n    // لیست کاربران\n    loading: false,\n    error: null\n  }),\n  actions: {\n    async fetchUserInfo() {\n      try {\n        const res = await sendApi({\n          action: 'get_user_info',\n          control: 'user'\n        });\n        if (res.status === 'success') {\n          this.fullName = res.fullName;\n          this.name = res.name;\n          this.family = res.family;\n          this.mobile = res.mobile;\n          this.wallet = res.wallet;\n          this.image = res.image;\n          this.finger = res.finger;\n          this.tokenScore = res.token_score;\n          this.rule = Array.isArray(res.rules) && res.rules.length > 0;\n          this.ruleInfo = res.rules;\n          this.isLoaded = true;\n        } else {\n          console.warn('User info error:', res);\n        }\n      } catch (err) {\n        console.error('Error fetching user:', err);\n      }\n    },\n    async fetchUsers({\n      limite = 10,\n      offset = 0\n    }) {\n      this.loading = true;\n      this.error = null;\n      try {\n        const res = await sendApi({\n          action: 'get_users',\n          control: 'user',\n          data: {\n            limite: limite,\n            offset: offset\n          }\n        });\n        if (res.status === 'success') {\n          this.hasMore = res.has_more;\n          this.users = res.data;\n        } else {\n          this.error = res.message || 'خطا در دریافت کاربران';\n        }\n      } catch (err) {\n        this.error = 'خطای ارتباط با سرور';\n        console.error(err);\n      } finally {\n        this.loading = false;\n      }\n    },\n    // افزودن کاربر جدید\n    async addUser(userData) {\n      try {\n        const res = await sendApi({\n          action: 'add_user',\n          control: 'user',\n          data: userData\n        });\n        if (res.status === 'success') {\n          this.users.push(res.data);\n        }\n        return res;\n      } catch (err) {\n        console.error(err);\n      }\n    },\n    // ویرایش اطلاعات کاربر\n    async updateUser(id, updates) {\n      try {\n        const res = await sendApi({\n          action: 'update_user',\n          control: 'user',\n          data: {\n            id: id,\n            data: updates\n          }\n        });\n        if (res.status === 'success') {\n          const index = this.users.findIndex(u => u.id === id);\n          if (index !== -1) {\n            this.users[index] = {\n              ...this.users[index],\n              ...updates\n            };\n          }\n        }\n        return res;\n      } catch (err) {\n        console.error(err);\n      }\n    },\n    async changeUserCategory(id, categoryId) {\n      return this.updateUser(id, {\n        category_id: categoryId\n      });\n    },\n    async toggleBanUser(id, banned) {\n      return this.updateUser(id, {\n        banned\n      });\n    },\n    async deleteUser(id) {\n      try {\n        const res = await sendApi({\n          action: 'delete_user',\n          control: 'user',\n          data: {\n            id: id\n          }\n        });\n        if (res.status === 'success') {\n          this.users = this.users.filter(u => u.id !== id);\n        }\n        return res;\n      } catch (err) {\n        console.error(err);\n      }\n    }\n  },\n  getters: {\n    isLoggedIn: state => !!state.name || !!state.image,\n    totalUsers: state => state.users.length,\n    activeUsers: state => state.users.filter(u => !u.banned),\n    bannedUsers: state => state.users.filter(u => u.banned)\n  }\n});","map":{"version":3,"names":["defineStore","sendApi","useUserStore","state","fullName","name","family","mobile","wallet","tokenScore","image","finger","rule","hasMore","isLoaded","ruleInfo","users","loading","error","actions","fetchUserInfo","res","action","control","status","token_score","Array","isArray","rules","length","console","warn","err","fetchUsers","limite","offset","data","has_more","message","addUser","userData","push","updateUser","id","updates","index","findIndex","u","changeUserCategory","categoryId","category_id","toggleBanUser","banned","deleteUser","filter","getters","isLoggedIn","totalUsers","activeUsers","bannedUsers"],"sources":["D:/GitHub/chat/vue3/src/stores/user.js"],"sourcesContent":["import { defineStore } from 'pinia'\r\nimport { sendApi } from '@/utils/api'\r\nexport const useUserStore = defineStore('user', {\r\n  state: () => ({\r\n    fullName: '',\r\n    name: '',\r\n    family: '',\r\n    mobile: '',\r\n    wallet: 0,\r\n    tokenScore: 0,\r\n    image: '',\r\n    finger: false,\r\n    rule: false,\r\n    hasMore: false,\r\n    isLoaded: false,\r\n    ruleInfo: [],\r\n    users: [], // لیست کاربران\r\n    loading: false,\r\n    error: null,\r\n  }),\r\n\r\n  actions: {\r\n    async fetchUserInfo() {\r\n      try {\r\n        const res = await sendApi({ action: 'get_user_info', control: 'user' })\r\n        if (res.status === 'success') {\r\n          this.fullName = res.fullName\r\n          this.name = res.name\r\n          this.family = res.family\r\n          this.mobile = res.mobile\r\n          this.wallet = res.wallet\r\n          this.image = res.image\r\n          this.finger = res.finger\r\n          this.tokenScore = res.token_score\r\n          this.rule = Array.isArray(res.rules) && res.rules.length > 0\r\n          this.ruleInfo = res.rules\r\n          this.isLoaded = true\r\n        } else {\r\n          console.warn('User info error:', res)\r\n        }\r\n      } catch (err) {\r\n        console.error('Error fetching user:', err)\r\n      }\r\n    },\r\n    async fetchUsers({limite = 10 , offset = 0 }) {\r\n      this.loading = true\r\n      this.error = null\r\n      try {\r\n        const res = await sendApi({ action: 'get_users', control: 'user' , data: { limite : limite , offset : offset } })\r\n        if (res.status === 'success') {\r\n          this.hasMore = res.has_more\r\n          this.users = res.data\r\n        } else {\r\n          this.error = res.message || 'خطا در دریافت کاربران'\r\n        }\r\n      } catch (err) {\r\n        this.error = 'خطای ارتباط با سرور'\r\n        console.error(err)\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    },\r\n\r\n    // افزودن کاربر جدید\r\n    async addUser(userData) {\r\n      try {\r\n        const res = await sendApi({\r\n          action: 'add_user',\r\n          control: 'user',\r\n          data: userData\r\n        })\r\n        if (res.status === 'success') {\r\n          this.users.push(res.data)\r\n        }\r\n        return res\r\n      } catch (err) {\r\n        console.error(err)\r\n      }\r\n    },\r\n\r\n    // ویرایش اطلاعات کاربر\r\n    async updateUser(id, updates) {\r\n      try {\r\n        const res = await sendApi({\r\n          action: 'update_user',\r\n          control: 'user',\r\n          data:{ \r\n            id:id,\r\n            data: updates\r\n          }\r\n        })\r\n        if (res.status === 'success') {\r\n          const index = this.users.findIndex(u => u.id === id)\r\n          if (index !== -1) {\r\n            this.users[index] = { ...this.users[index], ...updates }\r\n          }\r\n        }\r\n        return res\r\n      } catch (err) {\r\n        console.error(err)\r\n      }\r\n    },\r\n    async changeUserCategory(id, categoryId) {\r\n      return this.updateUser(id, { category_id: categoryId })\r\n    },\r\n    async toggleBanUser(id, banned) {\r\n      return this.updateUser(id, { banned })\r\n    },\r\n    async deleteUser(id) {\r\n      try {\r\n        const res = await sendApi({\r\n          action: 'delete_user',\r\n          control: 'user',\r\n          data:{\r\n            id:id\r\n          }\r\n        })\r\n        if (res.status === 'success') {\r\n          this.users = this.users.filter(u => u.id !== id)\r\n        }\r\n        return res\r\n      } catch (err) {\r\n        console.error(err)\r\n      }\r\n    },\r\n  },\r\n\r\n  getters: {\r\n    isLoggedIn: (state) => !!state.name || !!state.image,\r\n    totalUsers: (state) => state.users.length,\r\n    activeUsers: (state) => state.users.filter(u => !u.banned),\r\n    bannedUsers: (state) => state.users.filter(u => u.banned),\r\n  },\r\n})\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}