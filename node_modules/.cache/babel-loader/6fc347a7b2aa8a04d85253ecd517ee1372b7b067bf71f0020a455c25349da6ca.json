{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { defineStore } from 'pinia';\nimport { sendApi } from '@/utils/api';\nexport const useNewsStore = defineStore('news', {\n  state: () => ({\n    cards: [],\n    total: 0,\n    lastUpdate: null,\n    isLoaded: false,\n    hasRule: false\n  }),\n  actions: {\n    async fetchNews({\n      limit = 10,\n      offset = 0,\n      append = false\n    } = {}) {\n      const res = await sendApi({\n        action: 'get_news',\n        control: 'news',\n        data: {\n          limit,\n          offset\n        }\n      });\n      if (res.status === 'success') {\n        const newCards = res.data.map(item => ({\n          id: item.id,\n          description: item.description,\n          created_at: item.created_at,\n          location: {\n            city: item.city,\n            lat: item.address_lat,\n            lon: item.address_lon,\n            address: item.address\n          },\n          category: Array.isArray(item.category) ? item.category.map(category => ({\n            id: category.id,\n            title: category.title\n          })) : [],\n          user: {\n            id: item.user_account_id,\n            name: item.user_name,\n            family: item.user_family,\n            phone: item.user_phone,\n            image: item.user_image_url\n          },\n          medias: Array.isArray(item.media) ? item.media.map(media => ({\n            type: media.type,\n            url: media.url\n          })) : []\n        }));\n        // this.cards = append ? [...this.cards, ...newCards] : newCards\n        this.cards = append ? [...this.cards, ...newCards] : [...newCards, ...this.cards];\n        this.total = res.count_all;\n        this.lastUpdate = new Date().toISOString();\n        this.isLoaded = true;\n        this.hasRule = res.rule ?? false;\n      }\n    },\n    async fetchNewsById(id) {\n      const res = await sendApi({\n        action: 'get_news_by_id',\n        control: 'news',\n        data: {\n          id\n        }\n      });\n      if (res.status === 'success') {\n        const item = res.data;\n        return {\n          id: item.id,\n          description: item.description,\n          created_at: item.created_at,\n          status: item.status,\n          privacy: item.privacy,\n          location: {\n            city: item.city,\n            lat: item.address_lat,\n            lon: item.address_lon,\n            address: item.address\n          },\n          category: Array.isArray(item.category) ? item.category.map(category => ({\n            id: category.id,\n            title: category.title\n          })) : [],\n          user: {\n            id: item.user_account_id,\n            name: item.user_name,\n            family: item.user_family,\n            phone: item.user_phone,\n            image: item.user_image_url\n          },\n          medias: Array.isArray(item.media) ? item.media.map(media => ({\n            type: media.type,\n            url: media.url\n          })) : []\n        };\n      }\n      return null;\n    }\n  }\n});","map":{"version":3,"names":["defineStore","sendApi","useNewsStore","state","cards","total","lastUpdate","isLoaded","hasRule","actions","fetchNews","limit","offset","append","res","action","control","data","status","newCards","map","item","id","description","created_at","location","city","lat","address_lat","lon","address_lon","address","category","Array","isArray","title","user","user_account_id","name","user_name","family","user_family","phone","user_phone","image","user_image_url","medias","media","type","url","count_all","Date","toISOString","rule","fetchNewsById","privacy"],"sources":["D:/GitHub/ci3-vue3/vue3/src/stores/news.js"],"sourcesContent":["import { defineStore } from 'pinia'\r\nimport { sendApi } from '@/utils/api'\r\nexport const useNewsStore = defineStore('news', {\r\n  state: () => ({\r\n    cards: [],\r\n    total:0,\r\n    lastUpdate: null,\r\n    isLoaded: false,\r\n    hasRule: false\r\n  }),\r\n  actions: {\r\n    async fetchNews({ limit = 10, offset = 0, append = false } = {}) {\r\n      const res = await sendApi({\r\n        action: 'get_news',\r\n        control: 'news',\r\n        data: { limit, offset }\r\n      })\r\n      if (res.status === 'success') {\r\n        const newCards = res.data.map(item => ({\r\n          id: item.id,\r\n          description: item.description,\r\n          created_at: item.created_at,\r\n          location: {\r\n            city: item.city,\r\n            lat: item.address_lat,\r\n            lon: item.address_lon,\r\n            address: item.address,\r\n          },\r\n          category: Array.isArray(item.category) ? item.category.map(category => ({\r\n            id: category.id,\r\n            title: category.title\r\n          })) : [],\r\n          user: {\r\n            id: item.user_account_id,\r\n            name: item.user_name,\r\n            family: item.user_family,\r\n            phone: item.user_phone,\r\n            image: item.user_image_url,\r\n          },\r\n          medias: Array.isArray(item.media) ? item.media.map(media => ({\r\n            type: media.type,\r\n            url: media.url\r\n          })) : []\r\n        }))\r\n        // this.cards = append ? [...this.cards, ...newCards] : newCards\r\n        this.cards = append ? [...this.cards, ...newCards] : [...newCards, ...this.cards]\r\n        this.total = res.count_all\r\n        this.lastUpdate = new Date().toISOString()\r\n        this.isLoaded = true\r\n        this.hasRule = res.rule ?? false\r\n      }\r\n    },\r\n    async fetchNewsById(id) {\r\n      const res = await sendApi({\r\n        action: 'get_news_by_id',\r\n        control: 'news',\r\n        data: { id }\r\n      })\r\n\r\n      if (res.status === 'success') {\r\n        const item = res.data\r\n\r\n        return {\r\n          id: item.id,\r\n          description: item.description,\r\n          created_at: item.created_at,\r\n          status:item.status,\r\n          privacy:item.privacy,\r\n          location: {\r\n            city: item.city,\r\n            lat: item.address_lat,\r\n            lon: item.address_lon,\r\n            address: item.address,\r\n          },\r\n          category: Array.isArray(item.category) ? item.category.map(category => ({\r\n            id: category.id,\r\n            title: category.title\r\n          })) : [],\r\n          user: {\r\n            id: item.user_account_id,\r\n            name: item.user_name,\r\n            family: item.user_family,\r\n            phone: item.user_phone,\r\n            image: item.user_image_url,\r\n          },\r\n          medias: Array.isArray(item.media) ? item.media.map(media => ({\r\n            type: media.type,\r\n            url: media.url\r\n          })) : []\r\n        }\r\n      }\r\n      return null\r\n    }\r\n  }\r\n})\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}