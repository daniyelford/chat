{"ast":null,"code":"import { createRouter, createWebHistory } from 'vue-router';\nimport UploadView from \"@/views/home/UploadView.vue\";\nimport LoginView from '@/views/home/LoginView.vue';\nimport DashboardView from '@/views/dashboard/DashboardView.vue';\nimport RegisterView from '@/views/home/RegisterView.vue';\nimport WalletView from '@/views/dashboard/WalletView.vue';\nimport ReportListView from '@/views/dashboard/ReportListView.vue';\nimport AddNewsView from '@/views/dashboard/AddNewsView.vue';\nimport ManageNewsViews from '@/views/dashboard/ManageNewsViews.vue';\nimport UserSettingView from '@/views/dashboard/UserSettingView.vue';\nimport CartableView from '@/views/dashboard/CartableView.vue';\nimport ShowCartableView from '@/views/dashboard/ShowCartableView.vue';\nimport { sendApi } from '@/utils/api';\nconst routes = [{\n  path: '/upload',\n  name: 'upload',\n  component: UploadView\n}, {\n  path: '/',\n  name: 'login',\n  component: LoginView,\n  meta: {\n    onlyAuth: true\n  }\n}, {\n  path: '/register',\n  name: 'register',\n  component: RegisterView,\n  meta: {\n    checkHasMobileId: true,\n    onlyAuth: true\n  }\n}, {\n  path: '/dashboard',\n  name: 'dashboard',\n  component: DashboardView,\n  meta: {\n    requiresAuth: true\n  }\n}, {\n  path: '/wallet',\n  name: 'wallet',\n  component: WalletView,\n  meta: {\n    requiresAuth: true\n  }\n}, {\n  path: '/add-news',\n  name: 'add-news',\n  component: AddNewsView,\n  meta: {\n    requiresAuth: true\n  }\n}, {\n  path: '/report-list',\n  name: 'report-list',\n  component: ReportListView,\n  meta: {\n    requiresAuth: true\n  }\n}, {\n  path: '/manage-news',\n  name: 'manage-news',\n  component: ManageNewsViews,\n  meta: {\n    requiresAuth: true\n  }\n}, {\n  path: '/user-setting',\n  name: 'user-setting',\n  component: UserSettingView,\n  meta: {\n    requiresAuth: true\n  }\n}, {\n  path: '/cartable',\n  name: 'cartable',\n  component: CartableView,\n  meta: {\n    requiresAuth: true\n  }\n}, {\n  path: '/cartable/:id',\n  name: 'cartable',\n  component: ShowCartableView,\n  props: true,\n  meta: {\n    requiresAuth: true\n  }\n}];\nconst router = createRouter({\n  history: createWebHistory(process.env.BASE_URL),\n  routes\n});\nrouter.beforeEach(async (to, from, next) => {\n  try {\n    const meta = to.meta;\n    if (meta.requiresAuth) {\n      const res = await sendApi({\n        action: 'check_auth',\n        control: 'security'\n      });\n      if (res.status !== 'success') return next('/');\n    }\n    if (meta.checkHasMobileId) {\n      const res = await sendApi({\n        action: 'check_has_mobile',\n        control: 'security'\n      });\n      if (res.status !== 'success') return next('/');\n    }\n    if (meta.onlyAuth) {\n      const res = await sendApi({\n        action: 'check_auth',\n        control: 'security'\n      });\n      if (res.status === 'success') return next('/dashboard');\n    }\n    next();\n  } catch (e) {\n    console.error('Router Guard Error:', e);\n    next('/');\n  }\n});\nexport default router;","map":{"version":3,"names":["createRouter","createWebHistory","UploadView","LoginView","DashboardView","RegisterView","WalletView","ReportListView","AddNewsView","ManageNewsViews","UserSettingView","CartableView","ShowCartableView","sendApi","routes","path","name","component","meta","onlyAuth","checkHasMobileId","requiresAuth","props","router","history","process","env","BASE_URL","beforeEach","to","from","next","res","action","control","status","e","console","error"],"sources":["D:/GitHub/ci3-vue3/vue3/src/router/index.js"],"sourcesContent":["import { createRouter, createWebHistory } from 'vue-router'\r\nimport UploadView from \"@/views/home/UploadView.vue\";\r\nimport LoginView from '@/views/home/LoginView.vue';\r\nimport DashboardView from '@/views/dashboard/DashboardView.vue';\r\nimport RegisterView from '@/views/home/RegisterView.vue';\r\nimport WalletView from '@/views/dashboard/WalletView.vue';\r\nimport ReportListView from '@/views/dashboard/ReportListView.vue';\r\nimport AddNewsView from '@/views/dashboard/AddNewsView.vue';\r\nimport ManageNewsViews from '@/views/dashboard/ManageNewsViews.vue';\r\nimport UserSettingView from '@/views/dashboard/UserSettingView.vue';\r\nimport CartableView from '@/views/dashboard/CartableView.vue';\r\nimport ShowCartableView from '@/views/dashboard/ShowCartableView.vue';\r\nimport { sendApi } from '@/utils/api';\r\n\r\nconst routes = [\r\n  {\r\n    path: '/upload',\r\n    name: 'upload',\r\n    component: UploadView\r\n  },\r\n  {\r\n    path: '/',\r\n    name: 'login',\r\n    component: LoginView,\r\n    meta:{onlyAuth:true}\r\n  },\r\n  {\r\n    path: '/register',\r\n    name: 'register',\r\n    component: RegisterView,\r\n    meta:{checkHasMobileId:true,onlyAuth:true}\r\n  },\r\n  {\r\n    path: '/dashboard',\r\n    name: 'dashboard',\r\n    component: DashboardView,\r\n    meta: { requiresAuth: true }\r\n  },\r\n  {\r\n    path: '/wallet',\r\n    name: 'wallet',\r\n    component: WalletView,\r\n    meta: { requiresAuth: true }\r\n  },\r\n  {\r\n    path: '/add-news',\r\n    name: 'add-news',\r\n    component: AddNewsView,\r\n    meta: { requiresAuth: true }\r\n  },\r\n  {\r\n    path: '/report-list',\r\n    name: 'report-list',\r\n    component: ReportListView,\r\n    meta: { requiresAuth: true }\r\n  },\r\n  {\r\n    path: '/manage-news',\r\n    name: 'manage-news',\r\n    component: ManageNewsViews,\r\n    meta: { requiresAuth: true }\r\n  },\r\n  {\r\n    path: '/user-setting',\r\n    name: 'user-setting',\r\n    component: UserSettingView,\r\n    meta: { requiresAuth: true }\r\n  },\r\n  {\r\n    path: '/cartable',\r\n    name: 'cartable',\r\n    component: CartableView,\r\n    meta: { requiresAuth: true }\r\n  },\r\n  {\r\n    path: '/cartable/:id',\r\n    name: 'cartable',\r\n    component: ShowCartableView,\r\n    props: true,\r\n    meta: { requiresAuth: true }\r\n  },\r\n\r\n  \r\n]\r\n\r\nconst router = createRouter({\r\n  history: createWebHistory(process.env.BASE_URL),\r\n  routes\r\n})\r\n\r\nrouter.beforeEach(async (to, from, next) => {\r\n  try {\r\n    const meta = to.meta;\r\n    if (meta.requiresAuth) {\r\n      const res = await sendApi({ \r\n        action: 'check_auth' ,\r\n        control:'security'\r\n       });\r\n      if (res.status !== 'success') return next('/');\r\n    }\r\n    if (meta.checkHasMobileId) {\r\n      const res = await sendApi({ \r\n        action: 'check_has_mobile',\r\n        control:'security'\r\n      });\r\n      if (res.status !== 'success') return next('/');\r\n    }\r\n    if (meta.onlyAuth) {\r\n      const res = await sendApi({ \r\n        action: 'check_auth',\r\n        control:'security'\r\n      });\r\n      if (res.status === 'success') return next('/dashboard');\r\n    }\r\n    next();\r\n  } catch (e) {\r\n    console.error('Router Guard Error:', e);\r\n    next('/');\r\n  }\r\n});\r\n\r\n\r\nexport default router\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}