{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"map-wrapper\"\n};\nimport { onMounted, ref, watch, createApp, h } from 'vue';\nimport L from 'leaflet';\nimport MediaSlider from '../media/MediaSlider.vue';\nimport 'leaflet/dist/leaflet.css';\nimport { BASE_URL } from '@/config';\nimport { nextTick } from 'vue';\nexport default {\n  __name: 'StaticMapWithMarkers',\n  props: {\n    center: {\n      type: Object,\n      required: true\n    },\n    markers: {\n      type: Array,\n      default: () => []\n    }\n  },\n  setup(__props) {\n    const props = __props;\n    const map = ref(null);\n    const markerLayerGroup = ref(null);\n    const markerIcon = L.icon({\n      iconUrl: BASE_URL + '/assets/images/marker.svg',\n      iconSize: [32, 32],\n      iconAnchor: [16, 32]\n    });\n    onMounted(() => {\n      map.value = L.map('multi-marker-map').setView([props.center.lat, props.center.lon], 13);\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        attribution: '&copy; OpenStreetMap contributors'\n      }).addTo(map.value);\n      markerLayerGroup.value = L.layerGroup().addTo(map.value);\n      renderMarkers();\n    });\n    watch(() => props.markers, () => {\n      renderMarkers();\n    }, {\n      deep: true\n    });\n    watch(() => props.center, val => {\n      if (val && val.lat && val.lon && map.value) {\n        map.value.flyTo([val.lat, val.lon], 13, {\n          animate: true,\n          duration: 1.2\n        });\n      }\n    }, {\n      immediate: true\n    });\n    const truncateText = (text, max = 50) => {\n      if (!text) return '';\n      return text.length > max ? text.slice(0, max) + '...' : text;\n    };\n    const renderMarkers = () => {\n      if (!markerLayerGroup.value) return;\n      markerLayerGroup.value.clearLayers();\n      props.markers.forEach(m => {\n        const leafletMarker = L.marker([m.lat, m.lon], {\n          icon: markerIcon\n        });\n        const container = document.createElement('div');\n        container.style.maxWidth = '250px';\n        const app = createApp({\n          render() {\n            return h('div', {\n              style: 'direction: rtl;text-align: center;'\n            }, [h('strong', {\n              style: 'margin-bottom: 10px;display: inline-block;'\n            }, m.title || ''), h(MediaSlider, {\n              medias: m.medias || []\n            }), m.categories?.length ? h('ul', {\n              style: 'display:flex;justify-content: center;margin: 5px 0; padding: 0; list-style: none;'\n            }, m.categories.map(c => h('li', {\n              style: 'background: #f3f3f3; margin: 2px 0; padding: 4px 8px; border-radius: 4px; font-size: 13px;'\n            }, c.title))) : null, h('p', {\n              style: 'margin: 5px 0;'\n            }, truncateText(m.description) || ''), h('p', {\n              style: 'margin: 5px 0;'\n            }, m.address || '')]);\n          }\n        });\n        app.component('MediaSlider', MediaSlider);\n        app.mount(container);\n        nextTick(() => {\n          leafletMarker.bindPopup(container);\n          leafletMarker.addTo(markerLayerGroup.value);\n        });\n      });\n    };\n    return (_ctx, _cache) => {\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, _cache[0] || (_cache[0] = [_createElementVNode(\"div\", {\n        id: \"multi-marker-map\",\n        class: \"map\"\n      }, null, -1)]));\n    };\n  }\n};","map":{"version":3,"names":["onMounted","ref","watch","createApp","h","L","MediaSlider","BASE_URL","nextTick","props","__props","map","markerLayerGroup","markerIcon","icon","iconUrl","iconSize","iconAnchor","value","setView","center","lat","lon","tileLayer","attribution","addTo","layerGroup","renderMarkers","markers","deep","val","flyTo","animate","duration","immediate","truncateText","text","max","length","slice","clearLayers","forEach","m","leafletMarker","marker","container","document","createElement","style","maxWidth","app","render","title","medias","categories","c","description","address","component","mount","bindPopup"],"sources":["D:/GitHub/chat/vue3/src/components/tooles/places/StaticMapWithMarkers.vue"],"sourcesContent":["<template>\r\n  <div class=\"map-wrapper\">\r\n    <div id=\"multi-marker-map\" class=\"map\"></div>\r\n  </div>\r\n</template>\r\n<script setup>\r\n  import { onMounted, ref, defineProps, watch, createApp ,h } from 'vue'\r\n  import L from 'leaflet'\r\n  import MediaSlider from '../media/MediaSlider.vue'\r\n  import 'leaflet/dist/leaflet.css'\r\n  import { BASE_URL } from '@/config'\r\n  import { nextTick } from 'vue'\r\n  const props = defineProps({\r\n    center: { type: Object, required: true },\r\n    markers: {\r\n      type: Array,\r\n      default: () => []\r\n    }\r\n  })\r\n  const map = ref(null)\r\n  const markerLayerGroup = ref(null)\r\n  const markerIcon = L.icon({\r\n    iconUrl: BASE_URL + '/assets/images/marker.svg',\r\n    iconSize: [32, 32],\r\n    iconAnchor: [16, 32]\r\n  })\r\n  onMounted(() => {\r\n    map.value = L.map('multi-marker-map').setView([props.center.lat, props.center.lon], 13)\r\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n      attribution: '&copy; OpenStreetMap contributors',\r\n    }).addTo(map.value)\r\n    markerLayerGroup.value = L.layerGroup().addTo(map.value)\r\n    renderMarkers()\r\n  })\r\n  watch(() => props.markers, () => {\r\n    renderMarkers()\r\n  }, { deep: true })\r\n  watch(() => props.center, (val) => {\r\n    if (val && val.lat && val.lon && map.value) {\r\n      map.value.flyTo([val.lat, val.lon], 13, {\r\n        animate: true,\r\n        duration: 1.2\r\n      })\r\n    }\r\n  }, { immediate: true })\r\n  const truncateText = (text, max = 50) => {\r\n    if (!text) return ''\r\n    return text.length > max ? text.slice(0, max) + '...' : text\r\n  }\r\n  const renderMarkers = () => {\r\n    if (!markerLayerGroup.value) return\r\n    markerLayerGroup.value.clearLayers()\r\n    props.markers.forEach(m => {\r\n      const leafletMarker = L.marker([m.lat, m.lon], { icon: markerIcon })\r\n      const container = document.createElement('div')\r\n      container.style.maxWidth = '250px'\r\n      const app = createApp({\r\n        render() {\r\n          return h('div', {style:'direction: rtl;text-align: center;'} , [\r\n            h('strong',{style:'margin-bottom: 10px;display: inline-block;'}, m.title || ''),\r\n            h(MediaSlider, {\r\n              medias: m.medias || []\r\n            }),\r\n            m.categories?.length ? \r\n              h('ul', { style: 'display:flex;justify-content: center;margin: 5px 0; padding: 0; list-style: none;' },\r\n                m.categories.map(c =>\r\n                  h('li', {\r\n                    style: 'background: #f3f3f3; margin: 2px 0; padding: 4px 8px; border-radius: 4px; font-size: 13px;'\r\n                  }, c.title)\r\n                )\r\n              )\r\n              : null ,\r\n            h('p', { style: 'margin: 5px 0;' }, truncateText(m.description) || ''),\r\n            h('p', { style: 'margin: 5px 0;' }, m.address || ''),\r\n          ])\r\n        }\r\n      })\r\n      app.component('MediaSlider', MediaSlider)\r\n      app.mount(container)\r\n      nextTick(() => {\r\n        leafletMarker.bindPopup(container)\r\n        leafletMarker.addTo(markerLayerGroup.value)\r\n      })\r\n    })\r\n  }\r\n</script>\r\n<style scoped>\r\n  .map-wrapper {\r\n    width: 100%;\r\n    height: 100%;\r\n    position: relative;\r\n  }\r\n  .map {\r\n    width: 100%;\r\n    height: 100%;\r\n    border-radius: 8px;\r\n  }\r\n</style>\r\n"],"mappings":";;;;;;;AAME,SAASA,SAAS,EAAEC,GAAgB,EAAEC,KAAK,EAAEC,SAAS,EAAEC,CAAC,QAAQ,KAAK;AACtE,OAAOC,CAAC,MAAM,SAAS;AACvB,OAAOC,WAAW,MAAM,0BAA0B;AAClD,OAAO,0BAA0B;AACjC,SAASC,QAAQ,QAAQ,UAAU;AACnC,SAASC,QAAQ,QAAQ,KAAK;;;;;;;;;;;;;;IAC9B,MAAMC,KAAK,GAAGC,OAMZ;IACF,MAAMC,GAAG,GAAGV,GAAG,CAAC,IAAI,CAAC;IACrB,MAAMW,gBAAgB,GAAGX,GAAG,CAAC,IAAI,CAAC;IAClC,MAAMY,UAAU,GAAGR,CAAC,CAACS,IAAI,CAAC;MACxBC,OAAO,EAAER,QAAQ,GAAG,2BAA2B;MAC/CS,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC;MAClBC,UAAU,EAAE,CAAC,EAAE,EAAE,EAAE;IACrB,CAAC,CAAC;IACFjB,SAAS,CAAC,MAAM;MACdW,GAAG,CAACO,KAAK,GAAGb,CAAC,CAACM,GAAG,CAAC,kBAAkB,CAAC,CAACQ,OAAO,CAAC,CAACV,KAAK,CAACW,MAAM,CAACC,GAAG,EAAEZ,KAAK,CAACW,MAAM,CAACE,GAAG,CAAC,EAAE,EAAE,CAAC;MACvFjB,CAAC,CAACkB,SAAS,CAAC,oDAAoD,EAAE;QAChEC,WAAW,EAAE;MACf,CAAC,CAAC,CAACC,KAAK,CAACd,GAAG,CAACO,KAAK,CAAC;MACnBN,gBAAgB,CAACM,KAAK,GAAGb,CAAC,CAACqB,UAAU,CAAC,CAAC,CAACD,KAAK,CAACd,GAAG,CAACO,KAAK,CAAC;MACxDS,aAAa,CAAC,CAAC;IACjB,CAAC,CAAC;IACFzB,KAAK,CAAC,MAAMO,KAAK,CAACmB,OAAO,EAAE,MAAM;MAC/BD,aAAa,CAAC,CAAC;IACjB,CAAC,EAAE;MAAEE,IAAI,EAAE;IAAK,CAAC,CAAC;IAClB3B,KAAK,CAAC,MAAMO,KAAK,CAACW,MAAM,EAAGU,GAAG,IAAK;MACjC,IAAIA,GAAG,IAAIA,GAAG,CAACT,GAAG,IAAIS,GAAG,CAACR,GAAG,IAAIX,GAAG,CAACO,KAAK,EAAE;QAC1CP,GAAG,CAACO,KAAK,CAACa,KAAK,CAAC,CAACD,GAAG,CAACT,GAAG,EAAES,GAAG,CAACR,GAAG,CAAC,EAAE,EAAE,EAAE;UACtCU,OAAO,EAAE,IAAI;UACbC,QAAQ,EAAE;QACZ,CAAC,CAAC;MACJ;IACF,CAAC,EAAE;MAAEC,SAAS,EAAE;IAAK,CAAC,CAAC;IACvB,MAAMC,YAAY,GAAGA,CAACC,IAAI,EAAEC,GAAG,GAAG,EAAE,KAAK;MACvC,IAAI,CAACD,IAAI,EAAE,OAAO,EAAE;MACpB,OAAOA,IAAI,CAACE,MAAM,GAAGD,GAAG,GAAGD,IAAI,CAACG,KAAK,CAAC,CAAC,EAAEF,GAAG,CAAC,GAAG,KAAK,GAAGD,IAAI;IAC9D,CAAC;IACD,MAAMT,aAAa,GAAGA,CAAA,KAAM;MAC1B,IAAI,CAACf,gBAAgB,CAACM,KAAK,EAAE;MAC7BN,gBAAgB,CAACM,KAAK,CAACsB,WAAW,CAAC,CAAC;MACpC/B,KAAK,CAACmB,OAAO,CAACa,OAAO,CAACC,CAAC,IAAI;QACzB,MAAMC,aAAa,GAAGtC,CAAC,CAACuC,MAAM,CAAC,CAACF,CAAC,CAACrB,GAAG,EAAEqB,CAAC,CAACpB,GAAG,CAAC,EAAE;UAAER,IAAI,EAAED;QAAW,CAAC,CAAC;QACpE,MAAMgC,SAAS,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;QAC/CF,SAAS,CAACG,KAAK,CAACC,QAAQ,GAAG,OAAO;QAClC,MAAMC,GAAG,GAAG/C,SAAS,CAAC;UACpBgD,MAAMA,CAAA,EAAG;YACP,OAAO/C,CAAC,CAAC,KAAK,EAAE;cAAC4C,KAAK,EAAC;YAAoC,CAAC,EAAG,CAC7D5C,CAAC,CAAC,QAAQ,EAAC;cAAC4C,KAAK,EAAC;YAA4C,CAAC,EAAEN,CAAC,CAACU,KAAK,IAAI,EAAE,CAAC,EAC/EhD,CAAC,CAACE,WAAW,EAAE;cACb+C,MAAM,EAAEX,CAAC,CAACW,MAAM,IAAI;YACtB,CAAC,CAAC,EACFX,CAAC,CAACY,UAAU,EAAEhB,MAAM,GAClBlC,CAAC,CAAC,IAAI,EAAE;cAAE4C,KAAK,EAAE;YAAoF,CAAC,EACpGN,CAAC,CAACY,UAAU,CAAC3C,GAAG,CAAC4C,CAAC,IAChBnD,CAAC,CAAC,IAAI,EAAE;cACN4C,KAAK,EAAE;YACT,CAAC,EAAEO,CAAC,CAACH,KAAK,CACZ,CACF,CAAC,GACC,IAAI,EACRhD,CAAC,CAAC,GAAG,EAAE;cAAE4C,KAAK,EAAE;YAAiB,CAAC,EAAEb,YAAY,CAACO,CAAC,CAACc,WAAW,CAAC,IAAI,EAAE,CAAC,EACtEpD,CAAC,CAAC,GAAG,EAAE;cAAE4C,KAAK,EAAE;YAAiB,CAAC,EAAEN,CAAC,CAACe,OAAO,IAAI,EAAE,CAAC,CACrD,CAAC;UACJ;QACF,CAAC,CAAC;QACFP,GAAG,CAACQ,SAAS,CAAC,aAAa,EAAEpD,WAAW,CAAC;QACzC4C,GAAG,CAACS,KAAK,CAACd,SAAS,CAAC;QACpBrC,QAAQ,CAAC,MAAM;UACbmC,aAAa,CAACiB,SAAS,CAACf,SAAS,CAAC;UAClCF,aAAa,CAAClB,KAAK,CAACb,gBAAgB,CAACM,KAAK,CAAC;QAC7C,CAAC,CAAC;MACJ,CAAC,CAAC;IACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}