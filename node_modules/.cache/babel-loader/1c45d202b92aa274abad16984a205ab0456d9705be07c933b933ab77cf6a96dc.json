{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createBlock as _createBlock, createVNode as _createVNode, vModelText as _vModelText, withDirectives as _withDirectives, withModifiers as _withModifiers, createStaticVNode as _createStaticVNode } from \"vue\";\nconst _hoisted_1 = {\n  key: 0\n};\nconst _hoisted_2 = {\n  key: 1,\n  class: \"cartable-details\"\n};\nconst _hoisted_3 = {\n  class: \"news-section\"\n};\nconst _hoisted_4 = {\n  class: \"news-header\"\n};\nconst _hoisted_5 = {\n  key: 0,\n  class: \"user-info over-news\"\n};\nconst _hoisted_6 = [\"src\"];\nconst _hoisted_7 = [\"href\"];\nconst _hoisted_8 = {\n  class: \"news-description\"\n};\nconst _hoisted_9 = {\n  key: 1,\n  class: \"news-address\"\n};\nconst _hoisted_10 = {\n  class: \"report-section\"\n};\nconst _hoisted_11 = {\n  key: 0,\n  class: \"user-info over-report\"\n};\nconst _hoisted_12 = [\"src\"];\nconst _hoisted_13 = {\n  class: \"report-content\"\n};\nconst _hoisted_14 = {\n  key: 0,\n  class: \"modal-overlay\"\n};\nconst _hoisted_15 = {\n  class: \"modal\"\n};\nconst _hoisted_16 = {\n  class: \"modal-actions\"\n};\nimport { ref, onMounted, onUnmounted, watch, computed } from 'vue';\nimport { useCartableStore } from '@/stores/cartable';\nimport UploaderManyMedia from '@/components/tooles/upload/UploaderManyMedia.vue';\nimport MediaSlider from '@/components/tooles/media/MediaSlider.vue';\nexport default {\n  __name: 'ShowCartable',\n  props: {\n    id: Number\n  },\n  setup(__props) {\n    const props = __props;\n    const form = ref({\n      media_id: [],\n      description: ''\n    });\n    const handleUploadResult = uploadedData => {\n      form.value.media_id = uploadedData.map(item => item.id);\n    };\n    const store = useCartableStore();\n    const item = computed(() => store.getCartableById(props.id));\n    onMounted(async () => {\n      if (!store.allItems.length) {\n        await store.fetchCartables();\n      }\n      store.startPolling();\n    });\n    onUnmounted(() => {\n      store.stopPolling();\n    });\n    watch(props.id, async (newId, oldId) => {\n      if (newId !== oldId) {\n        if (!store.allItems.length) {\n          await store.fetchCartables();\n        }\n      }\n    });\n    return (_ctx, _cache) => {\n      return _openBlock(), _createElementBlock(\"div\", null, [!item.value ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, \" در حال بارگذاری یا موردی یافت نشد \")) : (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createElementVNode(\"section\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [item.value.has_rule ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [item.value.user?.image ? (_openBlock(), _createElementBlock(\"img\", {\n        key: 0,\n        src: item.value.user.image,\n        alt: \"User\",\n        class: \"avatar\"\n      }, null, 8, _hoisted_6)) : _createCommentVNode(\"\", true), _createElementVNode(\"div\", null, [_createElementVNode(\"strong\", null, _toDisplayString(item.value.user.name) + \" \" + _toDisplayString(item.value.user.family), 1), item.value.user?.phone ? (_openBlock(), _createElementBlock(\"a\", {\n        key: 0,\n        href: `tel:${item.value.user.phone}`\n      }, _cache[4] || (_cache[4] = [_createStaticVNode(\"<svg height=\\\"20\\\" width=\\\"20\\\" version=\\\"1.1\\\" class=\\\"tooles\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" viewBox=\\\"0,0,256,256\\\" data-v-ac41ac96=\\\"\\\" data-v-dee1564c><g fill=\\\"none\\\" fill-rule=\\\"nonzero\\\" stroke=\\\"none\\\" stroke-width=\\\"1\\\" stroke-linecap=\\\"butt\\\" stroke-linejoin=\\\"miter\\\" stroke-miterlimit=\\\"10\\\" stroke-dasharray=\\\"\\\" stroke-dashoffset=\\\"0\\\" font-family=\\\"none\\\" font-weight=\\\"none\\\" font-size=\\\"none\\\" text-anchor=\\\"none\\\" style=\\\"mix-blend-mode:normal;\\\" data-v-ac41ac96=\\\"\\\" data-v-dee1564c><g transform=\\\"scale(4,4)\\\" data-v-ac41ac96=\\\"\\\" data-v-dee1564c><path d=\\\"M1,32c0,-17.1 13.9,-31 31,-31c17.1,0 31,13.9 31,31c0,17.1 -13.9,31 -31,31c-17.1,0 -31,-13.9 -31,-31z\\\" fill=\\\"#3ec81c\\\" data-v-ac41ac96=\\\"\\\" data-v-dee1564c></path><path d=\\\"M43.1,51.4c-0.7,0 -1.3,-0.1 -1.9,-0.4c-3.6,-1.6 -10.6,-5.1 -16.8,-11.3c-6.2,-6.2 -9.8,-13.3 -11.4,-16.9c-0.8,-1.8 -0.4,-3.9 1.1,-5.4l3.8,-3.8c0.5,-0.5 1.1,-0.9 1.8,-1c1,-0.2 2,0.2 2.7,0.9l4.9,4.9c1.3,1.3 1.3,3.4 0,4.8l-3.9,3.9c-0.4,0.4 -0.5,1 -0.3,1.5c0.7,1.5 2.3,4.6 5,7.3c2.7,2.7 5.8,4.3 7.3,5c0.5,0.2 1.1,0.1 1.5,-0.3l4,-4c0.5,-0.5 1,-0.8 1.7,-0.9c1,-0.2 2,0.1 2.8,0.9l5.1,5.1c1.2,1.2 1.2,3.2 0,4.4l-3.9,3.9c-0.9,0.9 -2.2,1.4 -3.5,1.4z\\\" fill=\\\"#54e6eb\\\" data-v-ac41ac96=\\\"\\\" data-v-dee1564c></path></g></g></svg>\", 1)]), 8, _hoisted_7)) : _createCommentVNode(\"\", true)])])) : _createCommentVNode(\"\", true)]), item.value.news?.media?.length ? (_openBlock(), _createBlock(MediaSlider, {\n        key: 0,\n        medias: item.value.news.media\n      }, null, 8, [\"medias\"])) : _createCommentVNode(\"\", true), _createElementVNode(\"h2\", _hoisted_8, _toDisplayString(item.value.news.description), 1), item.value.news.address?.address ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, \" موقعیت: \" + _toDisplayString(item.value.news.address.city) + \" - \" + _toDisplayString(item.value.news.address.address), 1)) : _createCommentVNode(\"\", true)]), _createElementVNode(\"section\", _hoisted_10, [!item.value.has_rule ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [item.value.user?.image ? (_openBlock(), _createElementBlock(\"img\", {\n        key: 0,\n        src: item.value.user.image,\n        alt: \"User\",\n        class: \"avatar\"\n      }, null, 8, _hoisted_12)) : _createCommentVNode(\"\", true), _createElementVNode(\"div\", null, [_createElementVNode(\"strong\", null, _toDisplayString(item.value.user.name) + \" \" + _toDisplayString(item.value.user.family), 1), _createElementVNode(\"p\", null, _toDisplayString(item.value.user.phone), 1)])])) : _createCommentVNode(\"\", true), _createElementVNode(\"div\", _hoisted_13, [item.value.has_rule ? (_openBlock(), _createElementBlock(\"button\", {\n        key: 0,\n        onClick: _cache[0] || (_cache[0] = $event => _ctx.isModalOpen = true)\n      }, \" + \")) : _createCommentVNode(\"\", true), item.value.report?.media?.length ? (_openBlock(), _createBlock(MediaSlider, {\n        key: 1,\n        medias: item.value.report.media\n      }, null, 8, [\"medias\"])) : _createCommentVNode(\"\", true), _createElementVNode(\"h3\", null, _toDisplayString(item.value.report?.description || 'بدون پیوست'), 1), _createElementVNode(\"p\", null, \"زمان ثبت: \" + _toDisplayString(item.value.report?.created_at), 1), _createElementVNode(\"p\", null, \"زمان اجرا: \" + _toDisplayString(item.value.report?.run_time), 1)])]), _ctx.isModalOpen ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [_createElementVNode(\"div\", _hoisted_15, [_cache[6] || (_cache[6] = _createElementVNode(\"h3\", null, \"پیوست\", -1)), _createElementVNode(\"form\", {\n        onSubmit: _cache[3] || (_cache[3] = _withModifiers((...args) => _ctx.submitForm && _ctx.submitForm(...args), [\"prevent\"]))\n      }, [_createVNode(UploaderManyMedia, {\n        url: 'report_media/',\n        toAction: 'report',\n        onDone: handleUploadResult\n      }), _withDirectives(_createElementVNode(\"textarea\", {\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => _ctx.reportDescription = $event),\n        rows: \"4\",\n        placeholder: \"توضیحات گزارش...\"\n      }, null, 512), [[_vModelText, _ctx.reportDescription]]), _createElementVNode(\"div\", _hoisted_16, [_cache[5] || (_cache[5] = _createElementVNode(\"button\", {\n        type: \"submit\"\n      }, \"ثبت\", -1)), _createElementVNode(\"button\", {\n        onClick: _cache[2] || (_cache[2] = $event => _ctx.isModalOpen = false)\n      }, \"بستن\")])], 32)])])) : _createCommentVNode(\"\", true)]))]);\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","onUnmounted","watch","computed","useCartableStore","UploaderManyMedia","MediaSlider","props","__props","form","media_id","description","handleUploadResult","uploadedData","value","map","item","id","store","getCartableById","allItems","length","fetchCartables","startPolling","stopPolling","newId","oldId"],"sources":["D:/GitHub/ci3-vue3/vue3/src/components/dashboard/pagesContent/ShowCartable.vue"],"sourcesContent":["<template>\r\n    <div>\r\n        <div v-if=\"!item\">\r\n        در حال بارگذاری یا موردی یافت نشد\r\n        </div>\r\n        <div v-else class=\"cartable-details\">\r\n            <section class=\"news-section\">\r\n                <div class=\"news-header\">\r\n                    <div v-if=\"item.has_rule\" class=\"user-info over-news\">\r\n                        <img v-if=\"item.user?.image\" :src=\"item.user.image\" alt=\"User\" class=\"avatar\" />\r\n                        <div>\r\n                            <strong>{{ item.user.name }} {{ item.user.family }}</strong>\r\n                            <a v-if=\"item.user?.phone\" :href=\"`tel:${item.user.phone}`\">\r\n                                <svg height=\"20\" width=\"20\" version=\"1.1\" class=\"tooles\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0,0,256,256\" data-v-ac41ac96=\"\"><g fill=\"none\" fill-rule=\"nonzero\" stroke=\"none\" stroke-width=\"1\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" stroke-dasharray=\"\" stroke-dashoffset=\"0\" font-family=\"none\" font-weight=\"none\" font-size=\"none\" text-anchor=\"none\" style=\"mix-blend-mode:normal;\" data-v-ac41ac96=\"\"><g transform=\"scale(4,4)\" data-v-ac41ac96=\"\"><path d=\"M1,32c0,-17.1 13.9,-31 31,-31c17.1,0 31,13.9 31,31c0,17.1 -13.9,31 -31,31c-17.1,0 -31,-13.9 -31,-31z\" fill=\"#3ec81c\" data-v-ac41ac96=\"\"></path><path d=\"M43.1,51.4c-0.7,0 -1.3,-0.1 -1.9,-0.4c-3.6,-1.6 -10.6,-5.1 -16.8,-11.3c-6.2,-6.2 -9.8,-13.3 -11.4,-16.9c-0.8,-1.8 -0.4,-3.9 1.1,-5.4l3.8,-3.8c0.5,-0.5 1.1,-0.9 1.8,-1c1,-0.2 2,0.2 2.7,0.9l4.9,4.9c1.3,1.3 1.3,3.4 0,4.8l-3.9,3.9c-0.4,0.4 -0.5,1 -0.3,1.5c0.7,1.5 2.3,4.6 5,7.3c2.7,2.7 5.8,4.3 7.3,5c0.5,0.2 1.1,0.1 1.5,-0.3l4,-4c0.5,-0.5 1,-0.8 1.7,-0.9c1,-0.2 2,0.1 2.8,0.9l5.1,5.1c1.2,1.2 1.2,3.2 0,4.4l-3.9,3.9c-0.9,0.9 -2.2,1.4 -3.5,1.4z\" fill=\"#54e6eb\" data-v-ac41ac96=\"\"></path></g></g></svg>\r\n                            </a>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <MediaSlider v-if=\"item.news?.media?.length\" :medias=\"item.news.media\" />\r\n                <h2 class=\"news-description\">{{ item.news.description }}</h2>\r\n                <div class=\"news-address\" v-if=\"item.news.address?.address\">\r\n                    موقعیت: {{ item.news.address.city }} - {{ item.news.address.address }}\r\n                </div>\r\n            </section>\r\n            <section class=\"report-section\">\r\n                <div v-if=\"!item.has_rule\" class=\"user-info over-report\">\r\n                    <img v-if=\"item.user?.image\" :src=\"item.user.image\" alt=\"User\" class=\"avatar\" />\r\n                    <div>\r\n                        <strong>{{ item.user.name }} {{ item.user.family }}</strong>\r\n                        <p>{{ item.user.phone }}</p>\r\n                    </div>\r\n                </div>\r\n                <div class=\"report-content\">\r\n                    <button v-if=\"item.has_rule\" @click=\"isModalOpen = true\">\r\n                        +\r\n                    </button>\r\n                    \r\n                    <MediaSlider v-if=\"item.report?.media?.length\" :medias=\"item.report.media\" />\r\n                    <h3>{{ item.report?.description || 'بدون پیوست' }}</h3>\r\n                    <p>زمان ثبت: {{ item.report?.created_at }}</p>\r\n                    <p>زمان اجرا: {{ item.report?.run_time }}</p>\r\n                </div>\r\n            </section>\r\n\r\n            <div v-if=\"isModalOpen\" class=\"modal-overlay\">\r\n                <div class=\"modal\">\r\n                    <h3>پیوست</h3>\r\n                    <form @submit.prevent=\"submitForm\">\r\n                        <UploaderManyMedia \r\n                            :url=\"'report_media/'\"\r\n                            :toAction=\"'report'\"\r\n                            @done=\"handleUploadResult\" />\r\n                        <textarea v-model=\"reportDescription\" rows=\"4\" placeholder=\"توضیحات گزارش...\" />\r\n                        <div class=\"modal-actions\">\r\n                            <button type=\"submit\">ثبت</button>\r\n                            <button @click=\"isModalOpen = false\">بستن</button>\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script setup>\r\n    import { ref , onMounted , onUnmounted , defineProps , watch , computed } from 'vue'\r\n    import { useCartableStore } from '@/stores/cartable'\r\n    import UploaderManyMedia from '@/components/tooles/upload/UploaderManyMedia.vue'\r\n    import MediaSlider from '@/components/tooles/media/MediaSlider.vue'\r\n    const props = defineProps({\r\n        id: Number\r\n    })\r\n    const form = ref({\r\n        media_id: [],\r\n        description: '',\r\n    })\r\n    const handleUploadResult = (uploadedData) => {\r\n      form.value.media_id = uploadedData.map(item => item.id)\r\n    }\r\n    const store = useCartableStore()\r\n    const item = computed(() => store.getCartableById(props.id))\r\n    onMounted(async () => {\r\n        if (!store.allItems.length) {\r\n            await store.fetchCartables()\r\n        }\r\n        store.startPolling()\r\n    })\r\n    onUnmounted(() => {\r\n        store.stopPolling()\r\n    })\r\n    watch(props.id, async (newId, oldId) => {\r\n        if (newId !== oldId) {\r\n            if (!store.allItems.length) {\r\n                await store.fetchCartables()\r\n            }\r\n        }\r\n    })\r\n</script>\r\n<style scoped>\r\n    .cartable-details {\r\n        display: flex;\r\n        flex-direction: column;\r\n        gap: 2rem;\r\n    }\r\n    .news-section, .report-section {\r\n        border: 1px solid #ccc;\r\n        padding: 1rem;\r\n        border-radius: 12px;\r\n    }\r\n    .user-info {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 1rem;\r\n        margin-bottom: 1rem;\r\n    }\r\n    .avatar {\r\n        width: 48px;\r\n        height: 48px;\r\n        border-radius: 50%;\r\n        object-fit: cover;\r\n    }\r\n    .news-description {\r\n        margin: 1rem 0;\r\n        font-weight: bold;\r\n    }\r\n    .news-address {\r\n        font-size: 0.9rem;\r\n        color: #555;\r\n    }\r\n</style>"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgEI,SAASA,GAAG,EAAGC,SAAS,EAAGC,WAAyB,EAAGC,KAAK,EAAGC,QAAQ,QAAQ,KAAK;AACpF,SAASC,gBAAgB,QAAQ,mBAAmB;AACpD,OAAOC,iBAAiB,MAAM,kDAAkD;AAChF,OAAOC,WAAW,MAAM,2CAA2C;;;;;;;IACnE,MAAMC,KAAK,GAAGC,OAEZ;IACF,MAAMC,IAAI,GAAGV,GAAG,CAAC;MACbW,QAAQ,EAAE,EAAE;MACZC,WAAW,EAAE;IACjB,CAAC,CAAC;IACF,MAAMC,kBAAkB,GAAIC,YAAY,IAAK;MAC3CJ,IAAI,CAACK,KAAK,CAACJ,QAAQ,GAAGG,YAAY,CAACE,GAAG,CAACC,IAAI,IAAIA,IAAI,CAACC,EAAE,CAAC;IACzD,CAAC;IACD,MAAMC,KAAK,GAAGd,gBAAgB,CAAC,CAAC;IAChC,MAAMY,IAAI,GAAGb,QAAQ,CAAC,MAAMe,KAAK,CAACC,eAAe,CAACZ,KAAK,CAACU,EAAE,CAAC,CAAC;IAC5DjB,SAAS,CAAC,YAAY;MAClB,IAAI,CAACkB,KAAK,CAACE,QAAQ,CAACC,MAAM,EAAE;QACxB,MAAMH,KAAK,CAACI,cAAc,CAAC,CAAC;MAChC;MACAJ,KAAK,CAACK,YAAY,CAAC,CAAC;IACxB,CAAC,CAAC;IACFtB,WAAW,CAAC,MAAM;MACdiB,KAAK,CAACM,WAAW,CAAC,CAAC;IACvB,CAAC,CAAC;IACFtB,KAAK,CAACK,KAAK,CAACU,EAAE,EAAE,OAAOQ,KAAK,EAAEC,KAAK,KAAK;MACpC,IAAID,KAAK,KAAKC,KAAK,EAAE;QACjB,IAAI,CAACR,KAAK,CAACE,QAAQ,CAACC,MAAM,EAAE;UACxB,MAAMH,KAAK,CAACI,cAAc,CAAC,CAAC;QAChC;MACJ;IACJ,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}