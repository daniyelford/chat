{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createBlock as _createBlock, unref as _unref } from \"vue\";\nconst _hoisted_1 = {\n  key: 0,\n  class: \"loading\"\n};\nconst _hoisted_2 = {\n  key: 1,\n  class: \"card-inner\"\n};\nconst _hoisted_3 = {\n  class: \"card-header\"\n};\nconst _hoisted_4 = {\n  key: 0,\n  class: \"location\"\n};\nconst _hoisted_5 = {\n  key: 1,\n  class: \"type\"\n};\nconst _hoisted_6 = {\n  class: \"card-category\"\n};\nconst _hoisted_7 = {\n  key: 1,\n  class: \"description\"\n};\nconst _hoisted_8 = {\n  class: \"time\"\n};\nconst _hoisted_9 = [\"onClick\"];\nconst _hoisted_10 = {\n  key: 2,\n  class: \"none-cart-error\"\n};\nimport { ref, onMounted } from 'vue';\nimport moment from 'moment-jalaali';\nimport { sendApi } from '@/utils/api';\nimport { useNotification } from '@kyvg/vue3-notification';\nimport MediaSlider from '@/components/tooles/media/MediaSlider.vue';\nexport default {\n  __name: 'NewsCards',\n  setup(__props) {\n    const notif = useNotification();\n    const showNotification = () => {\n      notif.notify({\n        title: 'خبر جدید',\n        text: 'اخبار روز محدوده ی خود را با ما دنبال کنید',\n        type: 'info'\n      });\n    };\n    showNotification();\n    // const props = defineProps({\n    //     filters: Object,\n    // })\n    const isLoaded = ref(false);\n    const cards = ref([]);\n    onMounted(async () => {\n      const news = await sendApi({\n        action: 'get_news',\n        control: 'news'\n      });\n      if (news.status === \"success\") {\n        if (news.data.length > 0) {\n          cards.value = news.data.map(cat => ({\n            id: cat.id,\n            location: cat.location,\n            category: cat.category ?? 'کلی',\n            description: cat.description,\n            created_at: cat.created_at,\n            type: cat.type,\n            medias: cat.media.map(media => ({\n              type: media.type,\n              url: media.url\n            }))\n          }));\n        }\n        isLoaded.value = true;\n      } else {\n        console.warn('دریافت دسته‌بندی‌ها ناموفق بود:', news);\n      }\n    });\n    // const filteredCards = computed(() => {\n    //     let result = (cards.value || []).filter(card => {\n    //         const f = props.filters\n    //         if (f) {\n    //             // if (f.withInsight && !card.insight) return false\n    //             if (Array.isArray(f.categories) && f.categories.length > 0 && !f.categories.includes(card.category)) {\n    //                 return false\n    //             }\n    //             // if (Array.isArray(f.socialTypes) && f.socialTypes.length > 0 && !f.socialTypes.some(type => (card.type || '').includes(type))) {\n    //             //     return false\n    //             // }\n    //         }\n    //         // if (props.searchTerm) {\n    //         //     const term = props.searchTerm.toLowerCase()\n    //         //     const username = (card.username || '').toLowerCase()\n    //         //     const title = (card.title || '').toLowerCase()\n    //         //     if (!username.includes(term) && !title.includes(term)) return false\n    //         // }\n    //         return true\n    //     })\n    //     // if (props.sortKey) {\n    //     //     result = [...result].sort((a, b) => (b[props.sortKey] ?? 0) - (a[props.sortKey] ?? 0))\n    //     // }\n    //     return result\n    // })\n    async function addToList(id) {\n      const response = await sendApi({\n        action: 'add_news_to_list',\n        control: 'news',\n        data: id\n      });\n      if (response.status === 'success') {\n        //     const selectedCard = cards.value.find(card => card.id === id)\n        //     if (selectedCard) {\n        //         selectedCard.selected = true\n        //     }\n      } else {\n        alert('ارتباط با اینترنت قطع است');\n      }\n    }\n    return (_ctx, _cache) => {\n      return !isLoaded.value ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, \" در حال بارگذاری... \")) : cards.value.length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(cards.value, card => {\n        return _openBlock(), _createElementBlock(\"div\", {\n          key: card.id,\n          class: \"card\"\n        }, [_createElementVNode(\"div\", _hoisted_3, [card.location !== '' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, _toDisplayString(card.location), 1)) : _createCommentVNode(\"\", true), card.type === 'force' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, \" فوری \")) : _createCommentVNode(\"\", true), _createElementVNode(\"div\", _hoisted_6, _toDisplayString(card.category), 1)]), card.medias.length > 0 ? (_openBlock(), _createBlock(MediaSlider, {\n          key: 0,\n          medias: card.medias\n        }, null, 8, [\"medias\"])) : _createCommentVNode(\"\", true), card.description !== '' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_7, _toDisplayString(card.description), 1)) : _createCommentVNode(\"\", true), _createElementVNode(\"div\", _hoisted_8, _toDisplayString(_unref(moment)(card.created_at).format('jYYYY/jMM/jDD')), 1), _createElementVNode(\"a\", {\n          class: \"choose\",\n          onClick: $event => addToList(card.id)\n        }, \" انتخاب \", 8, _hoisted_9)]);\n      }), 128))])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_10, \" خبری در محدوده شما وجود ندارد \"));\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","moment","sendApi","useNotification","MediaSlider","notif","showNotification","notify","title","text","type","isLoaded","cards","news","action","control","status","data","length","value","map","cat","id","location","category","description","created_at","medias","media","url","console","warn","addToList","response","alert"],"sources":["D:/GitHub/ci3-vue3/vue3/src/components/dashboard/pagesContent/NewsCards.vue"],"sourcesContent":["<template>\r\n    <div class=\"loading\" v-if=\"!isLoaded\">\r\n        در حال بارگذاری...\r\n    </div>\r\n    <div class=\"card-inner\" v-else-if=\"cards.length>0\">\r\n        <div v-for=\"card in cards\" :key=\"card.id\" class=\"card\">\r\n            <div class=\"card-header\">\r\n                <div class=\"location\" v-if=\"card.location!==''\">\r\n                    {{ card.location }}\r\n                </div>\r\n                <div class=\"type\" v-if=\"card.type ==='force'\">\r\n                    فوری\r\n                </div>\r\n                <div class=\"card-category\">\r\n                    {{ card.category }}\r\n                </div>\r\n            </div>\r\n            <MediaSlider v-if=\"card.medias.length>0\" :medias=\"card.medias\" />\r\n            <div class=\"description\" v-if=\"card.description!==''\">\r\n                {{ card.description }}\r\n            </div>\r\n            <div class=\"time\">\r\n                {{ moment(card.created_at).format('jYYYY/jMM/jDD') }}\r\n            </div>\r\n            <a class=\"choose\" @click=\"addToList(card.id)\">\r\n                انتخاب\r\n            </a>\r\n        </div>\r\n    </div>\r\n    <div class=\"none-cart-error\" v-else>\r\n        خبری در محدوده شما وجود ندارد\r\n    </div>\r\n</template>\r\n<script setup>\r\n    import { ref,onMounted } from 'vue'\r\n    import moment from 'moment-jalaali'\r\n    import { sendApi } from '@/utils/api'\r\n    import { useNotification } from '@kyvg/vue3-notification';\r\n    import MediaSlider from '@/components/tooles/media/MediaSlider.vue';\r\n    const notif=useNotification() \r\n    const showNotification = () => {\r\n        notif.notify({\r\n            title: 'خبر جدید',\r\n            text: 'اخبار روز محدوده ی خود را با ما دنبال کنید',\r\n            type: 'info'\r\n        });\r\n    };\r\n    showNotification();\r\n    // const props = defineProps({\r\n    //     filters: Object,\r\n    // })\r\n    const isLoaded = ref(false)\r\n    const cards = ref([])\r\n    onMounted(async () => {\r\n        const news = await sendApi({action: 'get_news',control:'news'});\r\n        if(news.status===\"success\") {\r\n            if(news.data.length>0){\r\n                cards.value = news.data.map(cat => ({\r\n                    id: cat.id,\r\n                    location: cat.location,\r\n                    category: cat.category??'کلی',\r\n                    description: cat.description,\r\n                    created_at: cat.created_at,\r\n                    type: cat.type,\r\n                    medias: cat.media.map(media=>({\r\n                        type:media.type,\r\n                        url:media.url\r\n                    })),\r\n                }))\r\n            }\r\n            isLoaded.value=true\r\n        } else {\r\n            console.warn('دریافت دسته‌بندی‌ها ناموفق بود:', news)\r\n        }\r\n    })\r\n    // const filteredCards = computed(() => {\r\n    //     let result = (cards.value || []).filter(card => {\r\n    //         const f = props.filters\r\n    //         if (f) {\r\n    //             // if (f.withInsight && !card.insight) return false\r\n    //             if (Array.isArray(f.categories) && f.categories.length > 0 && !f.categories.includes(card.category)) {\r\n    //                 return false\r\n    //             }\r\n    //             // if (Array.isArray(f.socialTypes) && f.socialTypes.length > 0 && !f.socialTypes.some(type => (card.type || '').includes(type))) {\r\n    //             //     return false\r\n    //             // }\r\n    //         }\r\n    //         // if (props.searchTerm) {\r\n    //         //     const term = props.searchTerm.toLowerCase()\r\n    //         //     const username = (card.username || '').toLowerCase()\r\n    //         //     const title = (card.title || '').toLowerCase()\r\n    //         //     if (!username.includes(term) && !title.includes(term)) return false\r\n    //         // }\r\n    //         return true\r\n    //     })\r\n    //     // if (props.sortKey) {\r\n    //     //     result = [...result].sort((a, b) => (b[props.sortKey] ?? 0) - (a[props.sortKey] ?? 0))\r\n    //     // }\r\n    //     return result\r\n    // })\r\n    async function addToList(id){\r\n        const response = await sendApi({action: 'add_news_to_list',control:'news',data:id});\r\n        if(response.status ==='success'){\r\n        //     const selectedCard = cards.value.find(card => card.id === id)\r\n        //     if (selectedCard) {\r\n        //         selectedCard.selected = true\r\n        //     }\r\n        }else{\r\n            alert('ارتباط با اینترنت قطع است');            \r\n        }\r\n    }\r\n</script>\r\n<style scoped>\r\n    .card-inner{\r\n        width: 100%;\r\n        height: 100%;\r\n        display: flex;\r\n        flex-direction: row-reverse;\r\n        flex-wrap: wrap;\r\n        align-content: flex-start;\r\n        justify-content: center;\r\n        align-items: stretch;\r\n    }\r\n    .card{\r\n        width: 49%;\r\n        min-height: 300px;\r\n        margin: 0 0.5% 10px 0.5%;\r\n        border-radius: 10px;\r\n        box-shadow: 0 0 5px grey;\r\n    }\r\n    .media{\r\n        height: 150px;\r\n        width: auto;\r\n        margin: auto;\r\n    }\r\n    .media img,.media video{\r\n        width: 100%;\r\n        height: 100%;\r\n    }\r\n    .card-header{\r\n        display: flex;\r\n        flex-direction: row-reverse;\r\n        flex-wrap: nowrap;\r\n        justify-content: space-between;\r\n        align-items: stretch;\r\n        padding: 6px;\r\n    }\r\n    .description {\r\n        height: 50px;\r\n        padding: 5px;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        width: 95%;\r\n        text-align: center;\r\n        white-space: nowrap;\r\n    }\r\n    .time{\r\n        font-size: 10px;\r\n        padding-left: 10px;\r\n    }\r\n    .choose{\r\n        width: 95%;\r\n        height: 30px;\r\n        background: blue;\r\n        margin: 5px auto;\r\n        text-align: center;\r\n        border-radius: 10px;\r\n        color: white;\r\n        display: block;\r\n        padding-top: 10px;\r\n    }\r\n    /* .media video{ */\r\n        /* max-width: 400px; max-height: 300px; margin: 0.5rem; */\r\n    /* } */\r\n    @media screen and (max-width:600px){\r\n        .card{\r\n            width: 99%;\r\n        }\r\n    }\r\n</style>"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCI,SAASA,GAAG,EAACC,SAAS,QAAQ,KAAK;AACnC,OAAOC,MAAM,MAAM,gBAAgB;AACnC,SAASC,OAAO,QAAQ,aAAa;AACrC,SAASC,eAAe,QAAQ,yBAAyB;AACzD,OAAOC,WAAW,MAAM,2CAA2C;;;;IACnE,MAAMC,KAAK,GAACF,eAAe,CAAC,CAAC;IAC7B,MAAMG,gBAAgB,GAAGA,CAAA,KAAM;MAC3BD,KAAK,CAACE,MAAM,CAAC;QACTC,KAAK,EAAE,UAAU;QACjBC,IAAI,EAAE,4CAA4C;QAClDC,IAAI,EAAE;MACV,CAAC,CAAC;IACN,CAAC;IACDJ,gBAAgB,CAAC,CAAC;IAClB;IACA;IACA;IACA,MAAMK,QAAQ,GAAGZ,GAAG,CAAC,KAAK,CAAC;IAC3B,MAAMa,KAAK,GAAGb,GAAG,CAAC,EAAE,CAAC;IACrBC,SAAS,CAAC,YAAY;MAClB,MAAMa,IAAI,GAAG,MAAMX,OAAO,CAAC;QAACY,MAAM,EAAE,UAAU;QAACC,OAAO,EAAC;MAAM,CAAC,CAAC;MAC/D,IAAGF,IAAI,CAACG,MAAM,KAAG,SAAS,EAAE;QACxB,IAAGH,IAAI,CAACI,IAAI,CAACC,MAAM,GAAC,CAAC,EAAC;UAClBN,KAAK,CAACO,KAAK,GAAGN,IAAI,CAACI,IAAI,CAACG,GAAG,CAACC,GAAG,KAAK;YAChCC,EAAE,EAAED,GAAG,CAACC,EAAE;YACVC,QAAQ,EAAEF,GAAG,CAACE,QAAQ;YACtBC,QAAQ,EAAEH,GAAG,CAACG,QAAQ,IAAE,KAAK;YAC7BC,WAAW,EAAEJ,GAAG,CAACI,WAAW;YAC5BC,UAAU,EAAEL,GAAG,CAACK,UAAU;YAC1BhB,IAAI,EAAEW,GAAG,CAACX,IAAI;YACdiB,MAAM,EAAEN,GAAG,CAACO,KAAK,CAACR,GAAG,CAACQ,KAAK,KAAG;cAC1BlB,IAAI,EAACkB,KAAK,CAAClB,IAAI;cACfmB,GAAG,EAACD,KAAK,CAACC;YACd,CAAC,CAAC;UACN,CAAC,CAAC,CAAC;QACP;QACAlB,QAAQ,CAACQ,KAAK,GAAC,IAAI;MACvB,CAAC,MAAM;QACHW,OAAO,CAACC,IAAI,CAAC,iCAAiC,EAAElB,IAAI,CAAC;MACzD;IACJ,CAAC,CAAC;IACF;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA,eAAemB,SAASA,CAACV,EAAE,EAAC;MACxB,MAAMW,QAAQ,GAAG,MAAM/B,OAAO,CAAC;QAACY,MAAM,EAAE,kBAAkB;QAACC,OAAO,EAAC,MAAM;QAACE,IAAI,EAACK;MAAE,CAAC,CAAC;MACnF,IAAGW,QAAQ,CAACjB,MAAM,KAAI,SAAS,EAAC;QAChC;QACA;QACA;QACA;MAAA,CACC,MAAI;QACDkB,KAAK,CAAC,2BAA2B,CAAC;MACtC;IACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}