{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, createVNode as _createVNode, vModelText as _vModelText, withDirectives as _withDirectives, unref as _unref, withCtx as _withCtx, withModifiers as _withModifiers, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = {\n  class: \"top-send\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"reply-preview\"\n};\nconst _hoisted_3 = {\n  class: \"reply-box\"\n};\nconst _hoisted_4 = {\n  class: \"user-replay\"\n};\nconst _hoisted_5 = [\"src\"];\nconst _hoisted_6 = {\n  key: 1,\n  xmlns: \"http://www.w3.org/2000/svg\",\n  fill: \"#000000\",\n  \"enable-background\": \"new 0 0 24 24\",\n  viewBox: \"0 0 24 24\"\n};\nconst _hoisted_7 = {\n  key: 2\n};\nconst _hoisted_8 = {\n  key: 0\n};\nconst _hoisted_9 = {\n  key: 1,\n  class: \"edit\"\n};\nconst _hoisted_10 = {\n  key: 0,\n  class: \"selectInner\"\n};\nconst _hoisted_11 = [\"disabled\"];\nconst _hoisted_12 = [\"disabled\"];\nimport { ref, onMounted, computed, watch } from 'vue';\nimport UploaderManyMedia from '@/components/tooles/upload/UploaderManyMedia.vue';\nimport Multiselect from 'vue-multiselect';\nimport 'vue-multiselect/dist/vue-multiselect.min.css';\nimport AddressSelector from '@/components/tooles/news/AddressSelector .vue';\nimport BaseModal from '@/components/tooles/modal/BaseModal.vue';\nimport { useNewsStore } from '@/stores/news';\nexport default {\n  __name: 'AddNewsForm',\n  props: {\n    replyToId: {\n      type: Number,\n      default: 0\n    },\n    editData: {\n      type: Object,\n      default: null\n    },\n    editReport: {\n      type: Object,\n      default: null\n    }\n  },\n  emits: [\"clearReplyId\"],\n  setup(__props, {\n    emit: __emit\n  }) {\n    const replyCard = ref(null);\n    const newsStore = useNewsStore();\n    const props = __props;\n    const emit = __emit;\n    const uploaderRef = ref(null);\n    const categories = ref([]);\n    const address = ref('');\n    const rule = ref(false);\n    const userCoordinate = ref(null);\n    const isAddressLoading = ref(false);\n    const showModal = ref(false);\n    const medias = ref([]);\n    const form = ref({\n      user_address: {\n        type: 'location',\n        value: ''\n      },\n      media_id: [],\n      description: '',\n      category_id: []\n    });\n    const handleUploadResult = uploadedData => {\n      form.value.media_id = uploadedData.map(item => item.id);\n    };\n    function clearReply() {\n      replyCard.value = null;\n      form.value = {\n        user_address: {\n          type: 'location',\n          value: ''\n        },\n        media_id: [],\n        description: '',\n        category_id: rule.value ? form.value.category_id : []\n      };\n      medias.value = [];\n      emit('clearReplyId');\n    }\n    onMounted(async () => {\n      const data = await newsStore.fetchAddNewsData();\n      if (data) {\n        address.value = data.address;\n        rule.value = data.rule;\n        userCoordinate.value = data.coordinate;\n        if (rule.value) {\n          form.value.category_id = data.category ?? [];\n        }\n        categories.value = data.category ?? [];\n      }\n    });\n    const isSubmitDisabled = computed(() => {\n      const isDescriptionEmpty = !form.value.description.trim();\n      const isCategoryInvalid = !rule.value && (!form.value.category_id || form.value.category_id.length === 0);\n      const isLocationSelected = form.value.user_address?.type === 'location';\n      const isAddressInvalid = isLocationSelected && (!form.value.user_address?.value || !form.value.user_address.value.address?.trim());\n      const isStillLoading = isLocationSelected && isAddressLoading.value;\n      const isUploading = uploaderRef.value?.uploading === true;\n      return isDescriptionEmpty || isCategoryInvalid || isAddressInvalid || isStillLoading || isUploading;\n    });\n    const isSaveDisabled = computed(() => {\n      return !form.value.description.trim();\n    });\n    const submitForm = async () => {\n      const finalData = {\n        ...form.value,\n        reply_to_id: props.replyToId,\n        edit: props.editData?.id || null,\n        edit_report: props.editReport?.id || null\n      };\n      try {\n        const res = await newsStore.addNews(finalData);\n        if (res.status === 'success') {\n          showModal.value = false;\n          clearReply();\n          uploaderRef.value?.reset();\n        } else {\n          alert('خطا در ثبت خبر: ' + res.message);\n        }\n      } catch (err) {\n        alert('خطا در ارسال: ' + err.message);\n      }\n    };\n    watch(() => props.replyToId, newId => {\n      if (newId > 0) {\n        replyCard.value = newsStore.cards.find(c => c.id === newId) || null;\n      } else {\n        replyCard.value = null;\n      }\n    });\n    watch(() => props.editData, newVal => {\n      if (newVal) {\n        form.value.description = newVal.description || '';\n        form.value.category_id = newVal.category;\n        form.value.media_id = newVal.medias?.map(m => m.id) || [];\n        medias.value = newVal.medias || [];\n        form.value.user_address = {\n          type: 'location',\n          value: {\n            address: newVal.location?.address || '',\n            address_id: newVal.location?.address_id || '',\n            lat: newVal.location?.lat,\n            lon: newVal.location?.lon,\n            city: newVal.location?.city\n          }\n        };\n      }\n    });\n    watch(() => props.editReport, report => {\n      if (report) {\n        form.value.description = report.description || '';\n        form.value.media_id = report.media?.map(m => m.id) || [];\n        medias.value = report.media || [];\n        form.value.user_address = {\n          type: 'location',\n          value: {\n            address: report.location?.address || '',\n            address_id: report.location?.address_id || '',\n            lat: report.location?.lat,\n            lon: report.location?.lon,\n            city: report.location?.city\n          }\n        };\n      }\n    });\n    return (_ctx, _cache) => {\n      return _openBlock(), _createElementBlock(_Fragment, null, [_createElementVNode(\"div\", _hoisted_1, [replyCard.value ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"strong\", null, _toDisplayString(props.editReport ? 'ویرایش پاسخ' : 'پاسخ به:'), 1), _createElementVNode(\"div\", _hoisted_4, [replyCard.value.user.image ? (_openBlock(), _createElementBlock(\"img\", {\n        key: 0,\n        src: replyCard.value.user.image,\n        alt: \"reporter image\"\n      }, null, 8, _hoisted_5)) : (_openBlock(), _createElementBlock(\"svg\", _hoisted_6, _cache[7] || (_cache[7] = [_createElementVNode(\"g\", null, [_createElementVNode(\"rect\", {\n        fill: \"none\",\n        height: \"24\",\n        width: \"24\"\n      })], -1), _createElementVNode(\"g\", null, [_createElementVNode(\"path\", {\n        d: \"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm0 14c-2.03 0-4.43-.82-6.14-2.88C7.55 15.8 9.68 15 12 15s4.45.8 6.14 2.12C16.43 19.18 14.03 20 12 20z\"\n      })], -1)]))), replyCard.value?.user ? (_openBlock(), _createElementBlock(\"p\", _hoisted_7, _toDisplayString(replyCard.value.user.name) + \" \" + _toDisplayString(replyCard.value.user.family), 1)) : _createCommentVNode(\"\", true)]), replyCard.value?.description ? (_openBlock(), _createElementBlock(\"p\", _hoisted_8, _toDisplayString(replyCard.value.description), 1)) : _createCommentVNode(\"\", true), _createElementVNode(\"button\", {\n        class: \"close-btn\",\n        onClick: clearReply\n      }, \"×\")])])) : _createCommentVNode(\"\", true), props.editData || props.editReport ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [_createElementVNode(\"button\", {\n        class: \"close-btn\",\n        onClick: clearReply\n      }, \"×\"), _cache[8] || (_cache[8] = _createTextVNode(\" ویرایش \"))])) : _createCommentVNode(\"\", true), _createVNode(UploaderManyMedia, {\n        url: 'news_media/',\n        toAction: 'addNews',\n        modelValue: form.value.media_id,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => form.value.media_id = $event),\n        \"initial-medias\": medias.value,\n        ref_key: \"uploaderRef\",\n        ref: uploaderRef,\n        onDone: handleUploadResult\n      }, null, 8, [\"modelValue\", \"initial-medias\"])]), _createElementVNode(\"form\", {\n        onSubmit: _withModifiers(submitForm, [\"prevent\"])\n      }, [_withDirectives(_createElementVNode(\"textarea\", {\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => form.value.description = $event),\n        rows: \"4\",\n        required: \"\",\n        placeholder: \"متن خبر\"\n      }, null, 512), [[_vModelText, form.value.description]]), _createVNode(BaseModal, {\n        show: showModal.value,\n        onClose: _cache[5] || (_cache[5] = $event => showModal.value = false)\n      }, {\n        default: _withCtx(() => [!rule.value ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [_createVNode(_unref(Multiselect), {\n          modelValue: form.value.category_id,\n          \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => form.value.category_id = $event),\n          options: categories.value,\n          multiple: true,\n          \"track-by\": \"id\",\n          \"value-prop\": 'id',\n          label: \"title\",\n          placeholder: \"گیرنده را انتخاب کنید\",\n          selectLabel: \"برای انتخاب این مورد کلیک کنید\",\n          selectedLabel: \"انتخاب شده\",\n          deselectLabel: \"برای حذف این مورد، کلیک کنید\",\n          noOptions: \"موردی برای انتخاب وجود ندارد\",\n          noResult: \"نتیجه‌ای با این جستجو پیدا نشد\"\n        }, null, 8, [\"modelValue\", \"options\"])])) : _createCommentVNode(\"\", true), _createVNode(AddressSelector, {\n          loginCity: address.value,\n          userCoordinate: userCoordinate.value,\n          \"model-value\": form.value.user_address,\n          onUpdate: _cache[3] || (_cache[3] = val => form.value.user_address = val),\n          onLoading: _cache[4] || (_cache[4] = $event => isAddressLoading.value = $event)\n        }, null, 8, [\"loginCity\", \"userCoordinate\", \"model-value\"]), _createElementVNode(\"button\", {\n          type: \"submit\",\n          disabled: isSubmitDisabled.value\n        }, _toDisplayString(props.editData ? 'ذخیره تغییرات' : 'ثبت خبر'), 9, _hoisted_11)]),\n        _: 1\n      }, 8, [\"show\"])], 32), _createElementVNode(\"button\", {\n        disabled: isSaveDisabled.value,\n        onClick: _cache[6] || (_cache[6] = $event => showModal.value = true)\n      }, _cache[9] || (_cache[9] = [_createElementVNode(\"svg\", {\n        version: \"1.1\",\n        xmlns: \"http://www.w3.org/2000/svg\",\n        \"xmlns:xlink\": \"http://www.w3.org/1999/xlink\",\n        viewBox: \"0,0,256,256\"\n      }, [_createElementVNode(\"g\", {\n        fill: \"#031c66\",\n        \"fill-rule\": \"nonzero\",\n        stroke: \"none\",\n        \"stroke-width\": \"1\",\n        \"stroke-linecap\": \"butt\",\n        \"stroke-linejoin\": \"miter\",\n        \"stroke-miterlimit\": \"10\",\n        \"stroke-dasharray\": \"\",\n        \"stroke-dashoffset\": \"0\",\n        \"font-family\": \"none\",\n        \"font-weight\": \"none\",\n        \"font-size\": \"none\",\n        \"text-anchor\": \"none\",\n        style: {\n          \"mix-blend-mode\": \"normal\"\n        }\n      }, [_createElementVNode(\"g\", {\n        transform: \"scale(2,2)\"\n      }, [_createElementVNode(\"path\", {\n        d: \"M24,20c-7.2,0 -13,5.8 -13,13v62c0,7.2 5.8,13 13,13h72.80078l-7.80078,7.80078c-1.1,1.1 -1.30078,2.99922 -0.30078,4.19922c0.6,0.7 1.40078,1 2.30078,1c0.8,0 1.49961,-0.30039 2.09961,-0.90039l13,-13c1.2,-1.2 1.2,-3.09922 0,-4.19922l-12.90039,-12.90039c-1.1,-1.1 -2.99922,-1.29922 -4.19922,-0.19922c-1.3,1.2 -1.29961,3.09844 -0.09961,4.39844l7.90039,7.90039h-72.80078c-3.9,0 -7,-3.1 -7,-7v-62.09961c0,-3.9 3.1,-7 7,-7h80c3.9,0 7,3.1 7,7v19c0,1.7 1.3,3 3,3c1.7,0 3,-1.3 3,-3v-19c0,-7.2 -5.8,-13 -13,-13zM27.63672,44.83789c-0.7625,-0.0625 -1.53672,0.16211 -2.13672,0.66211c-1.2,1 -1.40039,2.99922 -0.40039,4.19922c0.9,1.1 21.50039,25.30078 38.90039,25.30078c17.4,0 38.00039,-24.19922 38.90039,-25.19922c1.1,-1.3 0.89961,-3.20117 -0.40039,-4.20117c-1.2,-1.1 -3.09922,-0.99922 -4.19922,0.30078c0,0.1 -5.10039,5.99883 -11.90039,11.79883c-8.8,7.4 -16.50039,11.30078 -22.40039,11.30078c-5.9,0 -13.60039,-3.90078 -22.40039,-11.30078c-6.9,-5.8 -11.90039,-11.69883 -11.90039,-11.79883c-0.55,-0.65 -1.3,-1 -2.0625,-1.0625zM114,70c-1.7,0 -3,1.3 -3,3v10c0,1.7 1.3,3 3,3c1.7,0 3,-1.3 3,-3v-10c0,-1.7 -1.3,-3 -3,-3z\"\n      })])])], -1)]), 8, _hoisted_12)], 64);\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","computed","watch","UploaderManyMedia","Multiselect","AddressSelector","BaseModal","useNewsStore","replyCard","newsStore","props","__props","emit","__emit","uploaderRef","categories","address","rule","userCoordinate","isAddressLoading","showModal","medias","form","user_address","type","value","media_id","description","category_id","handleUploadResult","uploadedData","map","item","id","clearReply","data","fetchAddNewsData","coordinate","category","isSubmitDisabled","isDescriptionEmpty","trim","isCategoryInvalid","length","isLocationSelected","isAddressInvalid","isStillLoading","isUploading","uploading","isSaveDisabled","submitForm","finalData","reply_to_id","replyToId","edit","editData","edit_report","editReport","res","addNews","status","reset","alert","message","err","newId","cards","find","c","newVal","m","location","address_id","lat","lon","city","report","media"],"sources":["D:/GitHub/chat/vue3/src/components/dashboard/pagesContent/AddNewsForm.vue"],"sourcesContent":["<template>\r\n  <div class=\"top-send\">\r\n    <div v-if=\"replyCard\" class=\"reply-preview\">\r\n      <div class=\"reply-box\">\r\n        <strong>{{ props.editReport ? 'ویرایش پاسخ' : 'پاسخ به:' }}</strong>\r\n        <div class=\"user-replay\">\r\n          <img v-if=\"replyCard.user.image\" :src=\"replyCard.user.image\" alt=\"reporter image\">\r\n          <svg v-else xmlns=\"http://www.w3.org/2000/svg\" fill=\"#000000\" enable-background=\"new 0 0 24 24\" viewBox=\"0 0 24 24\"><g><rect fill=\"none\" height=\"24\" width=\"24\"/></g><g><path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm0 14c-2.03 0-4.43-.82-6.14-2.88C7.55 15.8 9.68 15 12 15s4.45.8 6.14 2.12C16.43 19.18 14.03 20 12 20z\"/></g></svg>\r\n          <p v-if=\"replyCard?.user\"> {{ replyCard.user.name }} {{ replyCard.user.family }}</p>\r\n        </div>\r\n        <p v-if=\"replyCard?.description\">{{ replyCard.description }}</p>\r\n        <button class=\"close-btn\" @click=\"clearReply\">×</button>\r\n      </div>\r\n    </div>\r\n    <div class=\"edit\" v-if=\"props.editData || props.editReport\">\r\n      <button class=\"close-btn\" @click=\"clearReply\">×</button>\r\n      ویرایش\r\n    </div>\r\n    <UploaderManyMedia\r\n    :url=\"'news_media/'\"\r\n    :toAction=\"'addNews'\"\r\n    v-model=\"form.media_id\"\r\n    :initial-medias=\"medias\"\r\n    ref=\"uploaderRef\"\r\n    @done=\"handleUploadResult\" />\r\n  </div>\r\n  <form @submit.prevent=\"submitForm\">\r\n    <textarea v-model=\"form.description\" rows=\"4\" required placeholder=\"متن خبر\"></textarea>\r\n    <BaseModal :show=\"showModal\" @close=\"showModal = false\">\r\n      <div v-if=\"!rule\" class=\"selectInner\">\r\n        <multiselect\r\n          v-model=\"form.category_id\"\r\n          :options=\"categories\"\r\n          :multiple=\"true\"\r\n          track-by=\"id\"\r\n          :value-prop=\"'id'\"\r\n          label=\"title\"\r\n          placeholder=\"گیرنده را انتخاب کنید\"\r\n          selectLabel=\"برای انتخاب این مورد کلیک کنید\"\r\n          selectedLabel=\"انتخاب شده\"\r\n          deselectLabel=\"برای حذف این مورد، کلیک کنید\"\r\n          noOptions=\"موردی برای انتخاب وجود ندارد\"\r\n          noResult=\"نتیجه‌ای با این جستجو پیدا نشد\"\r\n        />\r\n      </div>\r\n      <AddressSelector\r\n        :loginCity=\"address\"\r\n        :userCoordinate=\"userCoordinate\"\r\n        :model-value=\"form.user_address\"\r\n        @update=\"val => form.user_address = val\"\r\n        @loading=\"isAddressLoading = $event\"\r\n      />\r\n      <button type=\"submit\" :disabled=\"isSubmitDisabled\">\r\n        {{ props.editData ? 'ذخیره تغییرات' : 'ثبت خبر' }}\r\n      </button>\r\n    </BaseModal>\r\n  </form>\r\n  <button :disabled=\"isSaveDisabled\" @click=\"showModal = true\">\r\n    <svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" viewBox=\"0,0,256,256\"><g fill=\"#031c66\" fill-rule=\"nonzero\" stroke=\"none\" stroke-width=\"1\" stroke-linecap=\"butt\" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\" stroke-dasharray=\"\" stroke-dashoffset=\"0\" font-family=\"none\" font-weight=\"none\" font-size=\"none\" text-anchor=\"none\" style=\"mix-blend-mode: normal\"><g transform=\"scale(2,2)\"><path d=\"M24,20c-7.2,0 -13,5.8 -13,13v62c0,7.2 5.8,13 13,13h72.80078l-7.80078,7.80078c-1.1,1.1 -1.30078,2.99922 -0.30078,4.19922c0.6,0.7 1.40078,1 2.30078,1c0.8,0 1.49961,-0.30039 2.09961,-0.90039l13,-13c1.2,-1.2 1.2,-3.09922 0,-4.19922l-12.90039,-12.90039c-1.1,-1.1 -2.99922,-1.29922 -4.19922,-0.19922c-1.3,1.2 -1.29961,3.09844 -0.09961,4.39844l7.90039,7.90039h-72.80078c-3.9,0 -7,-3.1 -7,-7v-62.09961c0,-3.9 3.1,-7 7,-7h80c3.9,0 7,3.1 7,7v19c0,1.7 1.3,3 3,3c1.7,0 3,-1.3 3,-3v-19c0,-7.2 -5.8,-13 -13,-13zM27.63672,44.83789c-0.7625,-0.0625 -1.53672,0.16211 -2.13672,0.66211c-1.2,1 -1.40039,2.99922 -0.40039,4.19922c0.9,1.1 21.50039,25.30078 38.90039,25.30078c17.4,0 38.00039,-24.19922 38.90039,-25.19922c1.1,-1.3 0.89961,-3.20117 -0.40039,-4.20117c-1.2,-1.1 -3.09922,-0.99922 -4.19922,0.30078c0,0.1 -5.10039,5.99883 -11.90039,11.79883c-8.8,7.4 -16.50039,11.30078 -22.40039,11.30078c-5.9,0 -13.60039,-3.90078 -22.40039,-11.30078c-6.9,-5.8 -11.90039,-11.69883 -11.90039,-11.79883c-0.55,-0.65 -1.3,-1 -2.0625,-1.0625zM114,70c-1.7,0 -3,1.3 -3,3v10c0,1.7 1.3,3 3,3c1.7,0 3,-1.3 3,-3v-10c0,-1.7 -1.3,-3 -3,-3z\"></path></g></g></svg>\r\n  </button>\r\n</template>\r\n<script setup>\r\n  import { ref , onMounted , computed , defineProps , defineEmits , watch } from 'vue'\r\n  import UploaderManyMedia from '@/components/tooles/upload/UploaderManyMedia.vue'\r\n  import Multiselect from 'vue-multiselect'\r\n  import 'vue-multiselect/dist/vue-multiselect.min.css'\r\n  import AddressSelector from '@/components/tooles/news/AddressSelector .vue'\r\n  import BaseModal from '@/components/tooles/modal/BaseModal.vue'\r\n  import { useNewsStore } from '@/stores/news'\r\n  const replyCard = ref(null)\r\n  const newsStore = useNewsStore()\r\n  const props = defineProps({\r\n    replyToId: {\r\n      type: Number,\r\n      default: 0,\r\n    },\r\n    editData: { \r\n      type: Object, \r\n      default: null \r\n    },\r\n    editReport: { \r\n      type: Object, \r\n      default: null \r\n    }\r\n  })  \r\n  const emit = defineEmits([\"clearReplyId\"])\r\n  const uploaderRef = ref(null)\r\n  const categories = ref([])\r\n  const address = ref('')\r\n  const rule = ref(false)\r\n  const userCoordinate=ref(null)\r\n  const isAddressLoading = ref(false)\r\n  const showModal = ref(false)\r\n  const medias = ref([])\r\n  const form = ref({\r\n    user_address: { type: 'location', value: '' },\r\n    media_id: [],\r\n    description: '',\r\n    category_id: [],\r\n  })\r\n  const handleUploadResult = (uploadedData) => {\r\n    form.value.media_id = uploadedData.map(item => item.id)\r\n  }\r\n  function clearReply() {\r\n    replyCard.value = null\r\n    form.value = {\r\n      user_address: { type: 'location', value: '' },\r\n      media_id: [],\r\n      description: '',\r\n      category_id: rule.value ? form.value.category_id : []\r\n    }\r\n    medias.value = []\r\n    emit('clearReplyId')\r\n  }\r\n  onMounted(async () => {\r\n    const data = await newsStore.fetchAddNewsData()\r\n    if (data) {      \r\n      address.value = data.address\r\n      rule.value = data.rule\r\n      userCoordinate.value = data.coordinate\r\n      if (rule.value) {\r\n        form.value.category_id = data.category??[]\r\n      }\r\n      categories.value = data.category??[]\r\n    } \r\n  })\r\n  const isSubmitDisabled = computed(() => {\r\n    const isDescriptionEmpty = !form.value.description.trim()\r\n    const isCategoryInvalid = !rule.value && (!form.value.category_id || form.value.category_id.length === 0)\r\n    const isLocationSelected = form.value.user_address?.type === 'location'\r\n    const isAddressInvalid = isLocationSelected && (!form.value.user_address?.value || !form.value.user_address.value.address?.trim())\r\n    const isStillLoading = isLocationSelected && isAddressLoading.value\r\n    const isUploading = uploaderRef.value?.uploading === true\r\n    return isDescriptionEmpty || isCategoryInvalid || isAddressInvalid || isStillLoading || isUploading\r\n  })\r\n  const isSaveDisabled = computed(()=>{\r\n    return !form.value.description.trim()\r\n  })\r\n  const submitForm = async () => {\r\n    const finalData = {\r\n      ...form.value,\r\n      reply_to_id: props.replyToId,\r\n      edit: props.editData?.id || null,\r\n      edit_report: props.editReport?.id || null\r\n    }\r\n    try {\r\n      const res = await newsStore.addNews(finalData)\r\n      if (res.status === 'success') {\r\n        showModal.value = false\r\n        clearReply()\r\n        uploaderRef.value?.reset()\r\n      } else {\r\n        alert('خطا در ثبت خبر: ' + res.message)\r\n      }\r\n    } catch (err) {\r\n      alert('خطا در ارسال: ' + err.message)\r\n    }\r\n  }\r\n  watch(() => props.replyToId, (newId) => {\r\n    if (newId > 0) {\r\n      replyCard.value = newsStore.cards.find(c => c.id === newId) || null\r\n    } else {\r\n      replyCard.value = null\r\n    }\r\n  })\r\n  watch(() => props.editData, (newVal) => {\r\n    if (newVal) {\r\n      form.value.description = newVal.description || ''\r\n      form.value.category_id = newVal.category\r\n      form.value.media_id = newVal.medias?.map(m => m.id) || []\r\n      medias.value = newVal.medias || []\r\n      form.value.user_address = {\r\n        type: 'location',\r\n        value: {\r\n          address: newVal.location?.address || '',\r\n          address_id: newVal.location?.address_id || '',\r\n          lat: newVal.location?.lat,\r\n          lon: newVal.location?.lon,\r\n          city: newVal.location?.city,\r\n        }\r\n      }\r\n    }\r\n  })\r\n  watch(() => props.editReport, (report) => {\r\n    if (report) {\r\n      form.value.description = report.description || ''\r\n      form.value.media_id = report.media?.map(m => m.id) || []\r\n      medias.value = report.media || []\r\n      form.value.user_address = {\r\n        type: 'location',\r\n        value: {\r\n          address: report.location?.address || '',\r\n          address_id: report.location?.address_id || '',\r\n          lat: report.location?.lat,\r\n          lon: report.location?.lon,\r\n          city: report.location?.city\r\n        }\r\n      }\r\n    }\r\n  })\r\n\r\n</script>\r\n<style scoped>\r\n  .edit{\r\n    background: beige;\r\n    direction: rtl;\r\n    padding: 10px;\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 10px;\r\n  }\r\n  .edit button{\r\n    position: static;\r\n    padding: 5px;\r\n    width: 30px;\r\n    height: 30px;\r\n    background: red;\r\n    border-radius: 30px;\r\n  }\r\n  .top-send {\r\n    bottom: 45px;\r\n    left: 0;\r\n    right: 0;\r\n    height: auto;\r\n    position: fixed;\r\n  }\r\n  .reply-box {\r\n    background-color: #fff3cd;\r\n    padding: 10px 5px 3px;\r\n    direction: rtl;\r\n    border-right: 4px solid #ffc107;\r\n    border-top-left-radius: 10px;\r\n  }\r\n  .user-replay{\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 5px;\r\n  }\r\n  .user-replay img, .user-replay svg {\r\n    width: 35px;\r\n    height: 35px;\r\n    border-radius: 50px;\r\n  }\r\n  .reply-box p {\r\n    margin: 0;\r\n    padding: 5px;\r\n  }\r\n  .reply-box .close-btn {\r\n    position: absolute;\r\n    border-radius: 15px;\r\n    top: 5px;\r\n    left: 5px;\r\n    width: 30px;\r\n    background: #ff0000;\r\n    border: none;\r\n    cursor: pointer;\r\n    height: 30px;\r\n    padding: 5px;\r\n    color: white;\r\n    font-weight: bold;\r\n    font-size: larger;\r\n  }\r\n  .selectInner{\r\n    margin-top: 30px;\r\n    margin-bottom: 15px;\r\n  }\r\n  form {\r\n    direction: rtl;\r\n  }\r\n  textarea {\r\n    /* border-radius: 5px; */\r\n    width: calc(100% - 90px);\r\n    outline: none;\r\n    border: unset;\r\n    padding: .5rem;\r\n    box-sizing: border-box;\r\n    height: 45px;\r\n    position: fixed;\r\n    bottom: 0;\r\n    z-index: 9999;\r\n    left: 45px;\r\n    right: 45px;\r\n  }\r\n  label{\r\n    margin-bottom: 0.5rem;\r\n    display: block;\r\n  }\r\n  button {\r\n    padding: .5rem;\r\n    background-color: #10b981;\r\n    color: white;\r\n    border: none;\r\n\r\n    /* border-radius: 0.375rem; */\r\n    cursor: pointer;\r\n    position: fixed;\r\n    transition: background-color .2s ease, opacity .2s ease;\r\n    bottom: 0;\r\n    right: 0;\r\n    width: 45px;\r\n    height: 45px;\r\n    transition: background-color 0.2s ease, opacity 0.2s ease;\r\n  }\r\n  button:disabled {\r\n    background-color: #9ca3af;\r\n    cursor: not-allowed;\r\n    opacity: 0.6;\r\n  }\r\n  form button{\r\n    width: 100%;\r\n    position: unset;\r\n    height: unset;\r\n    padding: 10px;\r\n    margin-top: 10px;\r\n  }\r\n</style>\r\n<style>\r\n  .multiselect__option {\r\n    text-align: start;\r\n  }\r\n  .multiselect__placeholder {\r\n    float: right;\r\n  }\r\n  .multiselect__option:after {\r\n    left: 0;\r\n    right: unset !important;\r\n  }\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}