{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref } from 'vue';\nexport function useInfiniteScroll(fetchFn, {\n  limit = 10,\n  total = null,\n  immediate = true\n} = {}) {\n  const items = ref([]);\n  const loading = ref(false);\n  const offset = ref(0);\n  const canLoadMore = ref(true);\n  const loadMoreTrigger = ref(null);\n  const loadMore = async () => {\n    if (loading.value || !canLoadMore.value) return;\n    loading.value = true;\n    const result = await fetchFn({\n      limit,\n      offset: offset.value\n    });\n    const newItems = Array.isArray(result) ? result : [];\n    if (newItems.length < limit || total && items.value.length + newItems.length >= total) {\n      canLoadMore.value = false;\n    }\n    items.value.push(...newItems);\n    offset.value += newItems.length;\n    loading.value = false;\n  };\n  const setupObserver = () => {\n    const observer = new IntersectionObserver(async ([entry]) => {\n      if (entry.isIntersecting && canLoadMore.value && !loading.value) {\n        await loadMore();\n      }\n    }, {\n      root: null,\n      rootMargin: '0px',\n      threshold: 1.0\n    });\n    if (loadMoreTrigger.value) {\n      observer.observe(loadMoreTrigger.value);\n    }\n  };\n  if (immediate) loadMore();\n  return {\n    items,\n    loading,\n    canLoadMore,\n    loadMore,\n    loadMoreTrigger,\n    setupObserver\n  };\n}","map":{"version":3,"names":["ref","useInfiniteScroll","fetchFn","limit","total","immediate","items","loading","offset","canLoadMore","loadMoreTrigger","loadMore","value","result","newItems","Array","isArray","length","push","setupObserver","observer","IntersectionObserver","entry","isIntersecting","root","rootMargin","threshold","observe"],"sources":["D:/GitHub/ci3-vue3/vue3/src/composables/useInfiniteScroll.js"],"sourcesContent":["import { ref } from 'vue'\r\n\r\nexport function useInfiniteScroll(fetchFn, {\r\n    limit = 10,\r\n    total = null,\r\n    immediate = true,\r\n} = {}) {\r\n    const items = ref([])\r\n    const loading = ref(false)\r\n    const offset = ref(0)\r\n    const canLoadMore = ref(true)\r\n    const loadMoreTrigger = ref(null)\r\n\r\n    const loadMore = async () => {\r\n        if (loading.value || !canLoadMore.value) return\r\n\r\n        loading.value = true\r\n        const result = await fetchFn({ limit, offset: offset.value })\r\n        const newItems = Array.isArray(result) ? result : []\r\n\r\n        if (newItems.length < limit || (total && items.value.length + newItems.length >= total)) {\r\n            canLoadMore.value = false\r\n        }\r\n\r\n        items.value.push(...newItems)\r\n        offset.value += newItems.length\r\n        loading.value = false\r\n    }\r\n\r\n    const setupObserver = () => {\r\n        const observer = new IntersectionObserver(async ([entry]) => {\r\n            if (entry.isIntersecting && canLoadMore.value && !loading.value) {\r\n                await loadMore()\r\n            }\r\n        }, {\r\n            root: null,\r\n            rootMargin: '0px',\r\n            threshold: 1.0,\r\n        })\r\n        if (loadMoreTrigger.value) {\r\n            observer.observe(loadMoreTrigger.value)\r\n        }\r\n    }\r\n\r\n    if (immediate) loadMore()\r\n\r\n    return {\r\n        items,\r\n        loading,\r\n        canLoadMore,\r\n        loadMore,\r\n        loadMoreTrigger,\r\n        setupObserver,\r\n    }\r\n}\r\n"],"mappings":";AAAA,SAASA,GAAG,QAAQ,KAAK;AAEzB,OAAO,SAASC,iBAAiBA,CAACC,OAAO,EAAE;EACvCC,KAAK,GAAG,EAAE;EACVC,KAAK,GAAG,IAAI;EACZC,SAAS,GAAG;AAChB,CAAC,GAAG,CAAC,CAAC,EAAE;EACJ,MAAMC,KAAK,GAAGN,GAAG,CAAC,EAAE,CAAC;EACrB,MAAMO,OAAO,GAAGP,GAAG,CAAC,KAAK,CAAC;EAC1B,MAAMQ,MAAM,GAAGR,GAAG,CAAC,CAAC,CAAC;EACrB,MAAMS,WAAW,GAAGT,GAAG,CAAC,IAAI,CAAC;EAC7B,MAAMU,eAAe,GAAGV,GAAG,CAAC,IAAI,CAAC;EAEjC,MAAMW,QAAQ,GAAG,MAAAA,CAAA,KAAY;IACzB,IAAIJ,OAAO,CAACK,KAAK,IAAI,CAACH,WAAW,CAACG,KAAK,EAAE;IAEzCL,OAAO,CAACK,KAAK,GAAG,IAAI;IACpB,MAAMC,MAAM,GAAG,MAAMX,OAAO,CAAC;MAAEC,KAAK;MAAEK,MAAM,EAAEA,MAAM,CAACI;IAAM,CAAC,CAAC;IAC7D,MAAME,QAAQ,GAAGC,KAAK,CAACC,OAAO,CAACH,MAAM,CAAC,GAAGA,MAAM,GAAG,EAAE;IAEpD,IAAIC,QAAQ,CAACG,MAAM,GAAGd,KAAK,IAAKC,KAAK,IAAIE,KAAK,CAACM,KAAK,CAACK,MAAM,GAAGH,QAAQ,CAACG,MAAM,IAAIb,KAAM,EAAE;MACrFK,WAAW,CAACG,KAAK,GAAG,KAAK;IAC7B;IAEAN,KAAK,CAACM,KAAK,CAACM,IAAI,CAAC,GAAGJ,QAAQ,CAAC;IAC7BN,MAAM,CAACI,KAAK,IAAIE,QAAQ,CAACG,MAAM;IAC/BV,OAAO,CAACK,KAAK,GAAG,KAAK;EACzB,CAAC;EAED,MAAMO,aAAa,GAAGA,CAAA,KAAM;IACxB,MAAMC,QAAQ,GAAG,IAAIC,oBAAoB,CAAC,OAAO,CAACC,KAAK,CAAC,KAAK;MACzD,IAAIA,KAAK,CAACC,cAAc,IAAId,WAAW,CAACG,KAAK,IAAI,CAACL,OAAO,CAACK,KAAK,EAAE;QAC7D,MAAMD,QAAQ,CAAC,CAAC;MACpB;IACJ,CAAC,EAAE;MACCa,IAAI,EAAE,IAAI;MACVC,UAAU,EAAE,KAAK;MACjBC,SAAS,EAAE;IACf,CAAC,CAAC;IACF,IAAIhB,eAAe,CAACE,KAAK,EAAE;MACvBQ,QAAQ,CAACO,OAAO,CAACjB,eAAe,CAACE,KAAK,CAAC;IAC3C;EACJ,CAAC;EAED,IAAIP,SAAS,EAAEM,QAAQ,CAAC,CAAC;EAEzB,OAAO;IACHL,KAAK;IACLC,OAAO;IACPE,WAAW;IACXE,QAAQ;IACRD,eAAe;IACfS;EACJ,CAAC;AACL","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}