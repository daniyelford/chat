{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport { unref as _unref, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, createBlock as _createBlock, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = {\n  class: \"inner-posts\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"loading\"\n};\nconst _hoisted_3 = {\n  key: 1,\n  class: \"card-inner\"\n};\nconst _hoisted_4 = {\n  class: \"user-info\"\n};\nconst _hoisted_5 = [\"src\"];\nconst _hoisted_6 = {\n  key: 1,\n  xmlns: \"http://www.w3.org/2000/svg\",\n  fill: \"#000000\",\n  \"enable-background\": \"new 0 0 24 24\",\n  viewBox: \"0 0 24 24\"\n};\nconst _hoisted_7 = {\n  key: 2\n};\nconst _hoisted_8 = {\n  class: \"media-inner\"\n};\nconst _hoisted_9 = {\n  key: 0,\n  class: \"card-category\"\n};\nconst _hoisted_10 = {\n  key: 1,\n  class: \"description\"\n};\nconst _hoisted_11 = [\"onClick\"];\nconst _hoisted_12 = {\n  key: 3,\n  class: \"location\"\n};\nconst _hoisted_13 = {\n  class: \"time\"\n};\nconst _hoisted_14 = [\"onClick\"];\nconst _hoisted_15 = [\"onClick\"];\nconst _hoisted_16 = [\"onClick\"];\nconst _hoisted_17 = [\"onClick\"];\nconst _hoisted_18 = {\n  key: 8,\n  class: \"report-block\"\n};\nconst _hoisted_19 = {\n  class: \"reporter-user\"\n};\nconst _hoisted_20 = [\"src\"];\nconst _hoisted_21 = {\n  key: 1,\n  xmlns: \"http://www.w3.org/2000/svg\",\n  fill: \"#000000\",\n  \"enable-background\": \"new 0 0 24 24\",\n  viewBox: \"0 0 24 24\"\n};\nconst _hoisted_22 = {\n  key: 0,\n  class: \"media-inner\"\n};\nconst _hoisted_23 = {\n  key: 1\n};\nconst _hoisted_24 = [\"onClick\"];\nconst _hoisted_25 = {\n  key: 3,\n  class: \"location\"\n};\nconst _hoisted_26 = {\n  key: 4\n};\nconst _hoisted_27 = {\n  class: \"time\"\n};\nconst _hoisted_28 = [\"onClick\"];\nconst _hoisted_29 = [\"onClick\"];\nconst _hoisted_30 = [\"onClick\"];\nconst _hoisted_31 = {\n  key: 2,\n  class: \"none-cart-error\"\n};\nconst _hoisted_32 = {\n  key: 3,\n  class: \"toast\"\n};\nimport { ref, onMounted } from 'vue';\nimport moment from 'moment-jalaali';\nimport BaseModal from '@/components/tooles/modal/BaseModal.vue';\nimport SinglePlaceMap from '@/components/tooles/places/SinglePlaceMap.vue';\nimport MediaSlider from '@/components/tooles/media/MediaSlider.vue';\nimport CalendarModal from '@/components/tooles/news/CalendarModal.vue';\nimport { usePollingWithCompare } from '@/composables/usePollingWithCompare';\nimport { useInfiniteScroll } from '@/composables/useInfiniteScroll';\nimport AddNewsForm from '@/components/dashboard/pagesContent/AddNewsForm.vue';\nimport { useNewsStore } from '@/stores/news';\nexport default {\n  __name: 'NewsCards',\n  setup(__props) {\n    const toastMsg = ref('');\n    const selectedNewsId = ref(null);\n    const selectedReportId = ref(null);\n    const showModal = ref(false);\n    const modalRunTime = ref(null);\n    const showReports = ref({});\n    const replyToId = ref(0);\n    const editCard = ref(null);\n    const editReport = ref(null);\n    const userCoordinate = ref(null);\n    const showMapModal = ref(false);\n    const selectedPlace = ref(null);\n    const newsStore = useNewsStore();\n    const truncateText = (text, max = 50) => {\n      if (!text) return '';\n      return text.length > max ? text.slice(0, max) + '...' : text;\n    };\n    function showToast(msg) {\n      toastMsg.value = msg;\n      setTimeout(() => toastMsg.value = '', 3000);\n    }\n    function toggleReports(id) {\n      showReports.value[id] = !showReports.value[id];\n    }\n    function handleEdit(newsId, reportId) {\n      const card = newsStore.cards.find(c => c.id === newsId);\n      editCard.value = card;\n      replyToId.value = 0;\n      if (reportId) {\n        editReport.value = card.reports.find(r => r.id === reportId) || null;\n      } else {\n        editReport.value = null;\n      }\n    }\n    function handleReply(newsId) {\n      replyToId.value = newsId;\n    }\n    const fetchNews = async () => {\n      const ok = await newsStore.fetchNews({\n        limit: 10,\n        offset: newsStore.cards.length,\n        append: true\n      });\n      if (ok) {\n        return {\n          items: newsStore.cards,\n          has_more: newsStore.more\n        };\n      }\n      return {\n        items: newsStore.cards,\n        has_more: false\n      };\n    };\n    const {\n      loadMoreTrigger,\n      setupObserver\n    } = useInfiniteScroll(fetchNews, {\n      limit: 10,\n      immediate: true\n    });\n    usePollingWithCompare(() => newsStore.fetchLatestNewsRaw(10, 0), {\n      intervalMs: 6000,\n      isDifferent: (oldData, newData) => {\n        if (!Array.isArray(oldData) || !Array.isArray(newData)) return true;\n        if (oldData.length !== newData.length) return true;\n        for (let i = 0; i < newData.length; i++) {\n          const oldItem = oldData[i];\n          const newItem = newData[i];\n          if (oldItem.id !== newItem.id) return true;\n          const oldReports = oldItem.reports || [];\n          const newReports = newItem.reports || [];\n          if (oldReports.length !== newReports.length) return true;\n          for (let j = 0; j < newReports.length; j++) {\n            const oldReport = oldReports[j];\n            const newReport = newReports[j];\n            if (oldReport.id !== newReport.id || oldReport.updated_at !== newReport.updated_at || oldReport.status !== newReport.status || oldReport.run_time !== newReport.run_time) {\n              return true;\n            }\n          }\n        }\n        return false;\n      },\n      onChange: async newCards => {\n        for (const newItem of newCards) {\n          const index = newsStore.cards.findIndex(c => c.id === newItem.id);\n          if (index !== -1) {\n            const card = newsStore.cards[index];\n            const updatedCard = {\n              ...card,\n              reports: newItem.reports\n            };\n            newsStore.cards.splice(index, 1, updatedCard);\n          } else {\n            newsStore.cards.push(newItem);\n          }\n        }\n        if (newCards.length > 0) {\n          showToast('ŸÖŸÜÿ™ÿ∏ÿ± ÿ®ŸÖÿßŸÜ€åÿØ');\n        }\n      }\n    });\n    function openCalendarModal(id, reportId) {\n      selectedNewsId.value = id;\n      selectedReportId.value = reportId;\n      if (reportId) {\n        const card = newsStore.cards.find(c => c.id === id);\n        if (card) {\n          const report = card.reports.find(r => r.id === reportId);\n          modalRunTime.value = report?.run_time ? new Date(report.run_time) : null;\n        } else {\n          modalRunTime.value = null;\n        }\n      } else {\n        modalRunTime.value = null;\n      }\n      showModal.value = true;\n    }\n    async function onCalendarSubmit({\n      date\n    }) {\n      const jsDate = date ? moment(date, 'jYYYY/jMM/jDD').hour(12).minute(0).second(0).toDate() : null;\n      const success = await newsStore.scheduleNewsRunTime(selectedNewsId.value, selectedReportId.value, jsDate);\n      if (success) {\n        showModal.value = false;\n        const updated = await newsStore.fetchNewsById(selectedNewsId.value);\n        if (updated) {\n          const index = newsStore.cards.findIndex(c => c.id === selectedNewsId.value);\n          if (index !== -1) {\n            newsStore.cards[index] = updated;\n          }\n        }\n      } else {\n        alert('ÿÆÿ∑ÿß ÿØÿ± ÿ´ÿ®ÿ™ ÿ™ÿßÿ±€åÿÆ ÿßÿ¨ÿ±ÿß');\n      }\n    }\n    function openMapModal(item, parentCard = null) {\n      const lat = item?.location?.lat;\n      const lon = item?.location?.lon;\n      if (!lat || !lon) return;\n      if (parentCard) {\n        selectedPlace.value = {\n          ...item.location,\n          title: 'ŸÖŸàŸÇÿπ€åÿ™',\n          description: (item.description ? item.description : 'ÿ®ÿØŸàŸÜ ÿπŸÜŸàÿßŸÜ') + (item.run_time ? 'üìÖ ÿ™ÿßÿ±€åÿÆ ŸÖŸÑÿßŸÇÿßÿ™ ' + moment(item.run_time).format('jYYYY/jMM/jDD') : ''),\n          categories: parentCard?.category || [],\n          medias: item.media || [],\n          address: item.location.address\n        };\n      } else {\n        selectedPlace.value = {\n          ...item.location,\n          title: 'ŸÖŸàŸÇÿπ€åÿ™',\n          description: item.description || 'ÿ®ÿØŸàŸÜ ÿπŸÜŸàÿßŸÜ',\n          categories: item?.category || [],\n          medias: item.medias || [],\n          address: item.location.address\n        };\n      }\n      showMapModal.value = true;\n    }\n    onMounted(async () => {\n      setTimeout(() => {\n        setupObserver();\n      }, 100);\n      const res = await newsStore.fetchAddNewsData();\n      if (res?.coordinate?.lat && res?.coordinate?.lon) {\n        userCoordinate.value = res.coordinate;\n      }\n    });\n    return (_ctx, _cache) => {\n      const _component_RouterLink = _resolveComponent(\"RouterLink\");\n      return _openBlock(), _createElementBlock(_Fragment, null, [_createElementVNode(\"div\", _hoisted_1, [!_unref(newsStore).isLoaded ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, _cache[3] || (_cache[3] = [_createElementVNode(\"div\", {\n        class: \"tiny-loader\"\n      }, null, -1)]))) : _unref(newsStore).cards.length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(newsStore).cards, card => {\n        return _openBlock(), _createElementBlock(\"div\", {\n          key: card.id,\n          class: _normalizeClass([\"card\", {\n            'my-news': card.self\n          }])\n        }, [_createElementVNode(\"div\", _hoisted_4, [card.user?.image ? (_openBlock(), _createElementBlock(\"img\", {\n          key: 0,\n          src: card.user.image,\n          alt: \"user\"\n        }, null, 8, _hoisted_5)) : (_openBlock(), _createElementBlock(\"svg\", _hoisted_6, _cache[4] || (_cache[4] = [_createElementVNode(\"g\", null, [_createElementVNode(\"rect\", {\n          fill: \"none\",\n          height: \"24\",\n          width: \"24\"\n        })], -1), _createElementVNode(\"g\", null, [_createElementVNode(\"path\", {\n          d: \"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm0 14c-2.03 0-4.43-.82-6.14-2.88C7.55 15.8 9.68 15 12 15s4.45.8 6.14 2.12C16.43 19.18 14.03 20 12 20z\"\n        })], -1)]))), card.user?.name || card.user?.family ? (_openBlock(), _createElementBlock(\"p\", _hoisted_7, _toDisplayString(card.user.name) + \" \" + _toDisplayString(card.user.family), 1)) : _createCommentVNode(\"\", true)]), _createElementVNode(\"div\", _hoisted_8, [Array.isArray(card.medias) && card.medias.length > 0 ? (_openBlock(), _createBlock(MediaSlider, {\n          key: 0,\n          medias: card.medias\n        }, null, 8, [\"medias\"])) : _createCommentVNode(\"\", true)]), !_unref(newsStore).hasRule && Array.isArray(card.category) && card.category.length ? (_openBlock(), _createElementBlock(\"div\", _hoisted_9, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(card.category, category => {\n          return _openBlock(), _createElementBlock(\"span\", {\n            class: \"category\",\n            key: category.id\n          }, _toDisplayString(category.title), 1);\n        }), 128))])) : _createCommentVNode(\"\", true), card.description ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, _toDisplayString(truncateText(card.description)), 1)) : _createCommentVNode(\"\", true), card.location?.lat && card.location?.lon ? (_openBlock(), _createElementBlock(\"a\", {\n          key: 2,\n          class: \"choose\",\n          style: {\n            \"margin-top\": \"0\",\n            \"float\": \"left\"\n          },\n          onClick: $event => openMapModal(card)\n        }, \"ŸÜŸÖÿß€åÿ¥ ÿ±Ÿà€å ŸÜŸÇÿ¥Ÿá\", 8, _hoisted_11)) : _createCommentVNode(\"\", true), card.location?.city ? (_openBlock(), _createElementBlock(\"div\", _hoisted_12, \"üìç \" + _toDisplayString(card.location.city), 1)) : _createCommentVNode(\"\", true), _cache[9] || (_cache[9] = _createElementVNode(\"div\", {\n          style: {\n            \"clear\": \"both\"\n          }\n        }, null, -1)), _createElementVNode(\"div\", _hoisted_13, \"üìÖ \" + _toDisplayString(_unref(moment)(card.created_at).format('jYYYY/jMM/jDD')), 1), _createVNode(_component_RouterLink, {\n          class: \"choose\",\n          to: {\n            path: `/show-news/${card.id}`\n          }\n        }, {\n          default: _withCtx(() => _cache[5] || (_cache[5] = [_createTextVNode(\" ŸÖÿ¥ÿßŸáÿØŸá \")])),\n          _: 2,\n          __: [5]\n        }, 1032, [\"to\"]), card.self ? (_openBlock(), _createElementBlock(\"a\", {\n          key: 4,\n          class: \"choose\",\n          onClick: $event => handleEdit(card.id, null)\n        }, \" Ÿà€åÿ±ÿß€åÿ¥ \", 8, _hoisted_14)) : _createCommentVNode(\"\", true), _unref(newsStore).hasRule && !card.self ? (_openBlock(), _createElementBlock(\"a\", {\n          key: 5,\n          class: \"choose\",\n          onClick: $event => handleReply(card.id)\n        }, \" Ÿæÿßÿ≥ÿÆ \", 8, _hoisted_15)) : _createCommentVNode(\"\", true), _unref(newsStore).hasRule && !card.self ? (_openBlock(), _createElementBlock(\"a\", {\n          key: 6,\n          class: \"choose\",\n          onClick: $event => openCalendarModal(card.id, 0)\n        }, \" ŸÇÿ±ÿßÿ± ŸÖŸÑÿßŸÇÿßÿ™ \", 8, _hoisted_16)) : _createCommentVNode(\"\", true), card.reports && card.reports.length ? (_openBlock(), _createElementBlock(\"a\", {\n          key: 7,\n          class: \"choose\",\n          onClick: $event => toggleReports(card.id)\n        }, _toDisplayString(showReports.value[card.id] ? 'ÿ®ÿ≥ÿ™ŸÜ ⁄Øÿ≤ÿßÿ±ÿ¥‚ÄåŸáÿß' : 'ŸÜŸÖÿß€åÿ¥ ⁄Øÿ≤ÿßÿ±ÿ¥‚ÄåŸáÿß'), 9, _hoisted_17)) : _createCommentVNode(\"\", true), card.reports && card.reports.length && showReports.value[card.id] ? (_openBlock(), _createElementBlock(\"div\", _hoisted_18, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(card.reports, report => {\n          return _openBlock(), _createElementBlock(\"div\", {\n            class: \"single-report\",\n            key: report.id\n          }, [_createElementVNode(\"div\", _hoisted_19, [report.reporter.image ? (_openBlock(), _createElementBlock(\"img\", {\n            key: 0,\n            src: report.reporter.image,\n            alt: \"reporter image\"\n          }, null, 8, _hoisted_20)) : (_openBlock(), _createElementBlock(\"svg\", _hoisted_21, _cache[6] || (_cache[6] = [_createElementVNode(\"g\", null, [_createElementVNode(\"rect\", {\n            fill: \"none\",\n            height: \"24\",\n            width: \"24\"\n          })], -1), _createElementVNode(\"g\", null, [_createElementVNode(\"path\", {\n            d: \"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm0 14c-2.03 0-4.43-.82-6.14-2.88C7.55 15.8 9.68 15 12 15s4.45.8 6.14 2.12C16.43 19.18 14.03 20 12 20z\"\n          })], -1)]))), _createElementVNode(\"p\", null, _toDisplayString(report.reporter.name) + \" \" + _toDisplayString(report.reporter.family), 1)]), Array.isArray(report.media) && report.media.length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_22, [_createVNode(MediaSlider, {\n            medias: report.media\n          }, null, 8, [\"medias\"])])) : _createCommentVNode(\"\", true), report.description ? (_openBlock(), _createElementBlock(\"p\", _hoisted_23, \"üìÑ \" + _toDisplayString(truncateText(report.description)), 1)) : _createCommentVNode(\"\", true), report.location?.lat && report.location?.lon ? (_openBlock(), _createElementBlock(\"a\", {\n            key: 2,\n            class: \"choose\",\n            onClick: $event => openMapModal(report, card),\n            style: {\n              \"margin-top\": \"0\",\n              \"float\": \"left\"\n            }\n          }, \" ŸÜŸÖÿß€åÿ¥ ÿ±Ÿà€å ŸÜŸÇÿ¥Ÿá \", 8, _hoisted_24)) : _createCommentVNode(\"\", true), report.location?.city ? (_openBlock(), _createElementBlock(\"div\", _hoisted_25, \"üìç \" + _toDisplayString(report.location.city), 1)) : _createCommentVNode(\"\", true), _cache[8] || (_cache[8] = _createElementVNode(\"div\", {\n            style: {\n              \"clear\": \"both\"\n            }\n          }, null, -1)), report.run_time ? (_openBlock(), _createElementBlock(\"p\", _hoisted_26, \" üìÖ ÿ™ÿßÿ±€åÿÆ ŸÖŸÑÿßŸÇÿßÿ™ \" + _toDisplayString(_unref(moment)(report.run_time).format('jYYYY/jMM/jDD')), 1)) : _createCommentVNode(\"\", true), _createElementVNode(\"div\", _hoisted_27, \"üìÖ \" + _toDisplayString(_unref(moment)(report.created_at).format('jYYYY/jMM/jDD')), 1), report.reporter.self && report.description ? (_openBlock(), _createElementBlock(\"a\", {\n            key: 5,\n            class: \"choose\",\n            onClick: $event => handleEdit(card.id, report.id)\n          }, \" Ÿà€åÿ±ÿß€åÿ¥ \", 8, _hoisted_28)) : _createCommentVNode(\"\", true), report.reporter.self && report.run_time ? (_openBlock(), _createElementBlock(\"a\", {\n            key: 6,\n            class: \"choose\",\n            onClick: $event => openCalendarModal(card.id, report.id)\n          }, \" Ÿà€åÿ±ÿß€åÿ¥ ÿ≤ŸÖÿßŸÜ ŸÖŸÑÿßŸÇÿßÿ™ \", 8, _hoisted_29)) : _createCommentVNode(\"\", true), _createVNode(_component_RouterLink, {\n            class: \"choose\",\n            to: {\n              path: `/show-cartable/${report.id}`\n            }\n          }, {\n            default: _withCtx(() => _cache[7] || (_cache[7] = [_createTextVNode(\" ŸÖÿ¥ÿßŸáÿØŸá \")])),\n            _: 2,\n            __: [7]\n          }, 1032, [\"to\"]), report.reporter.self && !report.run_time ? (_openBlock(), _createElementBlock(\"a\", {\n            key: 7,\n            class: \"choose\",\n            onClick: $event => openCalendarModal(card.id, report.id)\n          }, \" ŸÇÿ±ÿßÿ± ŸÖŸÑÿßŸÇÿßÿ™ \", 8, _hoisted_30)) : _createCommentVNode(\"\", true)]);\n        }), 128))])) : _createCommentVNode(\"\", true)], 2);\n      }), 128)), _createElementVNode(\"div\", {\n        ref_key: \"loadMoreTrigger\",\n        ref: loadMoreTrigger,\n        class: \"scroll-trigger\"\n      }, null, 512)])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_31, \" ÿÆÿ®ÿ±€å ÿØÿ± ŸÖÿ≠ÿØŸàÿØŸá ÿ¥ŸÖÿß Ÿàÿ¨ŸàÿØ ŸÜÿØÿßÿ±ÿØ \")), toastMsg.value ? (_openBlock(), _createElementBlock(\"span\", _hoisted_32, _toDisplayString(toastMsg.value), 1)) : _createCommentVNode(\"\", true), showModal.value ? (_openBlock(), _createBlock(CalendarModal, {\n        key: 4,\n        initialDate: modalRunTime.value,\n        onClose: _cache[0] || (_cache[0] = $event => showModal.value = false),\n        onSubmit: onCalendarSubmit\n      }, null, 8, [\"initialDate\"])) : _createCommentVNode(\"\", true)]), _createVNode(AddNewsForm, {\n        \"reply-to-id\": replyToId.value,\n        \"edit-data\": editCard.value,\n        \"edit-report\": editReport.value,\n        onClearReplyId: _cache[1] || (_cache[1] = $event => {\n          replyToId.value = 0;\n          editCard.value = null;\n          editReport.value = null;\n        })\n      }, null, 8, [\"reply-to-id\", \"edit-data\", \"edit-report\"]), _createVNode(BaseModal, {\n        show: showMapModal.value,\n        onClose: _cache[2] || (_cache[2] = $event => showMapModal.value = false)\n      }, {\n        default: _withCtx(() => [selectedPlace.value && selectedPlace.value.lat && selectedPlace.value.lon && userCoordinate.value && userCoordinate.value.lat && userCoordinate.value.lon ? (_openBlock(), _createBlock(SinglePlaceMap, {\n          key: 0,\n          \"user-center\": userCoordinate.value,\n          place: selectedPlace.value\n        }, null, 8, [\"user-center\", \"place\"])) : _createCommentVNode(\"\", true)]),\n        _: 1\n      }, 8, [\"show\"])], 64);\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","moment","BaseModal","SinglePlaceMap","MediaSlider","CalendarModal","usePollingWithCompare","useInfiniteScroll","AddNewsForm","useNewsStore","toastMsg","selectedNewsId","selectedReportId","showModal","modalRunTime","showReports","replyToId","editCard","editReport","userCoordinate","showMapModal","selectedPlace","newsStore","truncateText","text","max","length","slice","showToast","msg","value","setTimeout","toggleReports","id","handleEdit","newsId","reportId","card","cards","find","c","reports","r","handleReply","fetchNews","ok","limit","offset","append","items","has_more","more","loadMoreTrigger","setupObserver","immediate","fetchLatestNewsRaw","intervalMs","isDifferent","oldData","newData","Array","isArray","i","oldItem","newItem","oldReports","newReports","j","oldReport","newReport","updated_at","status","run_time","onChange","newCards","index","findIndex","updatedCard","splice","push","openCalendarModal","report","Date","onCalendarSubmit","date","jsDate","hour","minute","second","toDate","success","scheduleNewsRunTime","updated","fetchNewsById","alert","openMapModal","item","parentCard","lat","location","lon","title","description","format","categories","category","medias","media","address","res","fetchAddNewsData","coordinate"],"sources":["D:/GitHub/chat/vue3/src/components/dashboard/pagesContent/NewsCards.vue"],"sourcesContent":["<template>\r\n  <div class=\"inner-posts\">\r\n    <div class=\"loading\" v-if=\"!newsStore.isLoaded\">\r\n      <div class=\"tiny-loader\"></div>\r\n    </div>\r\n    <div class=\"card-inner\" v-else-if=\"newsStore.cards.length > 0\">\r\n      <div v-for=\"card in newsStore.cards\" :key=\"card.id\" class=\"card\" :class=\"{ 'my-news': card.self }\">\r\n        <div class=\"user-info\">\r\n          <img v-if=\"card.user?.image\" :src=\"card.user.image\" alt=\"user\" />\r\n          <svg v-else xmlns=\"http://www.w3.org/2000/svg\" fill=\"#000000\" enable-background=\"new 0 0 24 24\" viewBox=\"0 0 24 24\"><g><rect fill=\"none\" height=\"24\" width=\"24\"/></g><g><path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm0 14c-2.03 0-4.43-.82-6.14-2.88C7.55 15.8 9.68 15 12 15s4.45.8 6.14 2.12C16.43 19.18 14.03 20 12 20z\"/></g></svg>\r\n          <p v-if=\"card.user?.name || card.user?.family\">\r\n            {{ card.user.name }} {{ card.user.family }}\r\n          </p>\r\n        </div>\r\n        <div class=\"media-inner\">\r\n          <MediaSlider v-if=\"Array.isArray(card.medias) && card.medias.length > 0\" :medias=\"card.medias\" />\r\n        </div>\r\n        <div class=\"card-category\" v-if=\"!newsStore.hasRule && Array.isArray(card.category) && card.category.length\">\r\n          <span class=\"category\" v-for=\"category in card.category\" :key=\"category.id\">\r\n            {{ category.title }}\r\n          </span>\r\n        </div>\r\n        <div class=\"description\" v-if=\"card.description\">\r\n          {{ truncateText(card.description) }}\r\n        </div>\r\n        <a class=\"choose\" v-if=\"card.location?.lat && card.location?.lon\" style=\"margin-top: 0; float: left;\" @click=\"openMapModal(card)\">ŸÜŸÖÿß€åÿ¥ ÿ±Ÿà€å ŸÜŸÇÿ¥Ÿá</a>\r\n        <div class=\"location\" v-if=\"card.location?.city\">üìç {{ card.location.city }}</div>\r\n        <div style=\"clear: both;\"></div>\r\n        <div class=\"time\">üìÖ {{ moment(card.created_at).format('jYYYY/jMM/jDD') }}</div>\r\n        <RouterLink class=\"choose\" :to=\"{ path: `/show-news/${card.id}` }\">\r\n          ŸÖÿ¥ÿßŸáÿØŸá\r\n        </RouterLink>\r\n        <a v-if=\"card.self\" class=\"choose\" @click=\"handleEdit(card.id,null)\">\r\n          Ÿà€åÿ±ÿß€åÿ¥\r\n        </a>\r\n        <a\r\n          class=\"choose\"\r\n          v-if=\"newsStore.hasRule && !card.self\"\r\n          @click=\"handleReply(card.id)\"\r\n        >\r\n          Ÿæÿßÿ≥ÿÆ\r\n        </a>\r\n        <a\r\n          class=\"choose\"\r\n          v-if=\"newsStore.hasRule && !card.self\"\r\n          @click=\"openCalendarModal(card.id,0)\"\r\n        >\r\n          ŸÇÿ±ÿßÿ± ŸÖŸÑÿßŸÇÿßÿ™\r\n        </a>\r\n        <a class=\"choose\" v-if=\"card.reports && card.reports.length\" @click=\"toggleReports(card.id)\">\r\n          {{ showReports[card.id] ? 'ÿ®ÿ≥ÿ™ŸÜ ⁄Øÿ≤ÿßÿ±ÿ¥‚ÄåŸáÿß' : 'ŸÜŸÖÿß€åÿ¥ ⁄Øÿ≤ÿßÿ±ÿ¥‚ÄåŸáÿß' }}\r\n        </a>\r\n        <div class=\"report-block\" v-if=\"card.reports && card.reports.length && showReports[card.id]\">\r\n          <div class=\"single-report\" v-for=\"report in card.reports\" :key=\"report.id\">\r\n            <div class=\"reporter-user\">\r\n              <img v-if=\"report.reporter.image\" :src=\"report.reporter.image\" alt=\"reporter image\">\r\n              <svg v-else xmlns=\"http://www.w3.org/2000/svg\" fill=\"#000000\" enable-background=\"new 0 0 24 24\" viewBox=\"0 0 24 24\"><g><rect fill=\"none\" height=\"24\" width=\"24\"/></g><g><path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 4c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm0 14c-2.03 0-4.43-.82-6.14-2.88C7.55 15.8 9.68 15 12 15s4.45.8 6.14 2.12C16.43 19.18 14.03 20 12 20z\"/></g></svg>\r\n              <p>{{ report.reporter.name }} {{ report.reporter.family }}</p>\r\n            </div>\r\n            <div class=\"media-inner\" v-if=\"Array.isArray(report.media) && report.media.length > 0\">\r\n              <MediaSlider :medias=\"report.media\" />\r\n            </div>\r\n            <p v-if=\"report.description\">üìÑ {{ truncateText(report.description) }}</p>\r\n            <a\r\n              class=\"choose\"\r\n              v-if=\"report.location?.lat && report.location?.lon\"\r\n              @click=\"openMapModal(report, card)\"\r\n              style=\"margin-top: 0; float: left;\"\r\n              >\r\n              ŸÜŸÖÿß€åÿ¥ ÿ±Ÿà€å ŸÜŸÇÿ¥Ÿá\r\n            </a>\r\n            <div class=\"location\" v-if=\"report.location?.city\">üìç {{ report.location.city }}</div>\r\n            <div style=\"clear: both;\"></div>\r\n            <p v-if=\"report.run_time\">\r\n              üìÖ ÿ™ÿßÿ±€åÿÆ ŸÖŸÑÿßŸÇÿßÿ™ {{ moment(report.run_time).format('jYYYY/jMM/jDD') }}\r\n            </p>\r\n            <div class=\"time\">üìÖ {{ moment(report.created_at).format('jYYYY/jMM/jDD') }}</div>\r\n            <a v-if=\"report.reporter.self && report.description\" class=\"choose\" @click=\"handleEdit(card.id,report.id)\">\r\n              Ÿà€åÿ±ÿß€åÿ¥\r\n            </a>\r\n            <a\r\n            class=\"choose\"\r\n            v-if=\"report.reporter.self && report.run_time\"\r\n            @click=\"openCalendarModal(card.id,report.id)\">\r\n              Ÿà€åÿ±ÿß€åÿ¥ ÿ≤ŸÖÿßŸÜ ŸÖŸÑÿßŸÇÿßÿ™\r\n            </a>\r\n            <RouterLink class=\"choose\" :to=\"{ path: `/show-cartable/${report.id}` }\">\r\n              ŸÖÿ¥ÿßŸáÿØŸá\r\n            </RouterLink>\r\n            <a\r\n              class=\"choose\"\r\n              v-if=\"report.reporter.self && !report.run_time\"\r\n              @click=\"openCalendarModal(card.id,report.id)\"\r\n            >\r\n              ŸÇÿ±ÿßÿ± ŸÖŸÑÿßŸÇÿßÿ™\r\n            </a>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div ref=\"loadMoreTrigger\" class=\"scroll-trigger\"></div>\r\n    </div>\r\n    <div v-else class=\"none-cart-error\">\r\n      ÿÆÿ®ÿ±€å ÿØÿ± ŸÖÿ≠ÿØŸàÿØŸá ÿ¥ŸÖÿß Ÿàÿ¨ŸàÿØ ŸÜÿØÿßÿ±ÿØ\r\n    </div>\r\n    <span v-if=\"toastMsg\" class=\"toast\">\r\n      {{ toastMsg }}\r\n    </span>\r\n    <CalendarModal\r\n    v-if=\"showModal\"\r\n    :initialDate=\"modalRunTime\"\r\n    @close=\"showModal = false\"\r\n    @submit=\"onCalendarSubmit\"\r\n    />\r\n  </div>\r\n  <AddNewsForm\r\n  :reply-to-id=\"replyToId\"\r\n  :edit-data=\"editCard\"\r\n  :edit-report=\"editReport\"\r\n  @clearReplyId=\"replyToId = 0; editCard = null; editReport = null\"\r\n  />\r\n  <BaseModal :show=\"showMapModal\" @close=\"showMapModal = false\">\r\n    <SinglePlaceMap\r\n    v-if=\"selectedPlace && selectedPlace.lat && selectedPlace.lon && userCoordinate && userCoordinate.lat && userCoordinate.lon\"\r\n    :user-center=\"userCoordinate\"\r\n    :place=\"selectedPlace\"\r\n    />\r\n  </BaseModal>\r\n</template>\r\n<script setup>\r\n  import { ref, onMounted } from 'vue'\r\n  import moment from 'moment-jalaali'\r\n  import BaseModal from '@/components/tooles/modal/BaseModal.vue'\r\n  import SinglePlaceMap from '@/components/tooles/places/SinglePlaceMap.vue'\r\n  import MediaSlider from '@/components/tooles/media/MediaSlider.vue'\r\n  import CalendarModal from '@/components/tooles/news/CalendarModal.vue'\r\n  import { usePollingWithCompare } from '@/composables/usePollingWithCompare'\r\n  import { useInfiniteScroll } from '@/composables/useInfiniteScroll'\r\n  import AddNewsForm from '@/components/dashboard/pagesContent/AddNewsForm.vue'\r\n  import { useNewsStore } from '@/stores/news'\r\n  const toastMsg = ref('')\r\n  const selectedNewsId = ref(null)\r\n  const selectedReportId = ref(null)\r\n  const showModal = ref(false)\r\n  const modalRunTime = ref(null)\r\n  const showReports = ref({})\r\n  const replyToId = ref(0)\r\n  const editCard = ref(null)\r\n  const editReport = ref(null)\r\n  const userCoordinate = ref(null)\r\n  const showMapModal = ref(false)\r\n  const selectedPlace = ref(null)\r\n  const newsStore = useNewsStore()\r\n  const truncateText = (text, max = 50) => {\r\n    if (!text) return ''\r\n    return text.length > max ? text.slice(0, max) + '...' : text\r\n  }\r\n  function showToast(msg) {\r\n    toastMsg.value = msg\r\n    setTimeout(() => (toastMsg.value = ''), 3000)\r\n  }\r\n  function toggleReports(id) {\r\n    showReports.value[id] = !showReports.value[id]\r\n  }\r\n  function handleEdit(newsId, reportId) {\r\n    const card = newsStore.cards.find(c => c.id === newsId)\r\n    editCard.value = card\r\n    replyToId.value = 0\r\n    if (reportId) {\r\n      editReport.value = card.reports.find(r => r.id === reportId) || null\r\n    } else {\r\n      editReport.value = null\r\n    }\r\n  }\r\n  function handleReply(newsId) {\r\n    replyToId.value = newsId\r\n  }\r\n  const fetchNews = async () => {\r\n    const ok = await newsStore.fetchNews({\r\n      limit: 10,\r\n      offset: newsStore.cards.length,\r\n      append: true,\r\n    })\r\n    if (ok) {\r\n      return {\r\n        items: newsStore.cards,\r\n        has_more: newsStore.more,\r\n      }\r\n    }\r\n    return {\r\n      items: newsStore.cards,\r\n      has_more: false,\r\n    }\r\n  }\r\n  const {\r\n    loadMoreTrigger,\r\n    setupObserver,\r\n  } = useInfiniteScroll(fetchNews, { limit: 10, immediate: true })\r\n  usePollingWithCompare(() => newsStore.fetchLatestNewsRaw(10, 0), {\r\n    intervalMs: 6000,\r\n    isDifferent: (oldData, newData) => {\r\n      if (!Array.isArray(oldData) || !Array.isArray(newData)) return true\r\n      if (oldData.length !== newData.length) return true\r\n\r\n      for (let i = 0; i < newData.length; i++) {\r\n        const oldItem = oldData[i]\r\n        const newItem = newData[i]\r\n\r\n        if (oldItem.id !== newItem.id) return true\r\n\r\n        const oldReports = oldItem.reports || []\r\n        const newReports = newItem.reports || []\r\n\r\n        if (oldReports.length !== newReports.length) return true\r\n\r\n        for (let j = 0; j < newReports.length; j++) {\r\n          const oldReport = oldReports[j]\r\n          const newReport = newReports[j]\r\n\r\n          if (\r\n            oldReport.id !== newReport.id ||\r\n            oldReport.updated_at !== newReport.updated_at ||\r\n            oldReport.status !== newReport.status ||\r\n            oldReport.run_time !== newReport.run_time\r\n          ) {\r\n            return true\r\n          }\r\n        }\r\n      }\r\n\r\n      return false\r\n    },\r\n    onChange: async (newCards) => {\r\n      for (const newItem of newCards) {\r\n        const index = newsStore.cards.findIndex(c => c.id === newItem.id)\r\n        if (index !== -1) {\r\n          const card = newsStore.cards[index]\r\n          const updatedCard = { ...card, reports: newItem.reports }\r\n          newsStore.cards.splice(index, 1, updatedCard)\r\n        } else {\r\n          newsStore.cards.push(newItem)\r\n        }\r\n      }\r\n      if (newCards.length > 0) {\r\n        showToast('ŸÖŸÜÿ™ÿ∏ÿ± ÿ®ŸÖÿßŸÜ€åÿØ')\r\n      }\r\n    }\r\n  })\r\n  function openCalendarModal(id,reportId) {\r\n      selectedNewsId.value = id\r\n      selectedReportId.value=reportId\r\n      if (reportId) {\r\n        const card = newsStore.cards.find(c => c.id === id)\r\n        if (card) {\r\n          const report = card.reports.find(r => r.id === reportId)\r\n          modalRunTime.value = report?.run_time ? new Date(report.run_time) : null\r\n        } else {\r\n          modalRunTime.value = null\r\n        }\r\n      } else {\r\n        modalRunTime.value = null\r\n      }\r\n\r\n      showModal.value = true\r\n  }\r\n  async function onCalendarSubmit({ date }) {\r\n      const jsDate = date ? moment(date, 'jYYYY/jMM/jDD').hour(12).minute(0).second(0).toDate() : null\r\n      const success = await newsStore.scheduleNewsRunTime(selectedNewsId.value,selectedReportId.value,jsDate)\r\n      if (success) {\r\n          showModal.value = false\r\n          const updated = await newsStore.fetchNewsById(selectedNewsId.value)\r\n          if (updated) {\r\n            const index = newsStore.cards.findIndex(c => c.id === selectedNewsId.value)\r\n            if (index !== -1) {\r\n              newsStore.cards[index] = updated\r\n            }\r\n          }\r\n      } else {\r\n          alert('ÿÆÿ∑ÿß ÿØÿ± ÿ´ÿ®ÿ™ ÿ™ÿßÿ±€åÿÆ ÿßÿ¨ÿ±ÿß')\r\n      }\r\n  }\r\n  function openMapModal(item, parentCard = null) {\r\n    const lat = item?.location?.lat\r\n    const lon = item?.location?.lon\r\n    if (!lat || !lon) return\r\n    if(parentCard){\r\n      selectedPlace.value = {\r\n        ...item.location,\r\n        title:'ŸÖŸàŸÇÿπ€åÿ™',\r\n        description: (item.description ? item.description : 'ÿ®ÿØŸàŸÜ ÿπŸÜŸàÿßŸÜ') + (item.run_time?'üìÖ ÿ™ÿßÿ±€åÿÆ ŸÖŸÑÿßŸÇÿßÿ™ '+ moment(item.run_time).format('jYYYY/jMM/jDD') : ''),\r\n        categories: parentCard?.category || [],\r\n        medias: item.media || [],\r\n        address: item.location.address\r\n      }\r\n    }else{\r\n      selectedPlace.value = {\r\n        ...item.location,\r\n        title:'ŸÖŸàŸÇÿπ€åÿ™',\r\n        description: item.description || 'ÿ®ÿØŸàŸÜ ÿπŸÜŸàÿßŸÜ',\r\n        categories: item?.category || [],\r\n        medias: item.medias || [],\r\n        address: item.location.address\r\n      }\r\n    }\r\n    showMapModal.value = true\r\n  }\r\n  onMounted(async () => {\r\n    setTimeout(() => {\r\n      setupObserver()\r\n    }, 100)\r\n    const res = await newsStore.fetchAddNewsData()\r\n    if (res?.coordinate?.lat && res?.coordinate?.lon) {\r\n      userCoordinate.value = res.coordinate\r\n    }\r\n  })\r\n</script>\r\n<style scoped>\r\n  .inner-posts {\r\n    position: fixed;\r\n    top: 60px;\r\n    bottom: 45px;\r\n    overflow: hidden;\r\n    left: 0;\r\n    right: 0;\r\n  }\r\n  .scroll-trigger{\r\n    position: relative;\r\n    top: 10px;\r\n  }\r\n  .card-inner {\r\n    padding: 10px;\r\n    width: 100%;\r\n    box-sizing: border-box;\r\n    display: flex;\r\n    flex-direction: column-reverse;\r\n    max-height: 100%;\r\n    overflow-y: auto;\r\n    overflow-x: hidden;\r\n    gap: 3px;\r\n    justify-content: flex-start;\r\n  }\r\n  .card {\r\n    box-shadow: 0 5px 5px grey;\r\n    /* box-shadow: 0px 0px 125px #153c23; */\r\n    border-left: 5px solid #e17cfd;\r\n    box-sizing: border-box;\r\n    width: 100%;\r\n    padding: 1rem;\r\n    border-radius: 0 50px 50px 50px;\r\n    /* border-radius: 0 50px 50px 0px; */\r\n    background-color: #fff6c1;\r\n    align-self: flex-start;\r\n    position: sticky;\r\n    bottom: 10px;\r\n    direction: rtl;\r\n    transition: all 0.3s ease;\r\n  }\r\n  .card .user-info.my-news {\r\n    text-align: right;\r\n  }\r\n  .card.my-news {\r\n    border-right: 5px solid #0a7283;\r\n    border-left: unset;\r\n    align-self: flex-end;\r\n    border-radius: 50px 0 50px 50px;\r\n    /* border-radius: 50px 0px 0px 50px; */\r\n    background-color: #b3ffd0;\r\n  }\r\n  .card.my-news::before {\r\n    content: \"\";\r\n    position: absolute;\r\n    top: 12px;\r\n    right: -10px;\r\n    border-width: 10px;\r\n    border-style: solid;\r\n    border-color: transparent transparent transparent #d0f0ff;\r\n  }\r\n  .card:not(.my-news)::before {\r\n    content: \"\";\r\n    position: absolute;\r\n    top: 12px;\r\n    left: -10px;\r\n    border-width: 10px;\r\n    border-style: solid;\r\n    border-color: transparent #f1f1f1 transparent transparent;\r\n  }\r\n  .user-info {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 0.5rem;\r\n    margin-bottom: 0.5rem;\r\n  }\r\n  .user-info img ,.user-info svg {\r\n    width: 32px;\r\n    height: 32px;\r\n    object-fit: cover;\r\n    border-radius: 50%;\r\n  }\r\n  .card-category {\r\n    margin-top: 0.5rem;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    gap: 0.3rem;\r\n  }\r\n  .card-category .category {\r\n    background: #eee;\r\n    padding: 2px 6px;\r\n    border-radius: 6px;\r\n    font-size: 0.75rem;\r\n  }\r\n  .description {\r\n    margin-top: 0.5rem;\r\n    line-height: 1.6;\r\n  }\r\n  .time {\r\n    font-size: 0.75rem;\r\n    color: #777;\r\n    float: left;\r\n    margin-top: 10px;\r\n  }\r\n  .choose {\r\n    display: inline-block;\r\n    margin-right: 0.2rem;\r\n    margin-top: 0.5rem;\r\n    background: #007bff;\r\n    color: white;\r\n    padding: 4px 8px;\r\n    border-radius: 6px;\r\n    font-size: 0.8rem;\r\n    cursor: pointer;\r\n    text-decoration: none;\r\n  }\r\n  .choose:hover {\r\n    background: #0056b3;\r\n  }\r\n  .report-block {\r\n    margin-top: 1rem;\r\n    padding-top: 0.5rem;\r\n    border-top: 1px solid #ccc;\r\n    display: flex;\r\n    gap: 10px;\r\n    justify-content: flex-start;\r\n    flex-direction: row;\r\n    overflow: auto;\r\n  }\r\n  .single-report {\r\n    margin-top: 0.5rem;\r\n    position: sticky;\r\n    right: 7px;\r\n    width: 100%;\r\n    font-size: 0.9rem;\r\n    background: #fafafa;\r\n    padding: 15px;\r\n    border-radius: 0.5rem;\r\n  }\r\n  .reporter-user {\r\n    display: flex;\r\n    gap: 6px;\r\n    align-items: center;\r\n  }\r\n  .reporter-user img, .reporter-user svg {\r\n    width: 35px;\r\n    height: 35px;\r\n    border-radius: 50px;\r\n  }\r\n  .none-cart-error{\r\n    text-align: center;\r\n    background-color: #dc6a6a;\r\n    color: white;\r\n    border-radius: 10px;\r\n    height: 200px;\r\n    width: 100%;\r\n    font-size: x-large;\r\n    font-weight: bolder;\r\n    padding-top: 150px;\r\n    box-sizing: content-box;\r\n    box-shadow: 0 0 10px grey;\r\n  }\r\n  .toast{\r\n    position: fixed;\r\n    z-index: 99999999999999;\r\n    padding: 10px;\r\n    background-color: greenyellow;\r\n    border-radius: 10px;\r\n    bottom: 85px;\r\n    left: 15px;\r\n  }\r\n  .tiny-loader {\r\n    width: 20px;\r\n    height: 20px;\r\n    border: 2px solid #ccc;\r\n    border-top-color: #333;\r\n    border-radius: 50%;\r\n    animation: spin 1s linear infinite;\r\n    margin: 10px auto;\r\n  }\r\n  @keyframes spin {\r\n    to { transform: rotate(360deg); }\r\n  }\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}