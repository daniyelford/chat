{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = {\n  key: 0\n};\nconst _hoisted_2 = {\n  key: 1\n};\nconst _hoisted_3 = {\n  key: 0\n};\nconst _hoisted_4 = {\n  class: \"actions\"\n};\nconst _hoisted_5 = [\"onClick\"];\nconst _hoisted_6 = [\"onClick\"];\nimport { ref, onMounted } from 'vue';\nimport { sendApi } from '@/utils/api';\nimport router from '@/router';\nexport default {\n  __name: 'ManageNews',\n  setup(__props) {\n    const newsList = ref([]);\n    const loading = ref(false);\n    const loadNews = async () => {\n      loading.value = true;\n      try {\n        const res = await sendApi({\n          control: 'news',\n          action: 'user_news'\n        });\n        if (res.status === 'success') {\n          newsList.value = res.data || [];\n        } else {\n          alert('خطا در بارگذاری اخبار: ' + res.message);\n        }\n      } catch (error) {\n        alert('خطا در ارتباط با سرور: ' + error.message);\n      }\n      loading.value = false;\n    };\n    const editNews = id => {\n      // فرض میکنیم صفحه ویرایش داریم با روت مثل: /news/edit/:id\n      router.push(`/news/edit/${id}`);\n    };\n    const deleteNews = async id => {\n      if (!confirm('آیا مطمئن هستید که می‌خواهید این خبر را حذف کنید؟')) return;\n      try {\n        const res = await sendApi({\n          control: 'news',\n          action: 'delete_news',\n          data: {\n            news_id: id\n          }\n        });\n        if (res.status === 'success') {\n          alert('خبر با موفقیت حذف شد.');\n          await loadNews();\n        } else {\n          alert('خطا در حذف خبر: ' + res.message);\n        }\n      } catch (error) {\n        alert('خطا در ارتباط با سرور: ' + error.message);\n      }\n    };\n    onMounted(() => {\n      loadNews();\n    });\n    return (_ctx, _cache) => {\n      return _openBlock(), _createElementBlock(\"div\", null, [_cache[0] || (_cache[0] = _createElementVNode(\"h2\", null, \"اخبار من\", -1)), loading.value ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, \"در حال بارگذاری...\")) : (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [newsList.value.length === 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, \"شما هنوز خبری ثبت نکردید.\")) : _createCommentVNode(\"\", true), _createElementVNode(\"ul\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(newsList.value, news => {\n        return _openBlock(), _createElementBlock(\"li\", {\n          key: news.id,\n          class: \"news-item\"\n        }, [_createElementVNode(\"h3\", null, _toDisplayString(news.title), 1), _createElementVNode(\"p\", null, _toDisplayString(news.description), 1), _createElementVNode(\"small\", null, \"دسته‌بندی: \" + _toDisplayString(news.category_title || 'ندارد'), 1), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"button\", {\n          onClick: $event => editNews(news.id)\n        }, \"ویرایش\", 8, _hoisted_5), _createElementVNode(\"button\", {\n          onClick: $event => deleteNews(news.id)\n        }, \"حذف\", 8, _hoisted_6)])]);\n      }), 128))])]))]);\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","sendApi","router","newsList","loading","loadNews","value","res","control","action","status","data","alert","message","error","editNews","id","push","deleteNews","confirm","news_id"],"sources":["D:/GitHub/ci3-vue3/vue3/src/components/dashboard/pagesContent/ManageNews.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <h2>اخبار من</h2>\r\n    <div v-if=\"loading\">در حال بارگذاری...</div>\r\n    <div v-else>\r\n      <div v-if=\"newsList.length === 0\">شما هنوز خبری ثبت نکردید.</div>\r\n      <ul>\r\n        <li v-for=\"news in newsList\" :key=\"news.id\" class=\"news-item\">\r\n          <h3>{{ news.title }}</h3>\r\n          <p>{{ news.description }}</p>\r\n          <small>دسته‌بندی: {{ news.category_title || 'ندارد' }}</small>\r\n          <div class=\"actions\">\r\n            <button @click=\"editNews(news.id)\">ویرایش</button>\r\n            <button @click=\"deleteNews(news.id)\">حذف</button>\r\n          </div>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { sendApi } from '@/utils/api'\r\nimport router from '@/router'\r\n\r\nconst newsList = ref([])\r\nconst loading = ref(false)\r\n\r\nconst loadNews = async () => {\r\n  loading.value = true\r\n  try {\r\n    const res = await sendApi({ control: 'news', action: 'user_news' })\r\n    if (res.status === 'success') {\r\n      newsList.value = res.data || []\r\n    } else {\r\n      alert('خطا در بارگذاری اخبار: ' + res.message)\r\n    }\r\n  } catch (error) {\r\n    alert('خطا در ارتباط با سرور: ' + error.message)\r\n  }\r\n  loading.value = false\r\n}\r\n\r\nconst editNews = (id) => {\r\n  // فرض میکنیم صفحه ویرایش داریم با روت مثل: /news/edit/:id\r\n  router.push(`/news/edit/${id}`)\r\n}\r\n\r\nconst deleteNews = async (id) => {\r\n  if (!confirm('آیا مطمئن هستید که می‌خواهید این خبر را حذف کنید؟')) return\r\n  try {\r\n    const res = await sendApi({ control: 'news', action: 'delete_news', data: { news_id: id } })\r\n    if (res.status === 'success') {\r\n      alert('خبر با موفقیت حذف شد.')\r\n      await loadNews()\r\n    } else {\r\n      alert('خطا در حذف خبر: ' + res.message)\r\n    }\r\n  } catch (error) {\r\n    alert('خطا در ارتباط با سرور: ' + error.message)\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  loadNews()\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.news-item {\r\n  border-bottom: 1px solid #ccc;\r\n  padding: 1rem 0;\r\n}\r\n.actions button {\r\n  margin-right: 0.5rem;\r\n}\r\n</style>\r\n"],"mappings":";;;;;;;;;;;;;;;;AAsBA,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAK;AACpC,SAASC,OAAO,QAAQ,aAAa;AACrC,OAAOC,MAAM,MAAM,UAAU;;;;IAE7B,MAAMC,QAAQ,GAAGJ,GAAG,CAAC,EAAE,CAAC;IACxB,MAAMK,OAAO,GAAGL,GAAG,CAAC,KAAK,CAAC;IAE1B,MAAMM,QAAQ,GAAG,MAAAA,CAAA,KAAY;MAC3BD,OAAO,CAACE,KAAK,GAAG,IAAI;MACpB,IAAI;QACF,MAAMC,GAAG,GAAG,MAAMN,OAAO,CAAC;UAAEO,OAAO,EAAE,MAAM;UAAEC,MAAM,EAAE;QAAY,CAAC,CAAC;QACnE,IAAIF,GAAG,CAACG,MAAM,KAAK,SAAS,EAAE;UAC5BP,QAAQ,CAACG,KAAK,GAAGC,GAAG,CAACI,IAAI,IAAI,EAAE;QACjC,CAAC,MAAM;UACLC,KAAK,CAAC,yBAAyB,GAAGL,GAAG,CAACM,OAAO,CAAC;QAChD;MACF,CAAC,CAAC,OAAOC,KAAK,EAAE;QACdF,KAAK,CAAC,yBAAyB,GAAGE,KAAK,CAACD,OAAO,CAAC;MAClD;MACAT,OAAO,CAACE,KAAK,GAAG,KAAK;IACvB,CAAC;IAED,MAAMS,QAAQ,GAAIC,EAAE,IAAK;MACvB;MACAd,MAAM,CAACe,IAAI,CAAC,cAAcD,EAAE,EAAE,CAAC;IACjC,CAAC;IAED,MAAME,UAAU,GAAG,MAAOF,EAAE,IAAK;MAC/B,IAAI,CAACG,OAAO,CAAC,mDAAmD,CAAC,EAAE;MACnE,IAAI;QACF,MAAMZ,GAAG,GAAG,MAAMN,OAAO,CAAC;UAAEO,OAAO,EAAE,MAAM;UAAEC,MAAM,EAAE,aAAa;UAAEE,IAAI,EAAE;YAAES,OAAO,EAAEJ;UAAG;QAAE,CAAC,CAAC;QAC5F,IAAIT,GAAG,CAACG,MAAM,KAAK,SAAS,EAAE;UAC5BE,KAAK,CAAC,uBAAuB,CAAC;UAC9B,MAAMP,QAAQ,CAAC,CAAC;QAClB,CAAC,MAAM;UACLO,KAAK,CAAC,kBAAkB,GAAGL,GAAG,CAACM,OAAO,CAAC;QACzC;MACF,CAAC,CAAC,OAAOC,KAAK,EAAE;QACdF,KAAK,CAAC,yBAAyB,GAAGE,KAAK,CAACD,OAAO,CAAC;MAClD;IACF,CAAC;IAEDb,SAAS,CAAC,MAAM;MACdK,QAAQ,CAAC,CAAC;IACZ,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}