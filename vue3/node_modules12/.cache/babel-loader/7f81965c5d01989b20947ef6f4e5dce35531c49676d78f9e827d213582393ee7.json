{"ast":null,"code":"import { createElementVNode as _createElementVNode, unref as _unref, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, vModelText as _vModelText, withDirectives as _withDirectives, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"p-4\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"bg-red-100 text-red-700 p-2 rounded mb-4\"\n};\nconst _hoisted_3 = {\n  class: \"w-full border\"\n};\nconst _hoisted_4 = {\n  class: \"p-2\"\n};\nconst _hoisted_5 = {\n  class: \"p-2\"\n};\nconst _hoisted_6 = {\n  class: \"p-2\"\n};\nconst _hoisted_7 = {\n  class: \"p-2\"\n};\nconst _hoisted_8 = [\"onClick\"];\nconst _hoisted_9 = [\"onClick\"];\nconst _hoisted_10 = {\n  key: 1,\n  class: \"mt-4\"\n};\nconst _hoisted_11 = {\n  key: 2,\n  class: \"mt-4\"\n};\nconst _hoisted_12 = {\n  key: 3,\n  class: \"mt-6 border p-4 rounded bg-gray-50\"\n};\nconst _hoisted_13 = {\n  class: \"font-bold mb-2\"\n};\nimport { ref, onMounted } from 'vue';\nimport { useUserStore } from '@/stores/user';\nexport default {\n  __name: 'UsersSettingList',\n  setup(__props) {\n    const store = useUserStore();\n    const {\n      users,\n      hasMore,\n      loading,\n      error,\n      fetchUsers,\n      submitUser,\n      deleteUser\n    } = store;\n    const limit = ref(10);\n    const offset = ref(0);\n    const showForm = ref(false);\n    const editUser = ref(null);\n    const form = ref({\n      fullName: '',\n      mobile: ''\n    });\n\n    // بارگذاری اولیه\n    onMounted(() => {\n      fetchUsers({\n        limite: limit.value,\n        offset: offset.value\n      });\n    });\n\n    // بارگذاری بیشتر\n    function loadMore() {\n      offset.value += limit.value;\n      fetchUsers({\n        limite: limit.value,\n        offset: offset.value\n      });\n    }\n\n    // حذف کاربر\n    async function removeUser(id) {\n      if (confirm('آیا از حذف مطمئن هستید؟')) {\n        await deleteUser(id);\n      }\n    }\n\n    // باز کردن فرم\n    function openForm(user = null) {\n      editUser.value = user;\n      if (user) {\n        form.value.fullName = user.fullName;\n        form.value.mobile = user.mobile;\n      } else {\n        form.value.fullName = '';\n        form.value.mobile = '';\n      }\n      showForm.value = true;\n    }\n\n    // بستن فرم\n    function cancelForm() {\n      showForm.value = false;\n    }\n\n    // ارسال فرم\n    async function submitForm() {\n      await submitUser(form.value, editUser.value ? editUser.value.id : null);\n      // ری‌لود لیست\n      offset.value = 0;\n      await fetchUsers({\n        limite: limit.value,\n        offset: offset.value\n      });\n      showForm.value = false;\n    }\n    return (_ctx, _cache) => {\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[5] || (_cache[5] = _createElementVNode(\"h2\", {\n        class: \"text-lg font-bold mb-4\"\n      }, \"مدیریت کاربران\", -1)), _createElementVNode(\"button\", {\n        class: \"bg-green-500 text-white px-4 py-2 rounded mb-4\",\n        onClick: _cache[0] || (_cache[0] = $event => openForm())\n      }, \" افزودن کاربر \"), _unref(error) ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, _toDisplayString(_unref(error)), 1)) : _createCommentVNode(\"\", true), _createElementVNode(\"table\", _hoisted_3, [_cache[3] || (_cache[3] = _createElementVNode(\"thead\", {\n        class: \"bg-gray-200\"\n      }, [_createElementVNode(\"tr\", null, [_createElementVNode(\"th\", {\n        class: \"p-2\"\n      }, \"#\"), _createElementVNode(\"th\", {\n        class: \"p-2\"\n      }, \"نام\"), _createElementVNode(\"th\", {\n        class: \"p-2\"\n      }, \"موبایل\"), _createElementVNode(\"th\", {\n        class: \"p-2\"\n      }, \"عملیات\")])], -1)), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(users), u => {\n        return _openBlock(), _createElementBlock(\"tr\", {\n          key: u.id,\n          class: \"border-t\"\n        }, [_createElementVNode(\"td\", _hoisted_4, _toDisplayString(u.id), 1), _createElementVNode(\"td\", _hoisted_5, _toDisplayString(u.fullName), 1), _createElementVNode(\"td\", _hoisted_6, _toDisplayString(u.mobile), 1), _createElementVNode(\"td\", _hoisted_7, [_createElementVNode(\"button\", {\n          class: \"bg-blue-500 text-white px-2 py-1 rounded mr-1\",\n          onClick: $event => openForm(u)\n        }, \"ویرایش\", 8, _hoisted_8), _createElementVNode(\"button\", {\n          class: \"bg-red-500 text-white px-2 py-1 rounded\",\n          onClick: $event => removeUser(u.id)\n        }, \"حذف\", 8, _hoisted_9)])]);\n      }), 128))])]), _unref(hasMore) && !_unref(loading) ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [_createElementVNode(\"button\", {\n        class: \"bg-gray-500 text-white px-4 py-2 rounded\",\n        onClick: loadMore\n      }, \" بارگذاری بیشتر \")])) : _createCommentVNode(\"\", true), _unref(loading) ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, \"در حال بارگذاری...\")) : _createCommentVNode(\"\", true), showForm.value ? (_openBlock(), _createElementBlock(\"div\", _hoisted_12, [_createElementVNode(\"h3\", _hoisted_13, _toDisplayString(editUser.value ? 'ویرایش کاربر' : 'افزودن کاربر'), 1), _createElementVNode(\"form\", {\n        onSubmit: _withModifiers(submitForm, [\"prevent\"])\n      }, [_withDirectives(_createElementVNode(\"input\", {\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => form.value.fullName = $event),\n        placeholder: \"نام کامل\",\n        class: \"border p-2 w-full mb-2\"\n      }, null, 512), [[_vModelText, form.value.fullName]]), _withDirectives(_createElementVNode(\"input\", {\n        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => form.value.mobile = $event),\n        placeholder: \"موبایل\",\n        class: \"border p-2 w-full mb-2\"\n      }, null, 512), [[_vModelText, form.value.mobile]]), _cache[4] || (_cache[4] = _createElementVNode(\"button\", {\n        class: \"bg-green-600 text-white px-4 py-2 rounded\",\n        type: \"submit\"\n      }, \" ذخیره \", -1)), _createElementVNode(\"button\", {\n        class: \"ml-2 px-4 py-2 rounded border\",\n        onClick: cancelForm,\n        type: \"button\"\n      }, \" انصراف \")], 32)])) : _createCommentVNode(\"\", true)]);\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","useUserStore","store","users","hasMore","loading","error","fetchUsers","submitUser","deleteUser","limit","offset","showForm","editUser","form","fullName","mobile","limite","value","loadMore","removeUser","id","confirm","openForm","user","cancelForm","submitForm"],"sources":["D:/GitHub/chat/vue3/src/components/tooles/users/UsersSettingList.vue"],"sourcesContent":["<template>\r\n  <div class=\"p-4\">\r\n    <h2 class=\"text-lg font-bold mb-4\">مدیریت کاربران</h2>\r\n\r\n    <!-- دکمه افزودن کاربر -->\r\n    <button\r\n      class=\"bg-green-500 text-white px-4 py-2 rounded mb-4\"\r\n      @click=\"openForm()\"\r\n    >\r\n      افزودن کاربر\r\n    </button>\r\n\r\n    <!-- خطا -->\r\n    <div v-if=\"error\" class=\"bg-red-100 text-red-700 p-2 rounded mb-4\">\r\n      {{ error }}\r\n    </div>\r\n\r\n    <!-- جدول کاربران -->\r\n    <table class=\"w-full border\">\r\n      <thead class=\"bg-gray-200\">\r\n        <tr>\r\n          <th class=\"p-2\">#</th>\r\n          <th class=\"p-2\">نام</th>\r\n          <th class=\"p-2\">موبایل</th>\r\n          <th class=\"p-2\">عملیات</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr v-for=\"u in users\" :key=\"u.id\" class=\"border-t\">\r\n          <td class=\"p-2\">{{ u.id }}</td>\r\n          <td class=\"p-2\">{{ u.fullName }}</td>\r\n          <td class=\"p-2\">{{ u.mobile }}</td>\r\n          <td class=\"p-2\">\r\n            <button class=\"bg-blue-500 text-white px-2 py-1 rounded mr-1\" @click=\"openForm(u)\">ویرایش</button>\r\n            <button class=\"bg-red-500 text-white px-2 py-1 rounded\" @click=\"removeUser(u.id)\">حذف</button>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n\r\n    <!-- دکمه لود بیشتر -->\r\n    <div v-if=\"hasMore && !loading\" class=\"mt-4\">\r\n      <button class=\"bg-gray-500 text-white px-4 py-2 rounded\" @click=\"loadMore\">\r\n        بارگذاری بیشتر\r\n      </button>\r\n    </div>\r\n\r\n    <!-- لودینگ -->\r\n    <div v-if=\"loading\" class=\"mt-4\">در حال بارگذاری...</div>\r\n\r\n    <!-- فرم افزودن/ویرایش -->\r\n    <div v-if=\"showForm\" class=\"mt-6 border p-4 rounded bg-gray-50\">\r\n      <h3 class=\"font-bold mb-2\">{{ editUser ? 'ویرایش کاربر' : 'افزودن کاربر' }}</h3>\r\n      <form @submit.prevent=\"submitForm\">\r\n        <input v-model=\"form.fullName\" placeholder=\"نام کامل\" class=\"border p-2 w-full mb-2\" />\r\n        <input v-model=\"form.mobile\" placeholder=\"موبایل\" class=\"border p-2 w-full mb-2\" />\r\n        <button class=\"bg-green-600 text-white px-4 py-2 rounded\" type=\"submit\">\r\n          ذخیره\r\n        </button>\r\n        <button class=\"ml-2 px-4 py-2 rounded border\" @click=\"cancelForm\" type=\"button\">\r\n          انصراف\r\n        </button>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { useUserStore } from '@/stores/user'\r\n\r\nconst store = useUserStore()\r\n\r\nconst { users, hasMore, loading, error, fetchUsers, submitUser, deleteUser } = store\r\n\r\nconst limit = ref(10)\r\nconst offset = ref(0)\r\nconst showForm = ref(false)\r\nconst editUser = ref(null)\r\nconst form = ref({ fullName: '', mobile: '' })\r\n\r\n// بارگذاری اولیه\r\nonMounted(() => {\r\n  fetchUsers({ limite: limit.value, offset: offset.value })\r\n})\r\n\r\n// بارگذاری بیشتر\r\nfunction loadMore() {\r\n  offset.value += limit.value\r\n  fetchUsers({ limite: limit.value, offset: offset.value })\r\n}\r\n\r\n// حذف کاربر\r\nasync function removeUser(id) {\r\n  if (confirm('آیا از حذف مطمئن هستید؟')) {\r\n    await deleteUser(id)\r\n  }\r\n}\r\n\r\n// باز کردن فرم\r\nfunction openForm(user = null) {\r\n  editUser.value = user\r\n  if (user) {\r\n    form.value.fullName = user.fullName\r\n    form.value.mobile = user.mobile\r\n  } else {\r\n    form.value.fullName = ''\r\n    form.value.mobile = ''\r\n  }\r\n  showForm.value = true\r\n}\r\n\r\n// بستن فرم\r\nfunction cancelForm() {\r\n  showForm.value = false\r\n}\r\n\r\n// ارسال فرم\r\nasync function submitForm() {\r\n  await submitUser(form.value, editUser.value ? editUser.value.id : null)\r\n  // ری‌لود لیست\r\n  offset.value = 0\r\n  await fetchUsers({ limite: limit.value, offset: offset.value })\r\n  showForm.value = false\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n  table th,\r\n  table td {\r\n    text-align: center;\r\n  }\r\n</style>\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAK;AACpC,SAASC,YAAY,QAAQ,eAAe;;;;IAE5C,MAAMC,KAAK,GAAGD,YAAY,CAAC,CAAC;IAE5B,MAAM;MAAEE,KAAK;MAAEC,OAAO;MAAEC,OAAO;MAAEC,KAAK;MAAEC,UAAU;MAAEC,UAAU;MAAEC;IAAW,CAAC,GAAGP,KAAK;IAEpF,MAAMQ,KAAK,GAAGX,GAAG,CAAC,EAAE,CAAC;IACrB,MAAMY,MAAM,GAAGZ,GAAG,CAAC,CAAC,CAAC;IACrB,MAAMa,QAAQ,GAAGb,GAAG,CAAC,KAAK,CAAC;IAC3B,MAAMc,QAAQ,GAAGd,GAAG,CAAC,IAAI,CAAC;IAC1B,MAAMe,IAAI,GAAGf,GAAG,CAAC;MAAEgB,QAAQ,EAAE,EAAE;MAAEC,MAAM,EAAE;IAAG,CAAC,CAAC;;IAE9C;IACAhB,SAAS,CAAC,MAAM;MACdO,UAAU,CAAC;QAAEU,MAAM,EAAEP,KAAK,CAACQ,KAAK;QAAEP,MAAM,EAAEA,MAAM,CAACO;MAAM,CAAC,CAAC;IAC3D,CAAC,CAAC;;IAEF;IACA,SAASC,QAAQA,CAAA,EAAG;MAClBR,MAAM,CAACO,KAAK,IAAIR,KAAK,CAACQ,KAAK;MAC3BX,UAAU,CAAC;QAAEU,MAAM,EAAEP,KAAK,CAACQ,KAAK;QAAEP,MAAM,EAAEA,MAAM,CAACO;MAAM,CAAC,CAAC;IAC3D;;IAEA;IACA,eAAeE,UAAUA,CAACC,EAAE,EAAE;MAC5B,IAAIC,OAAO,CAAC,yBAAyB,CAAC,EAAE;QACtC,MAAMb,UAAU,CAACY,EAAE,CAAC;MACtB;IACF;;IAEA;IACA,SAASE,QAAQA,CAACC,IAAI,GAAG,IAAI,EAAE;MAC7BX,QAAQ,CAACK,KAAK,GAAGM,IAAI;MACrB,IAAIA,IAAI,EAAE;QACRV,IAAI,CAACI,KAAK,CAACH,QAAQ,GAAGS,IAAI,CAACT,QAAQ;QACnCD,IAAI,CAACI,KAAK,CAACF,MAAM,GAAGQ,IAAI,CAACR,MAAM;MACjC,CAAC,MAAM;QACLF,IAAI,CAACI,KAAK,CAACH,QAAQ,GAAG,EAAE;QACxBD,IAAI,CAACI,KAAK,CAACF,MAAM,GAAG,EAAE;MACxB;MACAJ,QAAQ,CAACM,KAAK,GAAG,IAAI;IACvB;;IAEA;IACA,SAASO,UAAUA,CAAA,EAAG;MACpBb,QAAQ,CAACM,KAAK,GAAG,KAAK;IACxB;;IAEA;IACA,eAAeQ,UAAUA,CAAA,EAAG;MAC1B,MAAMlB,UAAU,CAACM,IAAI,CAACI,KAAK,EAAEL,QAAQ,CAACK,KAAK,GAAGL,QAAQ,CAACK,KAAK,CAACG,EAAE,GAAG,IAAI,CAAC;MACvE;MACAV,MAAM,CAACO,KAAK,GAAG,CAAC;MAChB,MAAMX,UAAU,CAAC;QAAEU,MAAM,EAAEP,KAAK,CAACQ,KAAK;QAAEP,MAAM,EAAEA,MAAM,CAACO;MAAM,CAAC,CAAC;MAC/DN,QAAQ,CAACM,KAAK,GAAG,KAAK;IACxB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}