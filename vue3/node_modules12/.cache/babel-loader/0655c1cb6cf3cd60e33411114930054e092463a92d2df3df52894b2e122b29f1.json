{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { defineStore } from 'pinia';\nimport { sendApi } from '@/utils/api';\nexport const useUserStore = defineStore('user', {\n  state: () => ({\n    fullName: '',\n    name: '',\n    family: '',\n    mobile: '',\n    wallet: 0,\n    tokenScore: 0,\n    image: '',\n    finger: false,\n    rule: false,\n    hasMore: false,\n    isLoaded: false,\n    ruleInfo: [],\n    users: [],\n    loading: false,\n    error: null,\n    allCategories: [],\n    allRules: [],\n    status: 'inactive',\n    banTime: null\n  }),\n  actions: {\n    async fetchUserInfo() {\n      try {\n        const res = await sendApi({\n          action: 'get_user_info',\n          control: 'user'\n        });\n        if (res.status === 'success') {\n          this.fullName = res.fullName;\n          this.name = res.name;\n          this.family = res.family;\n          this.mobile = res.mobile;\n          this.wallet = res.wallet;\n          this.image = res.image;\n          this.finger = res.finger;\n          this.status = res.user_status;\n          this.banTime = res.user_ban;\n          this.tokenScore = res.token_score;\n          this.rule = Array.isArray(res.rules) && res.rules.length > 0;\n          this.ruleInfo = res.rules;\n          this.isLoaded = true;\n        } else {\n          console.warn('User info error:', res);\n        }\n      } catch (err) {\n        console.error('Error fetching user:', err);\n      }\n    },\n    async fetchUsers({\n      limite = 10,\n      offset = 0\n    }) {\n      this.loading = true;\n      this.error = null;\n      try {\n        const res = await sendApi({\n          action: 'get_users',\n          control: 'user',\n          data: {\n            limite,\n            offset\n          }\n        });\n        if (res.status === 'success' && Array.isArray(res.data)) {\n          this.hasMore = res.has_more;\n          if (offset === 0) {\n            this.users = res.data;\n          } else {\n            this.users.push(...res.data);\n          }\n          this.allCategories = res.all_category;\n          this.allRules = res.all_rule;\n        } else {\n          this.error = res.message || 'خطا در دریافت کاربران';\n        }\n      } catch (err) {\n        this.error = 'خطای ارتباط با سرور';\n        console.error(err);\n      } finally {\n        this.loading = false;\n      }\n    },\n    async submitUser(userData, edit = null) {\n      try {\n        const res = await sendApi({\n          action: 'user_submit',\n          control: 'user',\n          data: {\n            data: userData,\n            edit: edit\n          }\n        });\n        if (res.status === 'success' && Array.isArray(res.data)) {\n          if (!edit) {\n            this.users.unshift(res.data);\n          } else {\n            const index = this.users.findIndex(c => Number(c.id) === Number(edit.id));\n            if (index !== -1) {\n              this.users[index] = res.data;\n            } else {\n              this.users.unshift(res.data);\n            }\n          }\n        }\n      } catch (err) {\n        console.error(err);\n      }\n    },\n    async enableUser(id) {\n      try {\n        const res = await sendApi({\n          action: 'enable_user',\n          control: 'user',\n          data: {\n            id\n          }\n        });\n        if (res.status === 'success') {\n          return true;\n        }\n        return false;\n      } catch (err) {\n        console.error(err);\n      }\n    },\n    async disableUser(id) {\n      try {\n        const res = await sendApi({\n          action: 'disable_user',\n          control: 'user',\n          data: {\n            id\n          }\n        });\n        if (res.status === 'success') {\n          return true;\n        }\n        return false;\n      } catch (err) {\n        console.error(err);\n      }\n    }\n  }\n});","map":{"version":3,"names":["defineStore","sendApi","useUserStore","state","fullName","name","family","mobile","wallet","tokenScore","image","finger","rule","hasMore","isLoaded","ruleInfo","users","loading","error","allCategories","allRules","status","banTime","actions","fetchUserInfo","res","action","control","user_status","user_ban","token_score","Array","isArray","rules","length","console","warn","err","fetchUsers","limite","offset","data","has_more","push","all_category","all_rule","message","submitUser","userData","edit","unshift","index","findIndex","c","Number","id","enableUser","disableUser"],"sources":["D:/GitHub/chat/vue3/src/stores/user.js"],"sourcesContent":["import { defineStore } from 'pinia'\r\nimport { sendApi } from '@/utils/api'\r\n\r\nexport const useUserStore = defineStore('user', {\r\n  state: () => ({\r\n    fullName: '',\r\n    name: '',\r\n    family: '',\r\n    mobile: '',\r\n    wallet: 0,\r\n    tokenScore: 0,\r\n    image: '',\r\n    finger: false,\r\n    rule: false,\r\n    hasMore: false,\r\n    isLoaded: false,\r\n    ruleInfo: [],\r\n    users: [],\r\n    loading: false,\r\n    error: null,\r\n    allCategories: [],\r\n    allRules: [],\r\n    status:'inactive',\r\n    banTime:null\r\n  }),\r\n\r\n  actions: {\r\n    async fetchUserInfo() {\r\n      try {\r\n        const res = await sendApi({ action: 'get_user_info', control: 'user' })\r\n        if (res.status === 'success') {\r\n          this.fullName = res.fullName\r\n          this.name = res.name\r\n          this.family = res.family\r\n          this.mobile = res.mobile\r\n          this.wallet = res.wallet\r\n          this.image = res.image\r\n          this.finger = res.finger\r\n          this.status = res.user_status\r\n          this.banTime = res.user_ban\r\n          this.tokenScore = res.token_score\r\n          this.rule = Array.isArray(res.rules) && res.rules.length > 0\r\n          this.ruleInfo = res.rules\r\n          this.isLoaded = true\r\n        } else {\r\n          console.warn('User info error:', res)\r\n        }\r\n      } catch (err) {\r\n        console.error('Error fetching user:', err)\r\n      }\r\n    },\r\n    async fetchUsers({ limite = 10, offset = 0 }) {\r\n      this.loading = true\r\n      this.error = null\r\n      try {\r\n        const res = await sendApi({\r\n          action: 'get_users',\r\n          control: 'user',\r\n          data: { limite, offset }\r\n        })\r\n        if (res.status === 'success' && Array.isArray(res.data)) {\r\n          this.hasMore = res.has_more\r\n          if (offset === 0) {\r\n            this.users = res.data\r\n          } else {\r\n            this.users.push(...res.data)\r\n          }\r\n          this.allCategories = res.all_category\r\n          this.allRules = res.all_rule\r\n        } else {\r\n          this.error = res.message || 'خطا در دریافت کاربران'\r\n        }\r\n      } catch (err) {\r\n        this.error = 'خطای ارتباط با سرور'\r\n        console.error(err)\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    },\r\n    async submitUser(userData, edit = null) {\r\n      try {\r\n        const res = await sendApi({\r\n          action: 'user_submit',\r\n          control: 'user',\r\n          data: { data: userData, edit: edit }\r\n        })\r\n        if (res.status === 'success' && Array.isArray(res.data)){          \r\n          if (!edit) {\r\n            this.users.unshift(res.data)\r\n          } else {\r\n            const index = this.users.findIndex(c => Number(c.id) === Number(edit.id))\r\n            if (index !== -1) {\r\n              this.users[index] = res.data\r\n            } else {\r\n              this.users.unshift(res.data)\r\n            }\r\n          }\r\n        }\r\n      } catch (err) {\r\n        console.error(err)\r\n      }\r\n    },\r\n    async enableUser(id) {\r\n      try {\r\n        const res = await sendApi({\r\n          action: 'enable_user',\r\n          control: 'user',\r\n          data: { id }\r\n        })\r\n        if (res.status === 'success') {\r\n          return true\r\n        }\r\n        return false\r\n      } catch (err) {\r\n        console.error(err)\r\n      }\r\n    },\r\n    async disableUser(id) {\r\n      try {\r\n        const res = await sendApi({\r\n          action: 'disable_user',\r\n          control: 'user',\r\n          data: { id }\r\n        })\r\n        if (res.status === 'success') {\r\n          return true\r\n        }\r\n        return false\r\n      } catch (err) {\r\n        console.error(err)\r\n      }\r\n    },\r\n  }\r\n})\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}