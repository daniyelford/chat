{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, unref as _unref } from \"vue\";\nconst _hoisted_1 = {\n  key: 0,\n  class: \"loading\"\n};\nconst _hoisted_2 = {\n  key: 1,\n  class: \"card-inner\"\n};\nconst _hoisted_3 = {\n  class: \"info\"\n};\nconst _hoisted_4 = {\n  class: \"card-header\"\n};\nconst _hoisted_5 = {\n  class: \"location\"\n};\nconst _hoisted_6 = {\n  class: \"card-category\"\n};\nconst _hoisted_7 = {\n  class: \"medias\"\n};\nconst _hoisted_8 = {\n  class: \"name\"\n};\nconst _hoisted_9 = {\n  class: \"time\"\n};\nconst _hoisted_10 = {\n  key: 0,\n  class: \"type\"\n};\nconst _hoisted_11 = {\n  class: \"choose\"\n};\nconst _hoisted_12 = [\"onClick\"];\nconst _hoisted_13 = {\n  key: 2,\n  class: \"none-cart-error\"\n};\nimport { computed, onMounted, ref } from 'vue';\nimport moment from 'moment-jalaali';\nimport { sendApi } from '@/utils/api';\nexport default {\n  __name: 'NewsCards',\n  props: {\n    filters: Object\n  },\n  emits: ['initFilterRanges'],\n  setup(__props, {\n    emit: __emit\n  }) {\n    const emit = __emit;\n    const props = __props;\n    const isLoaded = ref(false);\n    const cards = ref([]);\n    onMounted(async () => {\n      const news = await sendApi({\n        action: 'get_news',\n        control: 'news'\n      });\n      if (news.status === \"success\") {\n        cards.value = news.data.map(cat => ({\n          id: cat.id,\n          location: cat.location,\n          category: cat.category,\n          description: cat.description,\n          created_at: cat.created_at,\n          type: cat.type,\n          media: cat.media\n        }));\n      } else {\n        console.warn('دریافت دسته‌بندی‌ها ناموفق بود:', carts);\n      }\n    });\n    const filteredCards = computed(() => {\n      let result = (cards.value || []).filter(card => {\n        const f = props.filters;\n        if (f) {\n          // if (f.withInsight && !card.insight) return false\n          if (Array.isArray(f.categories) && f.categories.length > 0 && !f.categories.includes(card.category)) {\n            return false;\n          }\n          // if (Array.isArray(f.socialTypes) && f.socialTypes.length > 0 && !f.socialTypes.some(type => (card.type || '').includes(type))) {\n          //     return false\n          // }\n        }\n        // if (props.searchTerm) {\n        //     const term = props.searchTerm.toLowerCase()\n        //     const username = (card.username || '').toLowerCase()\n        //     const title = (card.title || '').toLowerCase()\n        //     if (!username.includes(term) && !title.includes(term)) return false\n        // }\n        return true;\n      });\n      // if (props.sortKey) {\n      //     result = [...result].sort((a, b) => (b[props.sortKey] ?? 0) - (a[props.sortKey] ?? 0))\n      // }\n      return result;\n    });\n    async function select(id) {\n      // const response = await sendApi({action: \"page_handler/telegram_cards\", handler:'select_card', data: id});\n      // if(response.status ==='success'){\n      //     const selectedCard = cards.value.find(card => card.id === id)\n      //     if (selectedCard) {\n      //         selectedCard.selected = true\n      //     }\n      // }else{\n      //     alert('ارتباط با اینترنت قطع است');            \n      // }\n    }\n    return (_ctx, _cache) => {\n      return !isLoaded.value ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, \" در حال بارگذاری... \")) : filteredCards.value.length > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(filteredCards.value, card => {\n        return _openBlock(), _createElementBlock(\"div\", {\n          key: card.id,\n          class: \"card\"\n        }, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, _toDisplayString(card.location), 1), _createElementVNode(\"div\", _hoisted_6, _toDisplayString(card.category), 1)]), _createElementVNode(\"div\", _hoisted_7, _toDisplayString(card.media), 1), _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"p\", null, _toDisplayString(card.description), 1)])]), _createElementVNode(\"div\", _hoisted_9, [_cache[0] || (_cache[0] = _createElementVNode(\"span\", null, \" زمان ثبت \", -1)), _createElementVNode(\"span\", null, _toDisplayString(_unref(moment)(card.created_at).format('jYYYY/jMM/jDD')), 1)]), card.type === 'force' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, \" فوری \")) : _createCommentVNode(\"\", true), _createElementVNode(\"div\", _hoisted_11, [_createElementVNode(\"a\", {\n          onClick: $event => select(card.id)\n        }, \" انتخاب \", 8, _hoisted_12)])]);\n      }), 128))])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_13, \" خبری در محدوده شما وجود ندارد \"));\n    };\n  }\n};","map":{"version":3,"names":["computed","onMounted","ref","moment","sendApi","emit","__emit","props","__props","isLoaded","cards","news","action","control","status","value","data","map","cat","id","location","category","description","created_at","type","media","console","warn","carts","filteredCards","result","filter","card","f","filters","Array","isArray","categories","length","includes","select"],"sources":["D:/GitHub/ci3-vue3/vue3/src/components/dashboard/pagesContent/NewsCards.vue"],"sourcesContent":["<template>\r\n    <div class=\"loading\" v-if=\"!isLoaded\">\r\n        در حال بارگذاری...\r\n    </div>\r\n    <div class=\"card-inner\" v-else-if=\"filteredCards.length>0\">\r\n        <div v-for=\"card in filteredCards\" :key=\"card.id\" class=\"card\">\r\n            <div class=\"info\">\r\n                <div class=\"card-header\">\r\n                    <div class=\"location\">\r\n                        {{ card.location }}\r\n                    </div>\r\n                    <div class=\"card-category\">\r\n                        {{ card.category }}\r\n                    </div>\r\n                </div>\r\n                <div class=\"medias\">\r\n                    {{ card.media }}\r\n                </div>\r\n                <div class=\"name\">\r\n                    <p>{{ card.description }}</p>\r\n                </div>\r\n            </div>\r\n            <div class=\"time\">\r\n                <span>\r\n                    زمان ثبت\r\n                </span>\r\n                <span>\r\n                    {{ moment(card.created_at).format('jYYYY/jMM/jDD') }}\r\n                </span>\r\n            </div>\r\n            <div class=\"type\" v-if=\"card.type ==='force'\">\r\n                فوری\r\n            </div>\r\n            <div class=\"choose\">\r\n                <a @click=\"select(card.id)\">\r\n                    انتخاب\r\n                </a>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class=\"none-cart-error\" v-else>\r\n        خبری در محدوده شما وجود ندارد\r\n    </div>\r\n</template>\r\n<script setup>\r\n    import { computed, onMounted ,ref } from 'vue'\r\n    import moment from 'moment-jalaali'\r\n    import { sendApi } from '@/utils/api'\r\n    const emit = defineEmits(['initFilterRanges'])\r\n    const props = defineProps({\r\n        filters: Object,\r\n    })\r\n    const isLoaded = ref(false)\r\n    const cards = ref([])\r\n    onMounted(async () => {\r\n        const news = await sendApi({action: 'get_news',control:'news'});\r\n        if(news.status===\"success\") {\r\n            cards.value = news.data.map(cat => ({\r\n                id: cat.id,\r\n                location: cat.location,\r\n                category: cat.category,\r\n                description: cat.description,\r\n                created_at: cat.created_at,\r\n                type: cat.type,\r\n                media: cat.media,\r\n            }))\r\n        } else {\r\n            console.warn('دریافت دسته‌بندی‌ها ناموفق بود:', carts)\r\n        }\r\n    })\r\n    const filteredCards = computed(() => {\r\n        let result = (cards.value || []).filter(card => {\r\n            const f = props.filters\r\n            if (f) {\r\n                // if (f.withInsight && !card.insight) return false\r\n                if (Array.isArray(f.categories) && f.categories.length > 0 && !f.categories.includes(card.category)) {\r\n                    return false\r\n                }\r\n                // if (Array.isArray(f.socialTypes) && f.socialTypes.length > 0 && !f.socialTypes.some(type => (card.type || '').includes(type))) {\r\n                //     return false\r\n                // }\r\n            }\r\n            // if (props.searchTerm) {\r\n            //     const term = props.searchTerm.toLowerCase()\r\n            //     const username = (card.username || '').toLowerCase()\r\n            //     const title = (card.title || '').toLowerCase()\r\n            //     if (!username.includes(term) && !title.includes(term)) return false\r\n            // }\r\n            return true\r\n        })\r\n        // if (props.sortKey) {\r\n        //     result = [...result].sort((a, b) => (b[props.sortKey] ?? 0) - (a[props.sortKey] ?? 0))\r\n        // }\r\n        return result\r\n    })\r\n    async function select(id){\r\n        // const response = await sendApi({action: \"page_handler/telegram_cards\", handler:'select_card', data: id});\r\n        // if(response.status ==='success'){\r\n        //     const selectedCard = cards.value.find(card => card.id === id)\r\n        //     if (selectedCard) {\r\n        //         selectedCard.selected = true\r\n        //     }\r\n        // }else{\r\n        //     alert('ارتباط با اینترنت قطع است');            \r\n        // }\r\n    }\r\n</script>\r\n<style scoped>\r\n    .cart-inner{\r\n        width: 100%;\r\n        height: 100%;\r\n        display: flex;\r\n        flex-direction: row-reverse;\r\n        flex-wrap: wrap;\r\n        align-content: flex-start;\r\n        justify-content: flex-start;\r\n        align-items: stretch;\r\n    }\r\n    .cart{\r\n        width: 23%;\r\n        height: 210px;\r\n        margin: 0 1% 0 0;\r\n        border-radius: 10px;\r\n        box-shadow: 0 0 5px grey;\r\n    }\r\n    .info{\r\n        margin-top: 7px;\r\n    }\r\n    .img {\r\n        float: left;\r\n        width: 40px;\r\n        height: 40px;\r\n        margin: 0 5px 0 15px;\r\n    }\r\n    .img img{\r\n        width: 100%;\r\n        height: 100%;\r\n        border-radius: 50px;\r\n    }\r\n    .name{\r\n        text-align: start;\r\n        width: calc(100% - 60px);\r\n        display: inline-block;\r\n        padding: 5px;\r\n    }\r\n    .name p:first-child{\r\n        font-size: 10px;\r\n    }\r\n    .name p:last-child{\r\n        font-size: 12px;\r\n    }\r\n    .follwer{\r\n        width: 100%;\r\n        display: flex;\r\n        margin-top: -3px;\r\n        margin-bottom: 7px;\r\n        height: 30px;\r\n        flex-direction: row-reverse;\r\n        flex-wrap: nowrap;\r\n        justify-content: center;\r\n        align-items: stretch;\r\n        text-align: center;\r\n    }\r\n    .count{\r\n        padding-right: 10px;\r\n    }\r\n    .inflowence{\r\n        padding-left: 10px;\r\n    }\r\n    .count,.inflowence{\r\n        width: 50%;\r\n        display: inline-block;\r\n    }\r\n    .count p,.inflowence p{\r\n        margin-top: -12px;\r\n        font-size: 12px;\r\n    }\r\n    .count svg,.inflowence svg{\r\n        height: 20px;\r\n        width: 20px;\r\n        fill: grey;\r\n    }\r\n    .category,.admin-info,.price{\r\n        height: 25px;\r\n        text-align: center;\r\n        width: 85%;\r\n        margin: 2px auto;\r\n        border-radius: 6px;\r\n        background: lightgray;\r\n    }\r\n    .category svg,.admin-info svg,.price svg{\r\n        width: 15px;\r\n        float: left;\r\n        height: 15px;\r\n        margin: 5px;\r\n        fill: gray;\r\n    }\r\n    .order-name{\r\n        margin-top: 4px;\r\n        font-size: 12px;\r\n    }\r\n    .time {\r\n        width: 80%;\r\n        margin: 0 auto;\r\n    }\r\n    .time span {\r\n        font-size: 10px;\r\n    }\r\n    .time span:first-child{\r\n        float: right;\r\n        direction: rtl;\r\n    }\r\n    .time span:last-child{\r\n        float: left;\r\n    }\r\n    .choose {\r\n        width: 85%;\r\n        margin: 0 auto;\r\n    }\r\n    .choosen{\r\n        width: 100%;\r\n        display: inline-block;\r\n        background: grey;\r\n        color: white;\r\n        border-radius: 10px;\r\n        height: 22px;\r\n        text-align: center;\r\n        font-size: 12px;\r\n        padding-top: 3px;\r\n    }\r\n    .choose a{\r\n        width: 100%;\r\n        background: #00f;\r\n        color: #fff;\r\n        border-radius: 10px;\r\n        display: inline-block;\r\n        height: 22px;\r\n        text-align: center;\r\n        font-size: 12px;\r\n        cursor: pointer;\r\n    }\r\n    .loading{\r\n        width: 90%;\r\n        text-align: center;\r\n        background: rgb(166, 181, 228);\r\n        margin: 0 auto;\r\n        border-radius: 10px;\r\n        color: white;\r\n        font-size: 20px;\r\n        height: 150px;\r\n        padding-top: 55px;\r\n    }\r\n    .none-cart-error {\r\n        width: 90%;\r\n        text-align: center;\r\n        background: red;\r\n        margin: 0 auto;\r\n        border-radius: 10px;\r\n        color: white;\r\n        font-size: 20px;\r\n        height: 150px;\r\n        padding-top: 55px;\r\n    }\r\n</style>"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6CI,SAASA,QAAQ,EAAEC,SAAS,EAAEC,GAAG,QAAQ,KAAK;AAC9C,OAAOC,MAAM,MAAM,gBAAgB;AACnC,SAASC,OAAO,QAAQ,aAAa;;;;;;;;;;IACrC,MAAMC,IAAI,GAAGC,MAAiC;IAC9C,MAAMC,KAAK,GAAGC,OAEZ;IACF,MAAMC,QAAQ,GAAGP,GAAG,CAAC,KAAK,CAAC;IAC3B,MAAMQ,KAAK,GAAGR,GAAG,CAAC,EAAE,CAAC;IACrBD,SAAS,CAAC,YAAY;MAClB,MAAMU,IAAI,GAAG,MAAMP,OAAO,CAAC;QAACQ,MAAM,EAAE,UAAU;QAACC,OAAO,EAAC;MAAM,CAAC,CAAC;MAC/D,IAAGF,IAAI,CAACG,MAAM,KAAG,SAAS,EAAE;QACxBJ,KAAK,CAACK,KAAK,GAAGJ,IAAI,CAACK,IAAI,CAACC,GAAG,CAACC,GAAG,KAAK;UAChCC,EAAE,EAAED,GAAG,CAACC,EAAE;UACVC,QAAQ,EAAEF,GAAG,CAACE,QAAQ;UACtBC,QAAQ,EAAEH,GAAG,CAACG,QAAQ;UACtBC,WAAW,EAAEJ,GAAG,CAACI,WAAW;UAC5BC,UAAU,EAAEL,GAAG,CAACK,UAAU;UAC1BC,IAAI,EAAEN,GAAG,CAACM,IAAI;UACdC,KAAK,EAAEP,GAAG,CAACO;QACf,CAAC,CAAC,CAAC;MACP,CAAC,MAAM;QACHC,OAAO,CAACC,IAAI,CAAC,iCAAiC,EAAEC,KAAK,CAAC;MAC1D;IACJ,CAAC,CAAC;IACF,MAAMC,aAAa,GAAG7B,QAAQ,CAAC,MAAM;MACjC,IAAI8B,MAAM,GAAG,CAACpB,KAAK,CAACK,KAAK,IAAI,EAAE,EAAEgB,MAAM,CAACC,IAAI,IAAI;QAC5C,MAAMC,CAAC,GAAG1B,KAAK,CAAC2B,OAAO;QACvB,IAAID,CAAC,EAAE;UACH;UACA,IAAIE,KAAK,CAACC,OAAO,CAACH,CAAC,CAACI,UAAU,CAAC,IAAIJ,CAAC,CAACI,UAAU,CAACC,MAAM,GAAG,CAAC,IAAI,CAACL,CAAC,CAACI,UAAU,CAACE,QAAQ,CAACP,IAAI,CAACX,QAAQ,CAAC,EAAE;YACjG,OAAO,KAAK;UAChB;UACA;UACA;UACA;QACJ;QACA;QACA;QACA;QACA;QACA;QACA;QACA,OAAO,IAAI;MACf,CAAC,CAAC;MACF;MACA;MACA;MACA,OAAOS,MAAM;IACjB,CAAC,CAAC;IACF,eAAeU,MAAMA,CAACrB,EAAE,EAAC;MACrB;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}