{"ast":null,"code":"import { createRouter, createWebHistory } from 'vue-router';\nimport LoginView from '@/views/home/LoginView.vue';\nimport RegisterView from '@/views/home/RegisterView.vue';\nimport MainDashboard from '@/views/dashboard/MainDashboard.vue';\nimport { sendApi } from '@/utils/api';\nimport { useMenuStore } from '@/stores/menu';\nimport { BASE_URL } from '@/config';\nconst icon = BASE_URL + '/assets/images/fav.png';\nconst routes = [{\n  path: '/',\n  name: 'login',\n  component: LoginView,\n  meta: {\n    onlyAuth: true\n  }\n}, {\n  path: '/register',\n  name: 'register',\n  component: RegisterView,\n  meta: {\n    checkHasMobileId: true,\n    onlyAuth: true\n  }\n}, {\n  path: '/dashboard',\n  name: 'dashboard',\n  component: MainDashboard,\n  meta: {\n    requiresAuth: true\n  },\n  props: {\n    view: 'dashboard'\n  }\n}, {\n  path: '/add-news',\n  name: 'add-news',\n  component: MainDashboard,\n  meta: {\n    requiresAuth: true\n  },\n  props: {\n    view: 'add-news'\n  }\n}, {\n  path: '/report-list',\n  name: 'report-list',\n  component: MainDashboard,\n  meta: {\n    requiresAuth: true\n  },\n  props: {\n    view: 'report-list'\n  }\n}, {\n  path: '/manage-news',\n  name: 'manage-news',\n  component: MainDashboard,\n  meta: {\n    requiresAuth: true\n  },\n  props: {\n    view: 'manage-news'\n  }\n}, {\n  path: '/user-setting',\n  name: 'user-setting',\n  component: MainDashboard,\n  meta: {\n    requiresAuth: true\n  },\n  props: {\n    view: 'user-setting'\n  }\n}, {\n  path: '/cartable',\n  name: 'cartable',\n  component: MainDashboard,\n  props: {\n    view: 'cartable'\n  },\n  meta: {\n    requiresAuth: true\n  }\n}, {\n  path: '/show-cartable/:id',\n  name: 'show-cartable',\n  component: MainDashboard,\n  props: route => ({\n    view: 'show-cartable',\n    id: route.params.id\n  }),\n  meta: {\n    requiresAuth: true\n  }\n}, {\n  path: '/show-news/:id',\n  name: 'show-news',\n  component: MainDashboard,\n  props: route => ({\n    view: 'show-news',\n    id: route.params.id\n  }),\n  meta: {\n    requiresAuth: true\n  }\n}];\nconst router = createRouter({\n  history: createWebHistory(process.env.BASE_URL),\n  routes\n});\nrouter.beforeEach(async (to, from, next) => {\n  if (to.name) {\n    document.title = to.name;\n  }\n  const link = document.querySelector(\"link[rel~='icon']\") || document.createElement('link');\n  link.href = icon;\n  try {\n    const meta = to.meta;\n    if (meta.requiresAuth) {\n      const res = await sendApi({\n        action: 'check_auth',\n        control: 'security'\n      });\n      if (res.status !== 'success') return next('/');\n    }\n    if (meta.checkHasMobileId) {\n      const res = await sendApi({\n        action: 'check_has_mobile',\n        control: 'security'\n      });\n      if (res.status !== 'success') return next('/');\n    }\n    if (meta.onlyAuth) {\n      const res = await sendApi({\n        action: 'check_auth',\n        control: 'security'\n      });\n      if (res.status === 'success') return next('/dashboard');\n    }\n    next();\n  } catch (e) {\n    console.error('Router Guard Error:', e);\n    next('/');\n  }\n});\nrouter.afterEach(() => {\n  const menuStore = useMenuStore();\n  menuStore.close();\n});\nexport default router;","map":{"version":3,"names":["createRouter","createWebHistory","LoginView","RegisterView","MainDashboard","sendApi","useMenuStore","BASE_URL","icon","routes","path","name","component","meta","onlyAuth","checkHasMobileId","requiresAuth","props","view","route","id","params","router","history","process","env","beforeEach","to","from","next","document","title","link","querySelector","createElement","href","res","action","control","status","e","console","error","afterEach","menuStore","close"],"sources":["D:/GitHub/chat/vue3/src/router/index.js"],"sourcesContent":["import { createRouter, createWebHistory } from 'vue-router'\r\nimport LoginView from '@/views/home/LoginView.vue';\r\nimport RegisterView from '@/views/home/RegisterView.vue';\r\nimport MainDashboard from '@/views/dashboard/MainDashboard.vue';\r\nimport { sendApi } from '@/utils/api';\r\nimport { useMenuStore } from '@/stores/menu'\r\nimport { BASE_URL } from '@/config';\r\nconst icon=BASE_URL+'/assets/images/fav.png'\r\nconst routes = [\r\n  {\r\n    path: '/',\r\n    name: 'login',\r\n    component: LoginView,\r\n    meta:{onlyAuth:true}\r\n  },\r\n  {\r\n    path: '/register',\r\n    name: 'register',\r\n    component: RegisterView,\r\n    meta:{checkHasMobileId:true,onlyAuth:true}\r\n  },\r\n  {\r\n    path: '/dashboard',\r\n    name: 'dashboard',\r\n    component: MainDashboard,\r\n    meta: { requiresAuth: true },\r\n    props: { view: 'dashboard' } \r\n  },\r\n  {\r\n    path: '/add-news',\r\n    name: 'add-news',\r\n    component: MainDashboard,\r\n    meta: { requiresAuth: true },\r\n    props: { view: 'add-news' } \r\n  },\r\n  {\r\n    path: '/report-list',\r\n    name: 'report-list',\r\n    component: MainDashboard,\r\n    meta: { requiresAuth: true },\r\n    props: { view: 'report-list' } \r\n  },\r\n  {\r\n    path: '/manage-news',\r\n    name: 'manage-news',\r\n    component: MainDashboard,\r\n    meta: { requiresAuth: true },\r\n    props: { view: 'manage-news' } \r\n  },\r\n  {\r\n    path: '/user-setting',\r\n    name: 'user-setting',\r\n    component: MainDashboard,\r\n    meta: { requiresAuth: true },\r\n    props: { view: 'user-setting' } \r\n  },\r\n  {\r\n    path: '/cartable',\r\n    name: 'cartable',\r\n    component: MainDashboard,\r\n    props: { view: 'cartable' },\r\n    meta: { requiresAuth: true }\r\n  },\r\n  {\r\n    path: '/show-cartable/:id',\r\n    name: 'show-cartable',\r\n    component: MainDashboard,\r\n    props: route => ({ view: 'show-cartable', id: route.params.id }),\r\n    meta: { requiresAuth: true }\r\n  },\r\n  {\r\n    path: '/show-news/:id',\r\n    name: 'show-news',\r\n    component: MainDashboard,\r\n    props: route => ({ view: 'show-news', id: route.params.id }),\r\n    meta: { requiresAuth: true }\r\n  },\r\n]\r\n\r\nconst router = createRouter({\r\n  history: createWebHistory(process.env.BASE_URL),\r\n  routes\r\n})\r\n\r\nrouter.beforeEach(async (to, from, next) => {\r\n  if (to.name) {\r\n    document.title = to.name;\r\n  }\r\n  const link = document.querySelector(\"link[rel~='icon']\") || document.createElement('link');\r\n  link.href = icon;\r\n  try {\r\n    const meta = to.meta;\r\n    if (meta.requiresAuth) {\r\n      const res = await sendApi({ \r\n        action: 'check_auth' ,\r\n        control:'security'\r\n       });\r\n      if (res.status !== 'success') return next('/');\r\n    }\r\n    if (meta.checkHasMobileId) {\r\n      const res = await sendApi({ \r\n        action: 'check_has_mobile',\r\n        control:'security'\r\n      });\r\n      if (res.status !== 'success') return next('/');\r\n    }\r\n    if (meta.onlyAuth) {\r\n      const res = await sendApi({ \r\n        action: 'check_auth',\r\n        control:'security'\r\n      });\r\n      if (res.status === 'success') return next('/dashboard');\r\n    }\r\n    next();\r\n  } catch (e) {\r\n    console.error('Router Guard Error:', e);\r\n    next('/');\r\n  }\r\n});\r\nrouter.afterEach(() => {\r\n  const menuStore = useMenuStore()\r\n  menuStore.close()\r\n})\r\nexport default router\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}