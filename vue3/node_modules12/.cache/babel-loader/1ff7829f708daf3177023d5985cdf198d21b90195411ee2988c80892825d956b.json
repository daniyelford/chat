{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"map-wrapper\"\n};\nimport { onMounted, ref, watch, createApp, h } from 'vue';\nimport L from 'leaflet';\nimport MediaSlider from '../media/MediaSlider.vue';\nimport 'leaflet/dist/leaflet.css';\nimport { BASE_URL } from '@/config';\nexport default {\n  __name: 'StaticMapWithMarkers',\n  props: {\n    center: {\n      type: Object,\n      required: true\n    },\n    markers: {\n      type: Array,\n      default: () => []\n    }\n  },\n  setup(__props) {\n    const props = __props;\n    const map = ref(null);\n    const markerLayerGroup = ref(null);\n    const markerIcon = L.icon({\n      iconUrl: BASE_URL + '/assets/images/marker.svg',\n      iconSize: [32, 32],\n      iconAnchor: [16, 32]\n    });\n    onMounted(() => {\n      map.value = L.map('multi-marker-map').setView([props.center.lat, props.center.lon], 13);\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n        attribution: '&copy; OpenStreetMap contributors'\n      }).addTo(map.value);\n      markerLayerGroup.value = L.layerGroup().addTo(map.value);\n      renderMarkers();\n    });\n    watch(() => props.markers, () => {\n      renderMarkers();\n    }, {\n      deep: true\n    });\n    watch(() => props.center, val => {\n      if (val && val.lat && val.lon && map.value) {\n        map.value.flyTo([val.lat, val.lon], 13, {\n          animate: true,\n          duration: 1.2\n        });\n      }\n    }, {\n      immediate: true\n    });\n    const renderMarkers = () => {\n      if (!markerLayerGroup.value) return;\n      markerLayerGroup.value.clearLayers();\n      props.markers.forEach(m => {\n        const leafletMarker = L.marker([m.lat, m.lon], {\n          icon: markerIcon\n        });\n        const container = document.createElement('div');\n        container.style.maxWidth = '250px';\n        const app = createApp({\n          render() {\n            return h('div', [h('strong', m.title || ''), h('p', {\n              style: 'margin: 5px 0;'\n            }, m.description || ''), h(MediaSlider, {\n              medias: m.images || []\n            })]);\n          }\n        });\n        app.component('MediaSlider', MediaSlider);\n        app.mount(container);\n        leafletMarker.bindPopup(container);\n        leafletMarker.addTo(markerLayerGroup.value);\n      });\n    };\n\n    // const renderMarkers = () => {\n    //   if (!markerLayerGroup.value) return\n    //   markerLayerGroup.value.clearLayers()\n    //   props.markers.forEach(m => {\n    //     const leafletMarker = L.marker([m.lat, m.lon], { icon: markerIcon })\n    //     const popupHtml = `\n    //       <div style=\"max-width: 200px;\">\n    //         <strong>${m.title || ''}</strong><br>\n    //         <p style=\"margin: 5px 0;\">${m.description || ''}</p>\n    //         ${m.images && m.images.length ? `<img src=\"${m.images[0]}\" style=\"width: 100%; border-radius: 6px;\" />` : ''}\n    //       </div>\n    //     `\n    //     leafletMarker.bindPopup(popupHtml)\n    //     leafletMarker.addTo(markerLayerGroup.value)\n    //   })\n    // }\n\n    return (_ctx, _cache) => {\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, _cache[0] || (_cache[0] = [_createElementVNode(\"div\", {\n        id: \"multi-marker-map\",\n        class: \"map\"\n      }, null, -1)]));\n    };\n  }\n};","map":{"version":3,"names":["onMounted","ref","watch","createApp","h","L","MediaSlider","BASE_URL","props","__props","map","markerLayerGroup","markerIcon","icon","iconUrl","iconSize","iconAnchor","value","setView","center","lat","lon","tileLayer","attribution","addTo","layerGroup","renderMarkers","markers","deep","val","flyTo","animate","duration","immediate","clearLayers","forEach","m","leafletMarker","marker","container","document","createElement","style","maxWidth","app","render","title","description","medias","images","component","mount","bindPopup"],"sources":["D:/GitHub/chat/vue3/src/components/tooles/places/StaticMapWithMarkers.vue"],"sourcesContent":["<template>\r\n  <div class=\"map-wrapper\">\r\n    <div id=\"multi-marker-map\" class=\"map\"></div>\r\n  </div>\r\n</template>\r\n<script setup>\r\n  import { onMounted, ref, defineProps, watch, createApp ,h } from 'vue'\r\n  import L from 'leaflet'\r\n  import MediaSlider from '../media/MediaSlider.vue'\r\n  import 'leaflet/dist/leaflet.css'\r\n  import { BASE_URL } from '@/config'\r\n  const props = defineProps({\r\n    center: { type: Object, required: true },\r\n    markers: {\r\n      type: Array,\r\n      default: () => []\r\n    }\r\n  })\r\n  const map = ref(null)\r\n  const markerLayerGroup = ref(null)\r\n  const markerIcon = L.icon({\r\n    iconUrl: BASE_URL + '/assets/images/marker.svg',\r\n    iconSize: [32, 32],\r\n    iconAnchor: [16, 32]\r\n  })\r\n  onMounted(() => {\r\n    map.value = L.map('multi-marker-map').setView([props.center.lat, props.center.lon], 13)\r\n    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n      attribution: '&copy; OpenStreetMap contributors',\r\n    }).addTo(map.value)\r\n    markerLayerGroup.value = L.layerGroup().addTo(map.value)\r\n    renderMarkers()\r\n  })\r\n  watch(() => props.markers, () => {\r\n    renderMarkers()\r\n  }, { deep: true })\r\n  watch(() => props.center, (val) => {\r\n    if (val && val.lat && val.lon && map.value) {\r\n      map.value.flyTo([val.lat, val.lon], 13, {\r\n        animate: true,\r\n        duration: 1.2\r\n      })\r\n    }\r\n  }, { immediate: true })\r\n  const renderMarkers = () => {\r\n    if (!markerLayerGroup.value) return\r\n    markerLayerGroup.value.clearLayers()\r\n    props.markers.forEach(m => {\r\n      const leafletMarker = L.marker([m.lat, m.lon], { icon: markerIcon })\r\n      const container = document.createElement('div')\r\n      container.style.maxWidth = '250px'\r\n      const app = createApp({\r\n        render() {\r\n          return h('div', [\r\n            h('strong', m.title || ''),\r\n            h('p', { style: 'margin: 5px 0;' }, m.description || ''),\r\n            h(MediaSlider, {\r\n              medias: m.images || []\r\n            })\r\n          ])\r\n        }\r\n      })\r\n      app.component('MediaSlider', MediaSlider)\r\n      app.mount(container)\r\n      leafletMarker.bindPopup(container)\r\n      leafletMarker.addTo(markerLayerGroup.value)\r\n    })\r\n  }\r\n\r\n  // const renderMarkers = () => {\r\n  //   if (!markerLayerGroup.value) return\r\n  //   markerLayerGroup.value.clearLayers()\r\n  //   props.markers.forEach(m => {\r\n  //     const leafletMarker = L.marker([m.lat, m.lon], { icon: markerIcon })\r\n  //     const popupHtml = `\r\n  //       <div style=\"max-width: 200px;\">\r\n  //         <strong>${m.title || ''}</strong><br>\r\n  //         <p style=\"margin: 5px 0;\">${m.description || ''}</p>\r\n  //         ${m.images && m.images.length ? `<img src=\"${m.images[0]}\" style=\"width: 100%; border-radius: 6px;\" />` : ''}\r\n  //       </div>\r\n  //     `\r\n  //     leafletMarker.bindPopup(popupHtml)\r\n  //     leafletMarker.addTo(markerLayerGroup.value)\r\n  //   })\r\n  // }\r\n</script>\r\n<style scoped>\r\n  .map-wrapper {\r\n    width: 100%;\r\n    height: 400px;\r\n    position: relative;\r\n  }\r\n  .map {\r\n    width: 100%;\r\n    height: 100%;\r\n    border-radius: 8px;\r\n  }\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}