{"ast":null,"code":"import { createElementVNode as _createElementVNode, createVNode as _createVNode, vModelText as _vModelText, withDirectives as _withDirectives, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"form-container\"\n};\nconst _hoisted_2 = {\n  class: \"form-group\"\n};\nconst _hoisted_3 = {\n  class: \"form-group\"\n};\nconst _hoisted_4 = {\n  class: \"form-group\"\n};\nconst _hoisted_5 = {\n  class: \"form-group\"\n};\nimport { ref, onMounted } from 'vue';\nimport { useUserStore } from '@/stores/user';\nimport { sendApi } from '@/utils/api';\nimport UploadSingleImageUser from '@/components/tooles/upload/UploadSingleImageUser.vue';\nimport FingerPrintRegister from '@/components/tooles/nav/FingerPrintRegister.vue';\nexport default {\n  __name: 'UserSetting',\n  setup(__props) {\n    const userStore = useUserStore();\n    const form = ref({\n      name: '',\n      family: '',\n      mobile: '',\n      image: null,\n      image_preview: ''\n    });\n    onMounted(() => {\n      if (!userStore.isLoaded) {\n        userStore.fetchUserInfo().then(() => {\n          fillForm();\n        });\n      } else {\n        fillForm();\n      }\n    });\n    const fillForm = () => {\n      form.value.name = userStore.name || '';\n      form.value.family = userStore.family || '';\n      form.value.mobile = userStore.mobile || '';\n      form.value.image_preview = userStore.image || '';\n    };\n    // const handleImageChange = (e) => {\n    //     const file = e.target.files[0]\n    //     if (file) {\n    //         form.value.image = file\n    //         form.value.image_preview = URL.createObjectURL(file)\n    //     }\n    // }\n    const submitForm = async () => {\n      try {\n        const formData = new FormData();\n        formData.append('name', form.value.name);\n        formData.append('family', form.value.family);\n        formData.append('mobile', form.value.mobile);\n        if (form.value.image) {\n          formData.append('image', form.value.image);\n        }\n        const data = await sendApi({\n          control: 'user',\n          action: 'edit_user',\n          data: formData,\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          }\n        });\n        alert(data.data.message);\n        await userStore.fetchUserInfo();\n      } catch (e) {\n        alert('خطا: ' + (e.response?.data?.message || e.message));\n      }\n    };\n    return (_ctx, _cache) => {\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[7] || (_cache[7] = _createElementVNode(\"h2\", {\n        class: \"form-title\"\n      }, \"ویرایش اطلاعات\", -1)), _createElementVNode(\"form\", {\n        onSubmit: _withModifiers(submitForm, [\"prevent\"])\n      }, [_createElementVNode(\"div\", _hoisted_2, [_createVNode(UploadSingleImageUser, {\n        url: \"register/\",\n        toAction: \"user-mobile\",\n        image: form.value.image_preview\n      }, null, 8, [\"image\"])]), _createElementVNode(\"div\", _hoisted_3, [_cache[3] || (_cache[3] = _createElementVNode(\"label\", {\n        class: \"form-label\"\n      }, \"نام\", -1)), _withDirectives(_createElementVNode(\"input\", {\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => form.value.name = $event),\n        type: \"text\",\n        class: \"form-input\"\n      }, null, 512), [[_vModelText, form.value.name]])]), _createElementVNode(\"div\", _hoisted_4, [_cache[4] || (_cache[4] = _createElementVNode(\"label\", {\n        class: \"form-label\"\n      }, \"نام خانوادگی\", -1)), _withDirectives(_createElementVNode(\"input\", {\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => form.value.family = $event),\n        type: \"text\",\n        class: \"form-input\"\n      }, null, 512), [[_vModelText, form.value.family]])]), _createElementVNode(\"div\", _hoisted_5, [_cache[5] || (_cache[5] = _createElementVNode(\"label\", {\n        class: \"form-label\"\n      }, \"شماره تماس\", -1)), _withDirectives(_createElementVNode(\"input\", {\n        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => form.value.mobile = $event),\n        type: \"text\",\n        class: \"form-input\"\n      }, null, 512), [[_vModelText, form.value.mobile]])]), _cache[6] || (_cache[6] = _createElementVNode(\"button\", {\n        class: \"form-button\",\n        type: \"submit\"\n      }, \"ویرایش\", -1))], 32), _createVNode(FingerPrintRegister, {\n        hasFinger: false\n      })]);\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","useUserStore","sendApi","UploadSingleImageUser","FingerPrintRegister","userStore","form","name","family","mobile","image","image_preview","isLoaded","fetchUserInfo","then","fillForm","value","submitForm","formData","FormData","append","data","control","action","headers","alert","message","e","response"],"sources":["D:/GitHub/ci3-vue3/vue3/src/components/dashboard/pagesContent/UserSetting.vue"],"sourcesContent":["<template>\r\n    <div class=\"form-container\">\r\n        <h2 class=\"form-title\">ویرایش اطلاعات</h2>\r\n        <form @submit.prevent=\"submitForm\">\r\n            <div class=\"form-group\">\r\n                <UploadSingleImageUser url=\"register/\" toAction=\"user-mobile\" :image=\"form.image_preview\"/>\r\n                <!-- <label class=\"form-label\">تصویر پروفایل</label> -->\r\n                <!-- <input type=\"file\" accept=\"image/*\" @change=\"handleImageChange\" class=\"form-file\" />\r\n                <div v-if=\"form.image_preview\" class=\"image-preview\">\r\n                    <img :src=\"form.image_preview\" alt=\"پیش‌نمایش تصویر\" />\r\n                </div> -->\r\n            </div>\r\n            <div class=\"form-group\">\r\n                <label class=\"form-label\">نام</label>\r\n                <input v-model=\"form.name\" type=\"text\" class=\"form-input\" />\r\n            </div>\r\n            <div class=\"form-group\">\r\n                <label class=\"form-label\">نام خانوادگی</label>\r\n                <input v-model=\"form.family\" type=\"text\" class=\"form-input\" />\r\n            </div>\r\n            <div class=\"form-group\">\r\n                <label class=\"form-label\">شماره تماس</label>\r\n                <input v-model=\"form.mobile\" type=\"text\" class=\"form-input\" />\r\n            </div>\r\n            \r\n            <button class=\"form-button\" type=\"submit\">ویرایش</button>\r\n        </form>\r\n        <FingerPrintRegister :hasFinger=\"false\"/>\r\n    </div>\r\n</template>\r\n<script setup>\r\n    import { ref, onMounted } from 'vue'\r\n    import { useUserStore } from '@/stores/user'\r\n    import { sendApi } from '@/utils/api'\r\n    import UploadSingleImageUser from '@/components/tooles/upload/UploadSingleImageUser.vue'\r\n    import FingerPrintRegister from '@/components/tooles/nav/FingerPrintRegister.vue'\r\n    const userStore = useUserStore()\r\n    const form = ref({\r\n        name: '',\r\n        family: '',\r\n        mobile: '',\r\n        image: null,\r\n        image_preview: '' \r\n    })\r\n    onMounted(() => {\r\n        if (!userStore.isLoaded) {\r\n            userStore.fetchUserInfo().then(() => {\r\n                fillForm()\r\n            })\r\n        } else {\r\n            fillForm()\r\n        }\r\n    })\r\n    const fillForm = () => {\r\n        form.value.name = userStore.name || ''\r\n        form.value.family = userStore.family || ''\r\n        form.value.mobile = userStore.mobile || ''\r\n        form.value.image_preview = userStore.image || ''\r\n    }\r\n    // const handleImageChange = (e) => {\r\n    //     const file = e.target.files[0]\r\n    //     if (file) {\r\n    //         form.value.image = file\r\n    //         form.value.image_preview = URL.createObjectURL(file)\r\n    //     }\r\n    // }\r\n    const submitForm = async () => {\r\n        try {\r\n            const formData = new FormData()\r\n            formData.append('name', form.value.name)\r\n            formData.append('family', form.value.family)\r\n            formData.append('mobile', form.value.mobile)\r\n            if (form.value.image) {\r\n                formData.append('image', form.value.image)\r\n            }\r\n\r\n            const data = await sendApi({\r\n                control: 'user',\r\n                action: 'edit_user',\r\n                data: formData,\r\n                headers: { 'Content-Type': 'multipart/form-data' }\r\n            })\r\n\r\n            alert(data.data.message)\r\n                await userStore.fetchUserInfo()\r\n        } catch (e) {\r\n            alert('خطا: ' + (e.response?.data?.message || e.message))\r\n        }\r\n    }\r\n</script>\r\n<style scoped>\r\n    .form-container {\r\n        padding: 20px;\r\n        max-width: 500px;\r\n        margin: 0 auto;\r\n        background-color: #fefefe;\r\n        border: 1px solid #ddd;\r\n        border-radius: 10px;\r\n    }\r\n    .form-title {\r\n        text-align: center;\r\n        font-size: 22px;\r\n        font-weight: bold;\r\n        margin-bottom: 20px;\r\n    }\r\n    .form-group {\r\n        margin-bottom: 16px;\r\n    }\r\n    .form-label {\r\n        display: block;\r\n        direction: rtl;\r\n        font-weight: bold;\r\n        margin-bottom: 6px;\r\n        color: #333;\r\n    }\r\n    .form-input {\r\n        width: 100%;\r\n        padding: 10px 12px;\r\n        font-size: 14px;\r\n        box-sizing: border-box;\r\n        border: 1px solid #ccc;\r\n        border-radius: 6px;\r\n        background-color: #f9f9f9;\r\n        transition: 0.3s border-color ease;\r\n    }\r\n    .form-input:focus {\r\n        outline: none;\r\n        border-color: #007bff;\r\n        background-color: #fff;\r\n    }\r\n    .form-file {\r\n        width: 100%;\r\n        padding: 6px 0;\r\n        font-size: 14px;\r\n    }\r\n    .image-preview {\r\n        margin-top: 10px;\r\n    }\r\n    .image-preview img {\r\n        width: 100%;\r\n        max-height: 200px;\r\n        border-radius: 8px;\r\n        border: 1px solid #ccc;\r\n    }\r\n    .form-button {\r\n        background-color: #007bff;\r\n        color: white;\r\n        border: none;\r\n        padding: 10px 16px;\r\n        font-size: 15px;\r\n        border-radius: 6px;\r\n        cursor: pointer;\r\n        width: 100%;\r\n        transition: 0.2s background-color ease;\r\n    }\r\n    .form-button:hover {\r\n        background-color: #0056b3;\r\n    }\r\n</style>\r\n"],"mappings":";;;;;;;;;;;;;;;;AA+BI,SAASA,GAAG,EAAEC,SAAS,QAAQ,KAAK;AACpC,SAASC,YAAY,QAAQ,eAAe;AAC5C,SAASC,OAAO,QAAQ,aAAa;AACrC,OAAOC,qBAAqB,MAAM,sDAAsD;AACxF,OAAOC,mBAAmB,MAAM,iDAAiD;;;;IACjF,MAAMC,SAAS,GAAGJ,YAAY,CAAC,CAAC;IAChC,MAAMK,IAAI,GAAGP,GAAG,CAAC;MACbQ,IAAI,EAAE,EAAE;MACRC,MAAM,EAAE,EAAE;MACVC,MAAM,EAAE,EAAE;MACVC,KAAK,EAAE,IAAI;MACXC,aAAa,EAAE;IACnB,CAAC,CAAC;IACFX,SAAS,CAAC,MAAM;MACZ,IAAI,CAACK,SAAS,CAACO,QAAQ,EAAE;QACrBP,SAAS,CAACQ,aAAa,CAAC,CAAC,CAACC,IAAI,CAAC,MAAM;UACjCC,QAAQ,CAAC,CAAC;QACd,CAAC,CAAC;MACN,CAAC,MAAM;QACHA,QAAQ,CAAC,CAAC;MACd;IACJ,CAAC,CAAC;IACF,MAAMA,QAAQ,GAAGA,CAAA,KAAM;MACnBT,IAAI,CAACU,KAAK,CAACT,IAAI,GAAGF,SAAS,CAACE,IAAI,IAAI,EAAE;MACtCD,IAAI,CAACU,KAAK,CAACR,MAAM,GAAGH,SAAS,CAACG,MAAM,IAAI,EAAE;MAC1CF,IAAI,CAACU,KAAK,CAACP,MAAM,GAAGJ,SAAS,CAACI,MAAM,IAAI,EAAE;MAC1CH,IAAI,CAACU,KAAK,CAACL,aAAa,GAAGN,SAAS,CAACK,KAAK,IAAI,EAAE;IACpD,CAAC;IACD;IACA;IACA;IACA;IACA;IACA;IACA;IACA,MAAMO,UAAU,GAAG,MAAAA,CAAA,KAAY;MAC3B,IAAI;QACA,MAAMC,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;QAC/BD,QAAQ,CAACE,MAAM,CAAC,MAAM,EAAEd,IAAI,CAACU,KAAK,CAACT,IAAI,CAAC;QACxCW,QAAQ,CAACE,MAAM,CAAC,QAAQ,EAAEd,IAAI,CAACU,KAAK,CAACR,MAAM,CAAC;QAC5CU,QAAQ,CAACE,MAAM,CAAC,QAAQ,EAAEd,IAAI,CAACU,KAAK,CAACP,MAAM,CAAC;QAC5C,IAAIH,IAAI,CAACU,KAAK,CAACN,KAAK,EAAE;UAClBQ,QAAQ,CAACE,MAAM,CAAC,OAAO,EAAEd,IAAI,CAACU,KAAK,CAACN,KAAK,CAAC;QAC9C;QAEA,MAAMW,IAAI,GAAG,MAAMnB,OAAO,CAAC;UACvBoB,OAAO,EAAE,MAAM;UACfC,MAAM,EAAE,WAAW;UACnBF,IAAI,EAAEH,QAAQ;UACdM,OAAO,EAAE;YAAE,cAAc,EAAE;UAAsB;QACrD,CAAC,CAAC;QAEFC,KAAK,CAACJ,IAAI,CAACA,IAAI,CAACK,OAAO,CAAC;QACpB,MAAMrB,SAAS,CAACQ,aAAa,CAAC,CAAC;MACvC,CAAC,CAAC,OAAOc,CAAC,EAAE;QACRF,KAAK,CAAC,OAAO,IAAIE,CAAC,CAACC,QAAQ,EAAEP,IAAI,EAAEK,OAAO,IAAIC,CAAC,CAACD,OAAO,CAAC,CAAC;MAC7D;IACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}