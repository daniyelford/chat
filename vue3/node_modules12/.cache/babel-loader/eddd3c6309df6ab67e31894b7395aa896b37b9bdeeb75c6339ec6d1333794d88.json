{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { defineStore } from 'pinia';\nimport { sendApi } from '@/utils/api';\nexport const useNewsStore = defineStore('news', {\n  state: () => ({\n    cards: [],\n    lastUpdate: null,\n    isLoaded: false,\n    hasRule: false\n  }),\n  actions: {\n    async fetchNews() {\n      const res = await sendApi({\n        action: 'get_news',\n        control: 'news'\n      });\n      if (res.status === 'success') {\n        const newCards = res.data.map(item => ({\n          id: item.id,\n          location: item.location,\n          category: item.category ?? 'کلی',\n          description: item.description,\n          created_at: item.created_at,\n          user: item.user,\n          medias: Array.isArray(item.media) ? item.media.map(media => ({\n            type: media.type,\n            url: media.url\n          })) : []\n        }));\n        this.hasRule = res.rule ?? false;\n        if (!this.cards.length) {\n          this.cards = newCards;\n        } else {\n          const currentMaxId = Math.max(...this.cards.map(c => c.id));\n          const freshCards = newCards.filter(c => c.id > currentMaxId);\n          if (freshCards.length > 0) {\n            this.cards = [...freshCards, ...this.cards];\n            this.lastUpdate = new Date().toISOString();\n          }\n        }\n        this.isLoaded = true;\n      }\n    }\n  }\n});","map":{"version":3,"names":["defineStore","sendApi","useNewsStore","state","cards","lastUpdate","isLoaded","hasRule","actions","fetchNews","res","action","control","status","newCards","data","map","item","id","location","category","description","created_at","user","medias","Array","isArray","media","type","url","rule","length","currentMaxId","Math","max","c","freshCards","filter","Date","toISOString"],"sources":["D:/GitHub/ci3-vue3/vue3/src/stores/news.js"],"sourcesContent":["import { defineStore } from 'pinia'\r\nimport { sendApi } from '@/utils/api'\r\nexport const useNewsStore = defineStore('news', {\r\n  state: () => ({\r\n    cards: [],\r\n    lastUpdate: null,\r\n    isLoaded: false,\r\n    hasRule: false\r\n  }),\r\n  actions: {\r\n    async fetchNews() {\r\n      const res = await sendApi({ action: 'get_news', control: 'news' })\r\n      if (res.status === 'success') {\r\n        const newCards = res.data.map(item => ({\r\n          id: item.id,\r\n          location: item.location,\r\n          category: item.category ?? 'کلی',\r\n          description: item.description,\r\n          created_at: item.created_at,\r\n          user: item.user,\r\n          medias: Array.isArray(item.media)\r\n            ? item.media.map(media => ({\r\n                type: media.type,\r\n                url: media.url\r\n              }))\r\n            : []\r\n        }))\r\n        this.hasRule = res.rule ?? false\r\n        if (!this.cards.length) {\r\n          this.cards = newCards\r\n        } else {\r\n          const currentMaxId = Math.max(...this.cards.map(c => c.id))\r\n          const freshCards = newCards.filter(c => c.id > currentMaxId)\r\n          if (freshCards.length > 0) {\r\n            this.cards = [...freshCards, ...this.cards]\r\n            this.lastUpdate = new Date().toISOString()\r\n          }\r\n        }\r\n        this.isLoaded = true\r\n      }\r\n    }\r\n  }\r\n})\r\n"],"mappings":";;;AAAA,SAASA,WAAW,QAAQ,OAAO;AACnC,SAASC,OAAO,QAAQ,aAAa;AACrC,OAAO,MAAMC,YAAY,GAAGF,WAAW,CAAC,MAAM,EAAE;EAC9CG,KAAK,EAAEA,CAAA,MAAO;IACZC,KAAK,EAAE,EAAE;IACTC,UAAU,EAAE,IAAI;IAChBC,QAAQ,EAAE,KAAK;IACfC,OAAO,EAAE;EACX,CAAC,CAAC;EACFC,OAAO,EAAE;IACP,MAAMC,SAASA,CAAA,EAAG;MAChB,MAAMC,GAAG,GAAG,MAAMT,OAAO,CAAC;QAAEU,MAAM,EAAE,UAAU;QAAEC,OAAO,EAAE;MAAO,CAAC,CAAC;MAClE,IAAIF,GAAG,CAACG,MAAM,KAAK,SAAS,EAAE;QAC5B,MAAMC,QAAQ,GAAGJ,GAAG,CAACK,IAAI,CAACC,GAAG,CAACC,IAAI,KAAK;UACrCC,EAAE,EAAED,IAAI,CAACC,EAAE;UACXC,QAAQ,EAAEF,IAAI,CAACE,QAAQ;UACvBC,QAAQ,EAAEH,IAAI,CAACG,QAAQ,IAAI,KAAK;UAChCC,WAAW,EAAEJ,IAAI,CAACI,WAAW;UAC7BC,UAAU,EAAEL,IAAI,CAACK,UAAU;UAC3BC,IAAI,EAAEN,IAAI,CAACM,IAAI;UACfC,MAAM,EAAEC,KAAK,CAACC,OAAO,CAACT,IAAI,CAACU,KAAK,CAAC,GAC7BV,IAAI,CAACU,KAAK,CAACX,GAAG,CAACW,KAAK,KAAK;YACvBC,IAAI,EAAED,KAAK,CAACC,IAAI;YAChBC,GAAG,EAAEF,KAAK,CAACE;UACb,CAAC,CAAC,CAAC,GACH;QACN,CAAC,CAAC,CAAC;QACH,IAAI,CAACtB,OAAO,GAAGG,GAAG,CAACoB,IAAI,IAAI,KAAK;QAChC,IAAI,CAAC,IAAI,CAAC1B,KAAK,CAAC2B,MAAM,EAAE;UACtB,IAAI,CAAC3B,KAAK,GAAGU,QAAQ;QACvB,CAAC,MAAM;UACL,MAAMkB,YAAY,GAAGC,IAAI,CAACC,GAAG,CAAC,GAAG,IAAI,CAAC9B,KAAK,CAACY,GAAG,CAACmB,CAAC,IAAIA,CAAC,CAACjB,EAAE,CAAC,CAAC;UAC3D,MAAMkB,UAAU,GAAGtB,QAAQ,CAACuB,MAAM,CAACF,CAAC,IAAIA,CAAC,CAACjB,EAAE,GAAGc,YAAY,CAAC;UAC5D,IAAII,UAAU,CAACL,MAAM,GAAG,CAAC,EAAE;YACzB,IAAI,CAAC3B,KAAK,GAAG,CAAC,GAAGgC,UAAU,EAAE,GAAG,IAAI,CAAChC,KAAK,CAAC;YAC3C,IAAI,CAACC,UAAU,GAAG,IAAIiC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;UAC5C;QACF;QACA,IAAI,CAACjC,QAAQ,GAAG,IAAI;MACtB;IACF;EACF;AACF,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}