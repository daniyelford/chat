{"ast":null,"code":"import { sendApi } from \"@/utils/api\";\nimport { BASE_URL } from \"@/config\";\nimport { urlBase64ToUint8Array } from '@/utils/urlBase64ToUint8Array';\nconst publicVapidKey = 'BCqO9cq0iSx7R9EDVULhIo7MmNVvTjFnX4KxouSlzNvU9aY56i6hWXt6_DHeJw9YSQjQw_c-_B9_1I6ImTMGavI';\nexport async function subscribeToPush() {\n  if ('serviceWorker' in navigator && 'PushManager' in window) {\n    navigator.serviceWorker.register(`${BASE_URL}/assets/sw.js`).then(async registration => {\n      const subscription = await registration.pushManager.subscribe({\n        userVisibleOnly: true,\n        applicationServerKey: urlBase64ToUint8Array(publicVapidKey)\n      });\n      const response = await sendApi({\n        control: 'user',\n        action: 'subscribe',\n        data: subscription\n      });\n      if (response.status !== 'success') throw new Error('Server failed to save subscription');\n    }).catch(err => {\n      console.error('❌ SW registration failed:', err);\n    });\n  } else {\n    console.warn('❌ Push not supported in this browser.');\n  }\n}","map":{"version":3,"names":["sendApi","BASE_URL","urlBase64ToUint8Array","publicVapidKey","subscribeToPush","navigator","window","serviceWorker","register","then","registration","subscription","pushManager","subscribe","userVisibleOnly","applicationServerKey","response","control","action","data","status","Error","catch","err","console","error","warn"],"sources":["D:/GitHub/ci3-vue3/vue3/src/utils/pushService.js"],"sourcesContent":["import { sendApi } from \"@/utils/api\";\r\nimport { BASE_URL } from \"@/config\";\r\nimport { urlBase64ToUint8Array } from '@/utils/urlBase64ToUint8Array';\r\nconst publicVapidKey = 'BCqO9cq0iSx7R9EDVULhIo7MmNVvTjFnX4KxouSlzNvU9aY56i6hWXt6_DHeJw9YSQjQw_c-_B9_1I6ImTMGavI';\r\nexport async function subscribeToPush() {\r\n  if ('serviceWorker' in navigator && 'PushManager' in window) {\r\n    navigator.serviceWorker.register(`${BASE_URL}/assets/sw.js`)\r\n    .then(async registration => {\r\n      const subscription = await registration.pushManager.subscribe({\r\n        userVisibleOnly: true,\r\n        applicationServerKey: urlBase64ToUint8Array(publicVapidKey),\r\n      });\r\n      const response = await sendApi({ control: 'user', action: 'subscribe', data:subscription })\r\n        if (response.status!=='success') throw new Error('Server failed to save subscription');\r\n    })\r\n    .catch(err => {\r\n      console.error('❌ SW registration failed:', err);\r\n    });\r\n  } else {\r\n    console.warn('❌ Push not supported in this browser.');\r\n  }\r\n}"],"mappings":"AAAA,SAASA,OAAO,QAAQ,aAAa;AACrC,SAASC,QAAQ,QAAQ,UAAU;AACnC,SAASC,qBAAqB,QAAQ,+BAA+B;AACrE,MAAMC,cAAc,GAAG,yFAAyF;AAChH,OAAO,eAAeC,eAAeA,CAAA,EAAG;EACtC,IAAI,eAAe,IAAIC,SAAS,IAAI,aAAa,IAAIC,MAAM,EAAE;IAC3DD,SAAS,CAACE,aAAa,CAACC,QAAQ,CAAC,GAAGP,QAAQ,eAAe,CAAC,CAC3DQ,IAAI,CAAC,MAAMC,YAAY,IAAI;MAC1B,MAAMC,YAAY,GAAG,MAAMD,YAAY,CAACE,WAAW,CAACC,SAAS,CAAC;QAC5DC,eAAe,EAAE,IAAI;QACrBC,oBAAoB,EAAEb,qBAAqB,CAACC,cAAc;MAC5D,CAAC,CAAC;MACF,MAAMa,QAAQ,GAAG,MAAMhB,OAAO,CAAC;QAAEiB,OAAO,EAAE,MAAM;QAAEC,MAAM,EAAE,WAAW;QAAEC,IAAI,EAACR;MAAa,CAAC,CAAC;MACzF,IAAIK,QAAQ,CAACI,MAAM,KAAG,SAAS,EAAE,MAAM,IAAIC,KAAK,CAAC,oCAAoC,CAAC;IAC1F,CAAC,CAAC,CACDC,KAAK,CAACC,GAAG,IAAI;MACZC,OAAO,CAACC,KAAK,CAAC,2BAA2B,EAAEF,GAAG,CAAC;IACjD,CAAC,CAAC;EACJ,CAAC,MAAM;IACLC,OAAO,CAACE,IAAI,CAAC,uCAAuC,CAAC;EACvD;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}